<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mega Sena - Gerador Completo com 13 Se√ß√µes Avan√ßadas</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        megasena: '#1B9A67',
                        'megasena-light': '#2db87f',
                        'megasena-dark': '#158755',
                        'megasena-bg': '#f0fdf4'
                    }
                }
            }
        }
    </script>
    
    <!-- Scripts das Funcionalidades -->
    <script>
        // ===== VARI√ÅVEIS GLOBAIS =====
        let ultimoResultado = null;
        let todosResultados = [];
        let dadosAPI = null;
        let sistemaValores = {
            valorSimples: 6.00,
            multiplicadores: {
                7: 7, 8: 28, 9: 84, 10: 210, 11: 462, 12: 924, 13: 1716, 14: 3003, 15: 5005
            },
            obterValor: function(dezenas) {
                if (dezenas === 6) return this.valorSimples;
                return this.valorSimples * (this.multiplicadores[dezenas] || 1);
            }
        };
        
        let numerosDropArea = [];
        let meusJogos = [];
        
        // ===== INICIALIZA√á√ÉO =====
        document.addEventListener('DOMContentLoaded', function() {
            if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                document.documentElement.classList.add('dark');
            }
            
            window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
                if (event.matches) {
                    document.documentElement.classList.add('dark');
                } else {
                    document.documentElement.classList.remove('dark');
                }
            });
            
            inicializarSistema();
        });
        
        async function inicializarSistema() {
            try {
                mostrarLoading('Carregando dados da Mega Sena...', 10);
                
                // Simular carregamento dos dados
                await new Promise(resolve => setTimeout(resolve, 1000));
                mostrarLoading('Processando resultados...', 30);
                
                // Carregar dados simulados
                await carregarDadosSimulados();
                mostrarLoading('Configurando interface...', 60);
                
                // Inicializar componentes
                await new Promise(resolve => setTimeout(resolve, 500));
                inicializarComponentes();
                mostrarLoading('Finalizando...', 90);
                
                await new Promise(resolve => setTimeout(resolve, 500));
                mostrarLoading('Pronto!', 100);
                
                setTimeout(() => {
                    esconderLoading();
                    configurarEventListeners();
                }, 500);
                
            } catch (error) {
                console.error('Erro ao inicializar:', error);
                document.getElementById('loadingDetails').textContent = 'Erro ao carregar dados. Usando dados simulados.';
                setTimeout(() => {
                    esconderLoading();
                    configurarEventListeners();
                }, 2000);
            }
        }
        
        async function carregarDadosSimulados() {
            // Dados simulados do √∫ltimo resultado
            ultimoResultado = {
                numero: 2903,
                dataApuracao: '2025-01-20',
                listaDezenas: ['20', '24', '27', '46', '50', '54'],
                listaRateioPremio: [
                    { descricaoFaixa: 'Sena', numeroDeGanhadores: 0, valorPremio: 0 },
                    { descricaoFaixa: 'Quina', numeroDeGanhadores: 127, valorPremio: 48532.17 },
                    { descricaoFaixa: 'Quadra', numeroDeGanhadores: 9847, valorPremio: 856.34 }
                ],
                valorEstimadoProximoConcurso: 85000000,
                numeroConcursoProximo: 2904,
                dataProximoConcurso: '2025-01-23'
            };
            
            // Atualizar informa√ß√µes na tela
            atualizarUltimoResultado();
            atualizarInformacoesEstrategicas();
        }
        
        function inicializarComponentes() {
            // Preencher select de quantidade de dezenas
            const selectDezenas = document.getElementById('quantidadeDezenas');
            if (selectDezenas) {
                for (let i = 6; i <= 15; i++) {
                    const option = document.createElement('option');
                    option.value = i;
                    option.textContent = `${i} dezenas (${sistemaValores.obterValor(i) > 6 ? formatarMoeda(sistemaValores.obterValor(i)) : 'R$ 6,00'})`;
                    if (i === 6) option.selected = true;
                    selectDezenas.appendChild(option);
                }
            }
            
            // Criar grid de n√∫meros
            criarGridNumeros();
            
            // Inicializar todas as se√ß√µes
            inicializarFechamento();
            inicializarGemeos();
            inicializarAtrasos();
            inicializarHeatmap();
            inicializarCiclos();
            inicializarPadroes();
            inicializarFiltros();
            inicializarComparacao();
        }
        
        function criarGridNumeros() {
            const grid = document.getElementById('gridNumeros');
            if (!grid) return;
            
            grid.innerHTML = '';
            for (let i = 1; i <= 60; i++) {
                const numero = formatarNumero(i);
                const div = document.createElement('div');
                div.className = 'numero-mega cursor-pointer transition-all';
                div.textContent = numero;
                div.dataset.numero = numero;
                div.draggable = true;
                div.onclick = () => toggleNumero(numero);
                div.ondragstart = drag;
                div.ondragend = dragEnd;
                
                // Marcar se √© par ou √≠mpar para estrat√©gia visual
                if (i % 2 === 0) div.classList.add('par');
                else div.classList.add('impar');
                
                grid.appendChild(div);
            }
        }
        
        function configurarEventListeners() {
            // Configura√ß√£o principal
            document.getElementById('btnAtualizarValores')?.addEventListener('click', atualizarValores);
            
            // Se√ß√£o manual
            document.getElementById('processarInput')?.addEventListener('click', processarInputManual);
            document.getElementById('limparJogo')?.addEventListener('click', limparJogo);
            document.getElementById('randomizarJogo')?.addEventListener('click', randomizarJogo);
            document.getElementById('adicionarJogo')?.addEventListener('click', adicionarJogo);
            document.getElementById('limparArea')?.addEventListener('click', limparDropArea);
            
            // Se√ß√µes minimalistas
            document.getElementById('gerarJogosMin')?.addEventListener('click', gerarJogosMinimalistas);
            document.getElementById('adicionarTodosMin')?.addEventListener('click', () => adicionarTodosJogos('min'));
            
            // Se√ß√£o posi√ß√µes
            document.getElementById('preencherPosicoes')?.addEventListener('click', preencherBasePosicoes);
            document.getElementById('gerarJogosPos')?.addEventListener('click', gerarJogosPosicoes);
            document.getElementById('adicionarTodosPos')?.addEventListener('click', () => adicionarTodosJogos('pos'));
            
            // Se√ß√£o alterados
            document.getElementById('gerarJogosAlt')?.addEventListener('click', gerarJogosAlterados);
            document.getElementById('adicionarTodosAlt')?.addEventListener('click', () => adicionarTodosJogos('alt'));
            
            // Se√ß√£o regras fixas
            document.getElementById('gerarJogosFix')?.addEventListener('click', gerarJogosRegrasFixas);
            document.getElementById('adicionarTodosFix')?.addEventListener('click', () => adicionarTodosJogos('fix'));
            
            // Modais
            document.getElementById('modalManualBtn')?.addEventListener('click', () => abrirModal('modalManual'));
            document.getElementById('modalMinimalistaBtn')?.addEventListener('click', () => abrirModal('modalMinimalista'));
            document.getElementById('modalPosicoesBtn')?.addEventListener('click', () => abrirModal('modalPosicoes'));
            document.getElementById('modalAlteradosBtn')?.addEventListener('click', () => abrirModal('modalAlterados'));
            document.getElementById('modalRegrasFixasBtn')?.addEventListener('click', () => abrirModal('modalRegrasFixas'));
            document.getElementById('modalFechamentoBtn')?.addEventListener('click', () => abrirModal('modalFechamento'));
            document.getElementById('modalGemeosBtn')?.addEventListener('click', () => abrirModal('modalGemeos'));
            document.getElementById('modalAtrasosBtn')?.addEventListener('click', () => abrirModal('modalAtrasos'));
            document.getElementById('modalHeatmapBtn')?.addEventListener('click', () => abrirModal('modalHeatmap'));
            document.getElementById('modalCiclosBtn')?.addEventListener('click', () => abrirModal('modalCiclos'));
            document.getElementById('modalPadroesBtn')?.addEventListener('click', () => abrirModal('modalPadroes'));
            document.getElementById('modalFiltrosBtn')?.addEventListener('click', () => abrirModal('modalFiltros'));
            document.getElementById('modalComparacaoBtn')?.addEventListener('click', () => abrirModal('modalComparacao'));
        }
        
        // ===== FUN√á√ïES B√ÅSICAS =====
        
        function formatarMoeda(valor) {
            return new Intl.NumberFormat('pt-BR', {
                style: 'currency',
                currency: 'BRL'
            }).format(valor);
        }
        
        function formatarNumero(numero) {
            return numero.toString().padStart(2, '0');
        }
        
        function mostrarLoading(detalhes, progresso = 0) {
            document.getElementById('loadingDetails').textContent = detalhes;
            document.getElementById('progressBar').style.width = `${progresso}%`;
        }
        
        function esconderLoading() {
            document.getElementById('loading').classList.add('hidden');
            document.getElementById('interfacePrincipal').classList.remove('hidden');
        }
        
        function mostrarAlerta(mensagem) {
            // Criar modal personalizado j√° que alert() n√£o √© permitido
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
            modal.innerHTML = `
                <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-lg max-w-sm w-full mx-4">
                    <p class="text-gray-700 dark:text-gray-300 mb-4">${mensagem}</p>
                    <div class="flex justify-end">
                        <button onclick="this.closest('.fixed').remove()" class="px-4 py-2 bg-megasena text-white hover:bg-megasena-dark rounded">OK</button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }
        
        function abrirModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.classList.remove('hidden');
            }
        }
        
        function fecharModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.classList.add('hidden');
            }
        }
        
        // ===== FUN√á√ïES DRAG AND DROP =====
        
        function allowDrop(ev) {
            ev.preventDefault();
            const dropZone = document.getElementById('dropZone');
            dropZone.classList.add('drag-over');
        }

        function dragEnter(ev) {
            ev.preventDefault();
            const dropZone = document.getElementById('dropZone');
            dropZone.classList.add('drag-over');
        }

        function dragLeave(ev) {
            ev.preventDefault();
            const dropZone = document.getElementById('dropZone');
            if (!dropZone.contains(ev.relatedTarget)) {
                dropZone.classList.remove('drag-over');
            }
        }

        function drop(ev) {
            ev.preventDefault();
            const dropZone = document.getElementById('dropZone');
            dropZone.classList.remove('drag-over');
            
            const numero = ev.dataTransfer.getData("text");
            if (numero && !numerosDropArea.includes(numero)) {
                adicionarNumeroDropArea(numero);
                marcarNumeroSelecionado(numero);
            }
        }

        function drag(ev) {
            ev.dataTransfer.setData("text", ev.target.dataset.numero);
            ev.target.classList.add('dragging');
        }

        function dragEnd(ev) {
            ev.target.classList.remove('dragging');
        }
        
        // ===== FUN√á√ïES DE JOGO MANUAL =====
        
        function toggleNumero(numero) {
            const quantidadeEspecificada = parseInt(document.getElementById('quantidadeDezenas').value);
            
            if (numerosDropArea.includes(numero)) {
                removerNumeroDropArea(numero);
                desmarcarNumeroSelecionado(numero);
            } else if (numerosDropArea.length < quantidadeEspecificada) {
                adicionarNumeroDropArea(numero);
                marcarNumeroSelecionado(numero);
            } else {
                mostrarAlerta(`Voc√™ j√° selecionou ${quantidadeEspecificada} n√∫meros!`);
            }
        }
        
        function adicionarNumeroDropArea(numero) {
            if (!numerosDropArea.includes(numero)) {
                numerosDropArea.push(numero);
                atualizarDropArea();
                atualizarEstrategiaInfo();
            }
        }
        
        function removerNumeroDropArea(numero) {
            const index = numerosDropArea.indexOf(numero);
            if (index > -1) {
                numerosDropArea.splice(index, 1);
                atualizarDropArea();
                atualizarEstrategiaInfo();
            }
        }
        
        function marcarNumeroSelecionado(numero) {
            const elemento = document.querySelector(`[data-numero="${numero}"]`);
            if (elemento) {
                elemento.classList.add('selecionado');
            }
        }
        
        function desmarcarNumeroSelecionado(numero) {
            const elemento = document.querySelector(`[data-numero="${numero}"]`);
            if (elemento) {
                elemento.classList.remove('selecionado');
            }
        }
        
        function atualizarDropArea() {
            const dropMessage = document.getElementById('dropMessage');
            const numerosDropped = document.getElementById('numerosDropped');
            const contadorArea = document.getElementById('numerosNaArea');
            
            if (numerosDropArea.length === 0) {
                dropMessage.classList.remove('hidden');
                numerosDropped.classList.add('hidden');
            } else {
                dropMessage.classList.add('hidden');
                numerosDropped.classList.remove('hidden');
                
                numerosDropped.innerHTML = '';
                numerosDropArea.forEach(numero => {
                    const div = document.createElement('div');
                    div.className = 'numero-drop';
                    div.innerHTML = `
                        ${numero}
                        <span class="remove-btn" onclick="removerNumeroDropArea('${numero}'); desmarcarNumeroSelecionado('${numero}');">√ó</span>
                    `;
                    numerosDropped.appendChild(div);
                });
            }
            
            contadorArea.textContent = numerosDropArea.length;
            
            // Habilitar/desabilitar bot√£o de adicionar
            const quantidadeEspecificada = parseInt(document.getElementById('quantidadeDezenas').value);
            const botaoAdicionar = document.getElementById('adicionarJogo');
            if (botaoAdicionar) {
                botaoAdicionar.disabled = numerosDropArea.length !== quantidadeEspecificada;
            }
        }
        
        function calcularParesImpares(numeros) {
            let pares = 0, impares = 0;
            numeros.forEach(num => {
                if (parseInt(num) % 2 === 0) pares++;
                else impares++;
            });
            return { pares, impares };
        }
        
        function atualizarEstrategiaInfo() {
            const pares = numerosDropArea.filter(n => parseInt(n) % 2 === 0).length;
            const impares = numerosDropArea.filter(n => parseInt(n) % 2 === 1).length;
            
            document.getElementById('paresAtuais').textContent = pares;
            document.getElementById('imparesAtuais').textContent = impares;
            
            const statusElem = document.getElementById('statusEstrategia');
            const dicaElem = document.getElementById('dicaEstrategia');
            
            if (numerosDropArea.length === 0) {
                statusElem.textContent = 'üéØ Selecione n√∫meros para ver sua estrat√©gia';
                statusElem.className = 'text-center p-3 rounded-lg font-bold text-lg bg-gray-100 text-gray-700';
                dicaElem.innerHTML = 'üí° <strong>Dica:</strong> O padr√£o 3P/3I √© o mais comum com 30.4% dos sorteios!';
                return;
            }
            
            if (pares === 3 && impares === 3) {
                statusElem.textContent = 'üèÜ PERFEITO! Padr√£o 3P/3I (30.4% dos sorteios)';
                statusElem.className = 'text-center p-3 rounded-lg font-bold text-lg meta-atingida';
                dicaElem.innerHTML = 'üéØ <strong>Excelente!</strong> Voc√™ est√° seguindo o padr√£o mais comum da Mega Sena!';
            } else if (pares + impares === 6) {
                const diff = Math.abs(pares - 3);
                if (diff === 1) {
                    statusElem.textContent = `‚úÖ BOM! Padr√£o ${pares}P/${impares}I (${pares === 4 ? '24.6' : '24.2'}% dos sorteios)`;
                    statusElem.className = 'text-center p-3 rounded-lg font-bold text-lg bg-green-500 text-white';
                    dicaElem.innerHTML = 'üëç <strong>Bom padr√£o!</strong> Segundo e terceiro mais comuns na Mega Sena.';
                } else {
                    statusElem.textContent = `‚ö†Ô∏è RARO! Padr√£o ${pares}P/${impares}I (menos comum)`;
                    statusElem.className = 'text-center p-3 rounded-lg font-bold text-lg meta-excedida';
                    dicaElem.innerHTML = '‚ö†Ô∏è <strong>Aten√ß√£o:</strong> Este padr√£o √© menos comum. Considere ajustar.';
                }
            } else {
                const falta = 6 - (pares + impares);
                statusElem.textContent = `üéØ Faltam ${falta} n√∫mero(s) para completar`;
                statusElem.className = 'text-center p-3 rounded-lg font-bold text-lg bg-blue-500 text-white';
                
                const paresTarget = 3;
                const imparesTarget = 3;
                const precisa = [];
                if (pares < paresTarget) precisa.push(`${paresTarget - pares} par(es)`);
                if (impares < imparesTarget) precisa.push(`${imparesTarget - impares} √≠mpar(es)`);
                
                if (precisa.length > 0) {
                    dicaElem.innerHTML = `üí° <strong>Sugest√£o:</strong> Adicione ${precisa.join(' e ')} para atingir 3P/3I ideal.`;
                } else {
                    dicaElem.innerHTML = 'üéØ <strong>Continue:</strong> Voc√™ est√° no caminho certo para o padr√£o ideal!';
                }
            }
        }
        
        function processarInputManual() {
            const input = document.getElementById('inputManual').value;
            if (!input.trim()) {
                mostrarAlerta('Digite alguns n√∫meros primeiro!');
                return;
            }
            
            // Extrair n√∫meros do texto
            const numerosEncontrados = input.match(/\d+/g) || [];
            const numerosValidos = numerosEncontrados
                .map(n => parseInt(n))
                .filter(n => n >= 1 && n <= 60)
                .map(n => formatarNumero(n));
            
            // Remover duplicatas
            const numerosUnicos = [...new Set(numerosValidos)];
            
            if (numerosUnicos.length === 0) {
                mostrarAlerta('Nenhum n√∫mero v√°lido encontrado! Use n√∫meros de 01 a 60.');
                return;
            }
            
            // Limpar sele√ß√£o atual
            limparJogo();
            
            // Adicionar n√∫meros encontrados (m√°ximo conforme quantidade especificada)
            const quantidadeEspecificada = parseInt(document.getElementById('quantidadeDezenas').value);
            const numerosParaAdicionar = numerosUnicos.slice(0, quantidadeEspecificada);
            
            numerosParaAdicionar.forEach(numero => {
                adicionarNumeroDropArea(numero);
                marcarNumeroSelecionado(numero);
            });
            
            document.getElementById('inputManual').value = '';
            
            if (numerosUnicos.length > quantidadeEspecificada) {
                mostrarAlerta(`Encontrados ${numerosUnicos.length} n√∫meros, mas foram usados apenas os primeiros ${quantidadeEspecificada}.`);
            } else {
                mostrarAlerta(`${numerosUnicos.length} n√∫meros v√°lidos adicionados!`);
            }
        }
        
        function limparJogo() {
            // Limpar arrays
            numerosDropArea = [];
            
            // Limpar visual
            document.querySelectorAll('.numero-mega.selecionado').forEach(el => {
                el.classList.remove('selecionado');
            });
            
            atualizarDropArea();
            atualizarEstrategiaInfo();
        }
        
        function limparDropArea() {
            limparJogo();
        }
        
        function randomizarJogo() {
            limparJogo();
            
            const quantidadeEspecificada = parseInt(document.getElementById('quantidadeDezenas').value);
            const numerosDisponiveis = [];
            
            for (let i = 1; i <= 60; i++) {
                numerosDisponiveis.push(formatarNumero(i));
            }
            
            // Selecionar n√∫meros aleat√≥rios
            for (let i = 0; i < quantidadeEspecificada; i++) {
                const indiceAleatorio = Math.floor(Math.random() * numerosDisponiveis.length);
                const numeroEscolhido = numerosDisponiveis[indiceAleatorio];
                
                adicionarNumeroDropArea(numeroEscolhido);
                marcarNumeroSelecionado(numeroEscolhido);
                
                numerosDisponiveis.splice(indiceAleatorio, 1);
            }
        }
        
        function adicionarJogo() {
            const quantidadeEspecificada = parseInt(document.getElementById('quantidadeDezenas').value);
            
            if (numerosDropArea.length !== quantidadeEspecificada) {
                mostrarAlerta(`Selecione exatamente ${quantidadeEspecificada} n√∫meros!`);
                return;
            }
            
            const jogoParaAdicionar = [...numerosDropArea].sort((a, b) => parseInt(a) - parseInt(b));
            
            // Verificar se j√° existe
            const jaExiste = meusJogos.some(jogo => 
                jogo.numeros.length === jogoParaAdicionar.length &&
                jogo.numeros.every((num, index) => num === jogoParaAdicionar[index])
            );
            
            if (jaExiste) {
                mostrarAlerta('Este jogo j√° foi adicionado!');
                return;
            }
            
            // Adicionar aos meus jogos
            const novoJogo = {
                id: Date.now(),
                numeros: jogoParaAdicionar,
                dezenas: quantidadeEspecificada,
                valor: sistemaValores.obterValor(quantidadeEspecificada),
                tipo: 'Manual',
                estrategia: obterEstrategiaAtual()
            };
            
            meusJogos.push(novoJogo);
            atualizarListaMeusJogos();
            
            mostrarAlerta('Jogo adicionado com sucesso!');
            limparJogo();
        }
        
        function obterEstrategiaAtual() {
            const pares = numerosDropArea.filter(n => parseInt(n) % 2 === 0).length;
            const impares = numerosDropArea.filter(n => parseInt(n) % 2 === 1).length;
            
            if (pares === 3 && impares === 3) return '3P/3I (Ideal)';
            if (pares === 4 && impares === 2) return '4P/2I (Comum)';
            if (pares === 2 && impares === 4) return '2P/4I (Comum)';
            return `${pares}P/${impares}I`;
        }
        
        // ===== FUN√á√ïES DO SISTEMA =====
        
        function atualizarValores() {
            const novoValor = parseFloat(document.getElementById('valorApostaSimples').value);
            
            if (isNaN(novoValor) || novoValor <= 0) {
                mostrarAlerta('Digite um valor v√°lido!');
                return;
            }
            
            sistemaValores.valorSimples = novoValor;
            
            // Atualizar multiplicadores na tela
            document.getElementById('valor7').textContent = formatarMoeda(sistemaValores.obterValor(7));
            document.getElementById('valor8').textContent = formatarMoeda(sistemaValores.obterValor(8));
            document.getElementById('valor15').textContent = formatarMoeda(sistemaValores.obterValor(15));
            
            // Atualizar status
            document.getElementById('statusSistema').textContent = '‚úÖ Valores atualizados';
            document.getElementById('ultimaAtualizacao').textContent = new Date().toLocaleString('pt-BR');
            
            // Recriar select de dezenas
            const selectDezenas = document.getElementById('quantidadeDezenas');
            if (selectDezenas) {
                const valorAtual = selectDezenas.value;
                selectDezenas.innerHTML = '';
                for (let i = 6; i <= 15; i++) {
                    const option = document.createElement('option');
                    option.value = i;
                    option.textContent = `${i} dezenas (${formatarMoeda(sistemaValores.obterValor(i))})`;
                    if (i.toString() === valorAtual) option.selected = true;
                    selectDezenas.appendChild(option);
                }
            }
            
            mostrarAlerta('Valores atualizados com sucesso!');
        }
        
        function atualizarUltimoResultado() {
            if (!ultimoResultado) return;
            
            document.getElementById('ultimoResultado').classList.remove('hidden');
            
            // T√≠tulo e data
            document.getElementById('tituloResultado').textContent = `Concurso ${ultimoResultado.numero}`;
            document.getElementById('dataResultado').textContent = `üìÖ ${new Date(ultimoResultado.dataApuracao).toLocaleDateString('pt-BR')}`;
            
            // N√∫meros sorteados
            const containerNumeros = document.getElementById('numerosResultado');
            containerNumeros.innerHTML = '';
            ultimoResultado.listaDezenas.forEach(numero => {
                const div = document.createElement('div');
                div.className = 'numero-resultado-oficial';
                div.textContent = numero;
                containerNumeros.appendChild(div);
            });
            
            // Status do pr√™mio
            const sena = ultimoResultado.listaRateioPremio.find(p => p.descricaoFaixa === 'Sena');
            if (sena && sena.numeroDeGanhadores === 0) {
                document.getElementById('statusResultado').textContent = 'üéØ ACUMULOU!';
            } else {
                document.getElementById('statusResultado').textContent = 'üèÜ TEVE GANHADOR!';
            }
            
            // Premia√ß√£o
            const quina = ultimoResultado.listaRateioPremio.find(p => p.descricaoFaixa === 'Quina');
            const quadra = ultimoResultado.listaRateioPremio.find(p => p.descricaoFaixa === 'Quadra');
            
            if (quina) {
                document.getElementById('premiacao5').innerHTML = `
                    <strong>Quina:</strong> ${quina.numeroDeGanhadores} ganhador(es) - ${formatarMoeda(quina.valorPremio)}
                `;
            }
            
            if (quadra) {
                document.getElementById('premiacao4').innerHTML = `
                    <strong>Quadra:</strong> ${quadra.numeroDeGanhadores} ganhador(es) - ${formatarMoeda(quadra.valorPremio)}
                `;
            }
            
            // Pr√≥ximo concurso
            document.getElementById('proximoConcurso').textContent = `Concurso ${ultimoResultado.numeroConcursoProximo}`;
            document.getElementById('dataProximoConcurso').textContent = new Date(ultimoResultado.dataProximoConcurso).toLocaleDateString('pt-BR');
            document.getElementById('premioEstimado').textContent = formatarMoeda(ultimoResultado.valorEstimadoProximoConcurso);
        }
        
        function atualizarInformacoesEstrategicas() {
            if (!ultimoResultado) return;
            
            // Atualizar informa√ß√µes de pares/√≠mpares em todas as se√ß√µes
            const { pares, impares } = calcularParesImpares(ultimoResultado.listaDezenas);
            
            // Se√ß√£o minimalista
            if (document.getElementById('infoParesMin')) {
                document.getElementById('infoParesMin').textContent = pares;
                document.getElementById('infoImparesMin').textContent = impares;
            }
            
            // Se√ß√£o posi√ß√µes
            if (document.getElementById('infoParesPos')) {
                document.getElementById('infoParesPos').textContent = pares;
                document.getElementById('infoImparesPos').textContent = impares;
                document.getElementById('infoNumerosPosicoes').textContent = ultimoResultado.listaDezenas.join(', ');
            }
            
            // Se√ß√£o alterados
            if (document.getElementById('infoParesAlt')) {
                document.getElementById('infoParesAlt').textContent = pares;
                document.getElementById('infoImparesAlt').textContent = impares;
                document.getElementById('infoNumerosBase').textContent = ultimoResultado.listaDezenas.join(', ');
                
                // Exibir n√∫meros base
                const containerBase = document.getElementById('numerosBaseAlterados');
                if (containerBase) {
                    containerBase.innerHTML = '';
                    ultimoResultado.listaDezenas.forEach(numero => {
                        const span = document.createElement('span');
                        span.className = 'numero-base';
                        span.textContent = numero;
                        containerBase.appendChild(span);
                    });
                }
            }
            
            // Se√ß√£o regras fixas
            if (document.getElementById('infoParesFixas')) {
                document.getElementById('infoParesFixas').textContent = pares;
                document.getElementById('infoImparesFixas').textContent = impares;
                
                const baixos = ultimoResultado.listaDezenas.filter(n => parseInt(n) <= 30).length;
                const altos = ultimoResultado.listaDezenas.filter(n => parseInt(n) >= 31).length;
                document.getElementById('infoFaixa1').textContent = baixos;
                document.getElementById('infoFaixa2').textContent = altos;
            }
            
            // Atualizar estrat√©gia no painel principal
            document.getElementById('paresUltimoSorteio').textContent = pares;
            document.getElementById('imparesUltimoSorteio').textContent = impares;
        }
        
        // ===== SE√á√ïES MINIMALISTAS =====
        
        function gerarJogosMinimalistas() {
            const qtdJogos = parseInt(document.getElementById('qtdJogosMin').value);
            const dezenasPorJogo = parseInt(document.getElementById('dezenasPorJogoMin').value);
            const estrategia = document.getElementById('estrategiaMin').value;
            
            const jogos = [];
            
            for (let i = 0; i < qtdJogos; i++) {
                const jogo = gerarJogoMinimalista(dezenasPorJogo, estrategia);
                if (jogo && jogo.length === dezenasPorJogo) {
                    jogos.push(jogo.sort((a, b) => parseInt(a) - parseInt(b)));
                }
            }
            
            exibirJogosGerados('min', jogos, 'Minimalista');
        }
        
        function gerarJogoMinimalista(dezenas, estrategia) {
            const jogo = [];
            const numerosDisponiveis = [];
            
            for (let i = 1; i <= 60; i++) {
                numerosDisponiveis.push(formatarNumero(i));
            }
            
            if (estrategia === 'equilibrada') {
                // Estrat√©gia 3P/3I para 6 dezenas
                const paresNecessarios = Math.ceil(dezenas / 2);
                const imparesNecessarios = dezenas - paresNecessarios;
                
                let pares = 0, impares = 0;
                
                while (jogo.length < dezenas && numerosDisponiveis.length > 0) {
                    const indice = Math.floor(Math.random() * numerosDisponiveis.length);
                    const numero = numerosDisponiveis[indice];
                    const ehPar = parseInt(numero) % 2 === 0;
                    
                    if ((ehPar && pares < paresNecessarios) || (!ehPar && impares < imparesNecessarios) || 
                        (pares === paresNecessarios && !ehPar) || (impares === imparesNecessarios && ehPar)) {
                        jogo.push(numero);
                        if (ehPar) pares++;
                        else impares++;
                        numerosDisponiveis.splice(indice, 1);
                    } else {
                        numerosDisponiveis.splice(indice, 1);
                    }
                }
            } else {
                // Outras estrat√©gias - sele√ß√£o mais simples
                for (let i = 0; i < dezenas && numerosDisponiveis.length > 0; i++) {
                    const indice = Math.floor(Math.random() * numerosDisponiveis.length);
                    jogo.push(numerosDisponiveis[indice]);
                    numerosDisponiveis.splice(indice, 1);
                }
            }
            
            return jogo;
        }
        
        // ===== SE√á√ïES POR POSI√á√ïES =====
        
        function preencherBasePosicoes() {
            if (!ultimoResultado || !ultimoResultado.listaDezenas) {
                mostrarAlerta('Dados do √∫ltimo resultado n√£o dispon√≠veis!');
                return;
            }
            
            const numeros = ultimoResultado.listaDezenas.map(n => parseInt(n)).sort((a, b) => a - b);
            
            // Distribuir n√∫meros por posi√ß√µes com margem
            document.getElementById('pos1').value = gerarVariacoesNumero(numeros[0], 1, 10).join(',');
            document.getElementById('pos2').value = gerarVariacoesNumero(numeros[1], 8, 20).join(',');
            document.getElementById('pos3').value = gerarVariacoesNumero(numeros[2], 18, 35).join(',');
            document.getElementById('pos4').value = gerarVariacoesNumero(numeros[3], 30, 45).join(',');
            document.getElementById('pos5').value = gerarVariacoesNumero(numeros[4], 40, 55).join(',');
            document.getElementById('pos6').value = gerarVariacoesNumero(numeros[5], 50, 60).join(',');
            
            mostrarAlerta('Posi√ß√µes preenchidas baseadas no √∫ltimo resultado!');
        }
        
        function gerarVariacoesNumero(numero, min, max) {
            const variacoes = [numero];
            
            // Adicionar n√∫meros pr√≥ximos
            for (let i = 1; i <= 2; i++) {
                if (numero - i >= min) variacoes.push(numero - i);
                if (numero + i <= max) variacoes.push(numero + i);
            }
            
            return variacoes.slice(0, 3).map(n => formatarNumero(n));
        }
        
        function gerarJogosPosicoes() {
            const qtdJogos = parseInt(document.getElementById('qtdJogosPos').value);
            
            // Obter n√∫meros por posi√ß√£o
            const posicoes = [];
            for (let i = 1; i <= 6; i++) {
                const input = document.getElementById(`pos${i}`).value;
                if (!input.trim()) {
                    mostrarAlerta(`Preencha a posi√ß√£o ${i}!`);
                    return;
                }
                
                const numerosStr = input.split(',').map(s => s.trim()).filter(s => s);
                const numerosValidos = numerosStr.map(s => {
                    const num = parseInt(s);
                    return (num >= 1 && num <= 60) ? formatarNumero(num) : null;
                }).filter(n => n !== null);
                
                if (numerosValidos.length === 0) {
                    mostrarAlerta(`Posi√ß√£o ${i} n√£o tem n√∫meros v√°lidos!`);
                    return;
                }
                
                posicoes.push(numerosValidos);
            }
            
            const jogos = [];
            
            for (let i = 0; i < qtdJogos; i++) {
                const jogo = [];
                const numerosUsados = [];
                
                // Selecionar um n√∫mero de cada posi√ß√£o
                for (let pos = 0; pos < 6; pos++) {
                    const candidatos = posicoes[pos].filter(n => !numerosUsados.includes(n));
                    if (candidatos.length === 0) {
                        // Se n√£o h√° candidatos √∫nicos, usar qualquer um da posi√ß√£o
                        const numeroEscolhido = posicoes[pos][Math.floor(Math.random() * posicoes[pos].length)];
                        jogo.push(numeroEscolhido);
                        numerosUsados.push(numeroEscolhido);
                    } else {
                        const numeroEscolhido = candidatos[Math.floor(Math.random() * candidatos.length)];
                        jogo.push(numeroEscolhido);
                        numerosUsados.push(numeroEscolhido);
                    }
                }
                
                // Verificar se o jogo tem 6 n√∫meros √∫nicos
                const jogoUnico = [...new Set(jogo)];
                if (jogoUnico.length === 6) {
                    jogos.push(jogoUnico.sort((a, b) => parseInt(a) - parseInt(b)));
                }
            }
            
            exibirJogosGerados('pos', jogos, 'Por Posi√ß√µes');
        }
        
        // ===== SE√á√ïES ALTERADOS =====
        
        function gerarJogosAlterados() {
            if (!ultimoResultado || !ultimoResultado.listaDezenas) {
                mostrarAlerta('Dados do √∫ltimo resultado n√£o dispon√≠veis!');
                return;
            }
            
            const qtdJogos = parseInt(document.getElementById('qtdJogosAlt').value);
            const numerosTrocar = parseInt(document.getElementById('numerosTrocar').value);
            const numerosBase = [...ultimoResultado.listaDezenas];
            
            const jogos = [];
            
            for (let i = 0; i < qtdJogos; i++) {
                const jogo = [...numerosBase];
                
                // Trocar alguns n√∫meros aleatoriamente
                for (let j = 0; j < numerosTrocar; j++) {
                    const indiceParaTrocar = Math.floor(Math.random() * jogo.length);
                    let novoNumero;
                    
                    do {
                        novoNumero = formatarNumero(Math.floor(Math.random() * 60) + 1);
                    } while (jogo.includes(novoNumero));
                    
                    jogo[indiceParaTrocar] = novoNumero;
                }
                
                jogos.push(jogo.sort((a, b) => parseInt(a) - parseInt(b)));
            }
            
            exibirJogosGerados('alt', jogos, 'Alterados');
        }
        
        // ===== SE√á√ïES REGRAS FIXAS =====
        
        function gerarJogosRegrasFixas() {
            const qtdJogos = parseInt(document.getElementById('qtdJogosFix').value);
            const qtdPares = parseInt(document.getElementById('qtdPares').value);
            const qtdImpares = parseInt(document.getElementById('qtdImpares').value);
            const faixa1 = parseInt(document.getElementById('faixa1').value);
            const faixa2 = parseInt(document.getElementById('faixa2').value);
            
            const jogos = [];
            
            for (let i = 0; i < qtdJogos; i++) {
                const jogo = gerarJogoComRegrasFixas(qtdPares, qtdImpares, faixa1, faixa2);
                if (jogo && jogo.length === 6) {
                    jogos.push(jogo.sort((a, b) => parseInt(a) - parseInt(b)));
                }
            }
            
            exibirJogosGerados('fix', jogos, 'Regras Fixas');
        }
        
        function gerarJogoComRegrasFixas(qtdPares, qtdImpares, faixa1, faixa2) {
            const jogo = [];
            
            // Gerar n√∫meros da faixa 1 (01-30)
            const numerosFaixa1 = [];
            for (let i = 1; i <= 30; i++) {
                numerosFaixa1.push(formatarNumero(i));
            }
            
            // Gerar n√∫meros da faixa 2 (31-60)
            const numerosFaixa2 = [];
            for (let i = 31; i <= 60; i++) {
                numerosFaixa2.push(formatarNumero(i));
            }
            
            // Selecionar da faixa 1
            let paresSelecionados = 0, imparesSelecionados = 0;
            
            for (let i = 0; i < faixa1; i++) {
                const candidatos = numerosFaixa1.filter(n => !jogo.includes(n));
                if (candidatos.length === 0) break;
                
                let numero;
                if (paresSelecionados < qtdPares && imparesSelecionados < qtdImpares) {
                    numero = candidatos[Math.floor(Math.random() * candidatos.length)];
                } else if (paresSelecionados >= qtdPares) {
                    const impares = candidatos.filter(n => parseInt(n) % 2 === 1);
                    numero = impares[Math.floor(Math.random() * impares.length)];
                } else {
                    const pares = candidatos.filter(n => parseInt(n) % 2 === 0);
                    numero = pares[Math.floor(Math.random() * pares.length)];
                }
                
                if (numero) {
                    jogo.push(numero);
                    if (parseInt(numero) % 2 === 0) paresSelecionados++;
                    else imparesSelecionados++;
                }
            }
            
            // Selecionar da faixa 2
            for (let i = 0; i < faixa2; i++) {
                const candidatos = numerosFaixa2.filter(n => !jogo.includes(n));
                if (candidatos.length === 0) break;
                
                let numero;
                if (paresSelecionados < qtdPares && imparesSelecionados < qtdImpares) {
                    numero = candidatos[Math.floor(Math.random() * candidatos.length)];
                } else if (paresSelecionados >= qtdPares) {
                    const impares = candidatos.filter(n => parseInt(n) % 2 === 1);
                    numero = impares.length > 0 ? impares[Math.floor(Math.random() * impares.length)] : candidatos[Math.floor(Math.random() * candidatos.length)];
                } else {
                    const pares = candidatos.filter(n => parseInt(n) % 2 === 0);
                    numero = pares.length > 0 ? pares[Math.floor(Math.random() * pares.length)] : candidatos[Math.floor(Math.random() * candidatos.length)];
                }
                
                if (numero && !jogo.includes(numero)) {
                    jogo.push(numero);
                    if (parseInt(numero) % 2 === 0) paresSelecionados++;
                    else imparesSelecionados++;
                }
            }
            
            return jogo;
        }
        
        // ===== FUN√á√ïES PARA EXIBIR JOGOS =====
        
        function exibirJogosGerados(secao, jogos, tipoJogo) {
            const containerResultados = document.getElementById(`resultados${secao.charAt(0).toUpperCase() + secao.slice(1)}`);
            const containerLista = document.getElementById(`listaJogos${secao.charAt(0).toUpperCase() + secao.slice(1)}`);
            
            if (!containerResultados || !containerLista) return;
            
            containerLista.innerHTML = '';
            
            if (jogos.length === 0) {
                containerLista.innerHTML = '<div class="text-center text-gray-500">Nenhum jogo gerado</div>';
                containerResultados.classList.remove('hidden');
                return;
            }
            
            jogos.forEach((jogo, index) => {
                const div = document.createElement('div');
                div.className = getCardClass(secao);
                
                const numerosHtml = jogo.map(numero => {
                    return `<span class="${getNumeroClass(secao)}">${numero}</span>`;
                }).join('');
                
                const valor = sistemaValores.obterValor(jogo.length);
                const { pares, impares } = calcularParesImpares(jogo);
                
                div.innerHTML = `
                    <div class="flex justify-between items-center mb-2">
                        <span class="font-bold">Jogo ${index + 1}:</span>
                        <span class="text-sm font-medium">${formatarMoeda(valor)}</span>
                    </div>
                    <div class="flex flex-wrap gap-1 mb-2">
                        ${numerosHtml}
                    </div>
                    <div class="text-xs text-gray-600">
                        ${pares}P/${impares}I ‚Ä¢ ${jogo.length} dezenas ‚Ä¢ ${tipoJogo}
                    </div>
                `;
                
                containerLista.appendChild(div);
            });
            
            containerResultados.classList.remove('hidden');
        }
        
        function getCardClass(secao) {
            const classes = {
                'min': 'jogo-minimalista-card',
                'pos': 'jogo-alterado-card', 
                'alt': 'jogo-alterado-card',
                'fix': 'jogo-regras-fixas-card',
                'fechamento': 'jogo-fechamento-card',
                'gemeos': 'jogo-gemeos-card',
                'atrasos': 'jogo-atrasos-card',
                'heatmap': 'jogo-heatmap-card',
                'ciclo': 'jogo-ciclo-card',
                'padrao': 'jogo-padrao-card',
                'filtros': 'jogo-filtrado-card',
                'comparacao': 'jogo-comparacao-card'
            };
            return classes[secao] || 'jogo-card';
        }
        
        function getNumeroClass(secao) {
            const classes = {
                'min': 'numero-minimalista',
                'pos': 'numero-alterado',
                'alt': 'numero-alterado', 
                'fix': 'numero-regras-fixas',
                'fechamento': 'numero-fechamento',
                'gemeos': 'numero-gemeos',
                'atrasos': 'numero-atrasos',
                'heatmap': 'numero-heatmap-jogo',
                'ciclo': 'numero-ciclo-jogo',
                'padrao': 'numero-padrao-jogo',
                'filtros': 'numero-filtrado-jogo',
                'comparacao': 'numero-comparacao-jogo'
            };
            return classes[secao] || 'numero-jogo';
        }
        
        function adicionarTodosJogos(secao) {
            const containerLista = document.getElementById(`listaJogos${secao.charAt(0).toUpperCase() + secao.slice(1)}`);
            if (!containerLista) return;
            
            const jogosCards = containerLista.querySelectorAll('[class*="jogo-"]');
            let jogosAdicionados = 0;
            
            jogosCards.forEach((card, index) => {
                const numerosElements = card.querySelectorAll('[class*="numero-"]');
                if (numerosElements.length >= 6) {
                    const numeros = Array.from(numerosElements).slice(0, 6).map(el => el.textContent);
                    
                    // Verificar se j√° existe
                    const jaExiste = meusJogos.some(jogo => 
                        jogo.numeros.length === numeros.length &&
                        jogo.numeros.every((num, i) => num === numeros[i])
                    );
                    
                    if (!jaExiste) {
                        const novoJogo = {
                            id: Date.now() + index,
                            numeros: numeros,
                            dezenas: numeros.length,
                            valor: sistemaValores.obterValor(numeros.length),
                            tipo: secao.charAt(0).toUpperCase() + secao.slice(1),
                            estrategia: obterEstrategiaJogo(numeros)
                        };
                        
                        meusJogos.push(novoJogo);
                        jogosAdicionados++;
                    }
                }
            });
            
            if (jogosAdicionados > 0) {
                atualizarListaMeusJogos();
                mostrarAlerta(`${jogosAdicionados} jogo(s) adicionado(s) com sucesso!`);
            } else {
                mostrarAlerta('Nenhum jogo novo para adicionar!');
            }
        }
        
        function obterEstrategiaJogo(numeros) {
            const { pares, impares } = calcularParesImpares(numeros);
            return `${pares}P/${impares}I`;
        }
        
        function atualizarListaMeusJogos() {
            // Esta fun√ß√£o ser√° implementada quando criarmos a se√ß√£o "Meus Jogos"
            console.log('Meus jogos atualizados:', meusJogos.length);
        }
        
        // ===== IMPLEMENTA√á√ïES DAS SE√á√ïES AVAN√áADAS (PLACEHOLDER) =====
        
        function inicializarFechamento() {
            // Implementa√ß√£o b√°sica
            console.log('Fechamento inicializado');
        }
        
        function inicializarGemeos() {
            // Implementa√ß√£o b√°sica
            console.log('G√™meos inicializado');
        }
        
        function inicializarAtrasos() {
            // Implementa√ß√£o b√°sica
            console.log('Atrasos inicializado');
        }
        
        function inicializarHeatmap() {
            // Implementa√ß√£o b√°sica
            console.log('Heatmap inicializado');
        }
        
        function inicializarCiclos() {
            // Implementa√ß√£o b√°sica
            console.log('Ciclos inicializado');
        }
        
        function inicializarPadroes() {
            // Implementa√ß√£o b√°sica
            console.log('Padr√µes inicializado');
        }
        
        function inicializarFiltros() {
            // Implementa√ß√£o b√°sica
            console.log('Filtros inicializado');
        }
        
        function inicializarComparacao() {
            // Implementa√ß√£o b√°sica
            console.log('Compara√ß√£o inicializada');
        }
    </script>
    <style>
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }
        @keyframes glow {
            0%, 100% { box-shadow: 0 0 5px rgba(27, 154, 103, 0.3); }
            50% { box-shadow: 0 0 20px rgba(27, 154, 103, 0.6); }
        }
        .loading-circle {
            width: 80px;
            height: 80px;
            background: linear-gradient(45deg, #1B9A67, #2db87f, #158755);
            border-radius: 50%;
            animation: pulse 2s infinite;
        }
        
        .numero-mega {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, #1B9A67, #2db87f);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.2s;
            border: 2px solid transparent;
        }
        
        .numero-mega:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 15px rgba(27, 154, 103, 0.4);
        }
        
        .numero-mega.selecionado {
            background: linear-gradient(135deg, #dc2626, #ef4444);
            box-shadow: 0 0 0 3px rgba(220, 38, 38, 0.3);
            border-color: #dc2626;
        }
        
        .numero-mega.disabled {
            background: #9ca3af;
            cursor: not-allowed;
            opacity: 0.5;
        }
        
        .numero-mega.sorteado {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            border: 2px solid #fbbf24;
            position: relative;
        }
        
        .numero-mega.sorteado::after {
            content: "üéØ";
            position: absolute;
            top: -8px;
            right: -8px;
            font-size: 12px;
        }
        
        .numero-mega.sorteado.disabled {
            background: #6b7280;
            opacity: 0.4;
            cursor: not-allowed;
        }

        .numero-mega.par {
            border: 2px solid #10b981;
        }
        .numero-mega.impar {
            border: 2px solid #8b5cf6;
        }

        .contador-destaque {
            animation: bounce 1s ease-in-out;
        }
        
        .meta-atingida {
            background: linear-gradient(45deg, #10b981, #34d399) !important;
            color: white;
            animation: pulse 1s infinite;
        }
        
        .meta-excedida {
            background: linear-gradient(45deg, #ef4444, #f87171) !important;
            color: white;
            animation: pulse 0.5s infinite;
        }

        .drop-zone {
            min-height: 120px;
            border: 3px dashed #1B9A67;
            border-radius: 12px;
            background: linear-gradient(135deg, #f0fdf4, #dcfce7);
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            color: #1B9A67;
            font-weight: bold;
            transition: all 0.3s;
            position: relative;
        }

        .drop-zone:hover {
            border-color: #158755;
            background: linear-gradient(135deg, #dcfce7, #bbf7d0);
            transform: scale(1.02);
        }

        .drop-zone.drag-over {
            border-color: #dc2626;
            background: linear-gradient(135deg, #fee2e2, #fecaca);
            border-style: solid;
            animation: pulse 0.5s infinite;
        }

        .drop-zone.has-numbers {
            background: linear-gradient(to right, #f0fdf4, #dcfce7);
            border-style: solid;
            padding: 16px;
            justify-content: flex-start;
            align-items: flex-start;
        }

        .numero-drop {
            width: 35px;
            height: 35px;
            background: linear-gradient(135deg, #1B9A67, #2db87f);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 14px;
            margin: 2px;
            position: relative;
            cursor: move;
            transition: all 0.2s;
        }

        .numero-drop:hover {
            transform: scale(1.1);
            z-index: 10;
        }

        .numero-drop.dragging {
            opacity: 0.5;
            transform: scale(1.1);
            z-index: 1000;
        }

        .numero-drop .remove-btn {
            position: absolute;
            top: -8px;
            right: -8px;
            background: #dc2626;
            color: white;
            border-radius: 50%;
            width: 16px;
            height: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            cursor: pointer;
            opacity: 0;
            transition: opacity 0.2s;
        }

        .numero-drop:hover .remove-btn {
            opacity: 1;
        }
        
        .jogo-card {
            background: linear-gradient(to right, #f0fdf4, #dcfce7);
            border: 2px solid #1B9A67;
            border-radius: 12px;
            padding: 16px;
            margin: 8px 0;
        }
        
        .numero-jogo {
            width: 35px;
            height: 35px;
            background: linear-gradient(135deg, #1B9A67, #2db87f);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 14px;
        }
        
        .custo-total {
            background: linear-gradient(45deg, #1B9A67, #158755);
            color: white;
            padding: 12px 20px;
            border-radius: 8px;
            font-weight: bold;
            font-size: 18px;
        }

        .numero-resultado {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #1B9A67, #2db87f);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 18px;
            margin: 0 4px;
        }

        /* Se√ß√µes destacadas para gera√ß√£o de jogos */
        .secao-geracao {
            border: 3px solid #1B9A67;
            border-radius: 15px;
            background: linear-gradient(135deg, #f0fdf4, #dcfce7);
            position: relative;
            animation: glow 3s ease-in-out infinite;
        }

        .secao-geracao::before {
            content: "üéØ GERA√á√ÉO DE JOGOS";
            position: absolute;
            top: -12px;
            left: 20px;
            background: #1B9A67;
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
        }

        .secao-titulo {
            background: linear-gradient(45deg, #1B9A67, #2db87f);
            color: white;
            padding: 12px 20px;
            margin: -24px -24px 20px -24px;
            border-radius: 12px 12px 0 0;
            font-weight: bold;
            font-size: 18px;
            text-align: center;
        }

        .config-principal {
            background: linear-gradient(135deg, #fef3c7, #fde68a);
            border: 3px solid #f59e0b;
            border-radius: 15px;
            position: relative;
        }

        .config-principal::before {
            content: "‚öôÔ∏è CONFIGURA√á√ÉO PRINCIPAL";
            position: absolute;
            top: -12px;
            left: 20px;
            background: #f59e0b;
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
        }

        /* Estilos para todas as se√ß√µes */
        .numero-base {
            background: linear-gradient(135deg, #1B9A67, #2db87f);
            color: white;
            border-radius: 6px;
            padding: 4px 8px;
            font-size: 12px;
            font-weight: bold;
            margin: 2px;
            display: inline-block;
        }

        .jogo-minimalista-card, .jogo-alterado-card, .jogo-regras-fixas-card {
            background: linear-gradient(to right, #f0fdf4, #dcfce7);
            border: 2px solid #1B9A67;
            border-radius: 12px;
            padding: 12px;
            margin: 8px 0;
        }

        .numero-minimalista, .numero-alterado, .numero-regras-fixas {
            width: 35px;
            height: 35px;
            background: linear-gradient(135deg, #1B9A67, #2db87f);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 14px;
            margin: 2px;
        }

        /* Estilos para informa√ß√µes de pares/√≠mpares */
        .info-pares-impares {
            background: linear-gradient(135deg, #e0f2fe, #b3e5fc);
            border: 2px solid #0288d1;
            border-radius: 8px;
            padding: 12px;
            margin: 12px 0;
        }

        /* Estilos para √°rea de inser√ß√£o manual */
        .input-manual {
            min-height: 80px;
            border: 3px dashed #8b5cf6;
            border-radius: 12px;
            background: linear-gradient(135deg, #faf5ff, #f3e8ff);
            padding: 16px;
            color: #8b5cf6;
            font-weight: bold;
        }

        .input-manual:focus {
            outline: none;
            border-color: #7c3aed;
            background: linear-gradient(135deg, #f3e8ff, #e9d5ff);
            box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.1);
        }

        /* Drag and Drop para n√∫meros do grid */
        .numero-mega.draggable {
            cursor: grab;
        }

        .numero-mega.draggable:active {
            cursor: grabbing;
        }

        .numero-mega.dragging {
            opacity: 0.5;
            transform: scale(1.1);
            z-index: 1000;
            box-shadow: 0 8px 25px rgba(27, 154, 103, 0.6);
        }

        /* Estilos para regras minimalistas */
        .regra-badge {
            background: linear-gradient(45deg, #8b5cf6, #7c3aed);
            color: white;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 10px;
            font-weight: bold;
            margin: 1px;
        }

        .tooltip-regra {
            position: fixed;
            background: #333;
            color: white;
            padding: 12px 16px;
            border-radius: 8px;
            font-size: 13px;
            max-width: 300px;
            z-index: 1000;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            pointer-events: none;
            line-height: 1.4;
        }

        .tooltip-regra::before {
            content: '';
            position: absolute;
            top: -6px;
            left: 50%;
            transform: translateX(-50%);
            border-left: 6px solid transparent;
            border-right: 6px solid transparent;
            border-bottom: 6px solid #333;
        }

        /* Cores da Mega Sena e varia√ß√µes */
        :root {
            --megasena-primary: #1b9a67;
            --megasena-dark: #178257;
            --megasena-light: #d4f7e9;
            --megasena-bg: #e9fbf4;
        }

        .text-megasena { color: var(--megasena-primary); }
        .text-megasena-dark { color: var(--megasena-dark); }
        .bg-megasena { background-color: var(--megasena-primary); }
        .bg-megasena-dark { background-color: var(--megasena-dark); }
        .bg-megasena-light { background-color: var(--megasena-light); }
        .bg-megasena-bg { background-color: var(--megasena-bg); }
        .border-megasena { border-color: var(--megasena-primary); }

        /* Estilos para regras minimalistas */
        .regra-checkbox {
            transform: scale(1.2);
            margin-right: 8px;
        }

        .regra-item {
            background: linear-gradient(135deg, #f0fdf4, #dcfce7);
            border: 2px solid #10b981;
            border-radius: 8px;
            padding: 12px;
            margin: 8px 0;
            transition: all 0.3s;
        }

        .regra-item:hover {
            border-color: #059669;
            transform: scale(1.01);
        }

        .regra-item.ativa {
            background: linear-gradient(135deg, #dcfce7, #bbf7d0);
            border-color: #059669;
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.2);
        }

        .dados-api {
            background: linear-gradient(135deg, #dbeafe, #bfdbfe);
            border: 2px solid #3b82f6;
            border-radius: 12px;
            padding: 16px;
            margin: 16px 0;
        }

        /* Responsivo para mobile */
        @media (max-width: 768px) {
            .numero-mega {
                width: 45px;
                height: 45px;
                font-size: 14px;
            }
            
            .numero-drop {
                width: 30px;
                height: 30px;
                font-size: 12px;
            }
            
            .grid-cols-6 {
                grid-template-columns: repeat(6, minmax(0, 1fr));
                gap: 1px;
            }
        }

        @media (max-width: 480px) {
            .numero-mega {
                width: 40px;
                height: 40px;
                font-size: 12px;
            }
            
            .numero-drop {
                width: 28px;
                height: 28px;
                font-size: 11px;
            }
        }
    </style>
</head>
<body class="bg-megasena-bg min-h-screen">
    <div class="container mx-auto px-4 py-6">
        <!-- Header -->
        <div class="text-center mb-6">
            <h1 class="text-4xl font-bold text-megasena mb-2">üçÄ MEGA SENA</h1>
            <p class="text-gray-600">Gerador Completo com 13 Se√ß√µes Avan√ßadas: Manual + Minimalista + An√°lises + Estrat√©gias</p>
            <div class="mt-3 flex flex-wrap justify-center gap-2">
                <a href="https://resultadosdigitosmegasena.netlify.app" target="_blank" 
                   class="inline-flex items-center bg-blue-500 hover:bg-blue-600 text-white px-3 py-2 rounded-lg text-sm transition-colors">
                    üåê An√°lise dos D√≠gitos
                </a>
                <a href="https://resultadosalteradomegasena.netlify.app" target="_blank" 
                   class="inline-flex items-center bg-orange-500 hover:bg-orange-600 text-white px-3 py-2 rounded-lg text-sm transition-colors">
                    üåê Resultados Alterados
                </a>
                <a href="https://resumomegasena.netlify.app" target="_blank" 
                   class="inline-flex items-center bg-purple-500 hover:bg-purple-600 text-white px-3 py-2 rounded-lg text-sm transition-colors">
                    üåê Estrat√©gia Minimalista
                </a>
            </div>
        </div>

        <!-- ‚öôÔ∏è CONFIGURA√á√ÉO PRINCIPAL DE VALORES -->
        <div class="config-principal p-6 mb-6">
            <div class="secao-titulo">‚öôÔ∏è CONFIGURA√á√ÉO PRINCIPAL - VALORES DA MEGA SENA</div>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                <div>
                    <label class="block text-orange-800 font-medium mb-2">üí∞ Valor da Aposta Simples (6 dezenas):</label>
                    <div class="flex gap-2">
                        <span class="text-orange-800 font-bold text-lg">R$</span>
                        <input 
                            type="number" 
                            id="valorApostaSimples" 
                            value="6.00" 
                            min="1" 
                            max="100" 
                            step="0.01"
                            class="w-24 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 text-base font-bold text-center"
                        >
                        <button id="btnAtualizarValores" class="bg-orange-500 hover:bg-orange-600 text-white px-4 py-2 rounded-lg">
                            üîÑ Atualizar
                        </button>
                    </div>
                    <div class="text-xs text-orange-600 mt-1">
                        <strong>Padr√£o oficial:</strong> R$ 6,00 (CEF)
                    </div>
                </div>
                
                <div>
                    <label class="block text-orange-800 font-medium mb-2">üìä Multiplicadores Autom√°ticos:</label>
                    <div class="bg-white p-3 rounded border text-xs">
                        <div><strong>7 dezenas:</strong> <span id="mult7">7x</span> = <span id="valor7">R$ 42,00</span></div>
                        <div><strong>8 dezenas:</strong> <span id="mult8">28x</span> = <span id="valor8">R$ 168,00</span></div>
                        <div><strong>15 dezenas:</strong> <span id="mult15">5005x</span> = <span id="valor15">R$ 30.030,00</span></div>
                    </div>
                </div>
                
                <div>
                    <label class="block text-orange-800 font-medium mb-2">üí° Status do Sistema:</label>
                    <div class="bg-green-100 p-3 rounded border text-xs text-green-800">
                        <div id="statusSistema">‚úÖ Sistema configurado</div>
                        <div><strong>√öltima atualiza√ß√£o:</strong> <span id="ultimaAtualizacao">-</span></div>
                        <div><strong>Total de se√ß√µes:</strong> 13 (Manual + Min + 11 Avan√ßadas)</div>
                    </div>
                </div>
            </div>
            
            <div class="bg-orange-100 border border-orange-300 rounded p-3 text-sm text-orange-800">
                <strong>üìå Como funciona:</strong> Defina o valor da aposta simples acima e todos os outros valores ser√£o calculados automaticamente usando os multiplicadores oficiais da Caixa. O sistema atualiza automaticamente todas as 13 se√ß√µes de gera√ß√£o de jogos.
            </div>
        </div>

        <!-- Loading -->
        <div id="loading" class="text-center py-8">
            <div class="loading-circle mx-auto mb-4"></div>
            <p class="text-megasena font-medium">üîç Carregando dados da Mega Sena...</p>
            <div class="mt-4">
                <div id="loadingDetails" class="text-sm text-gray-600">Inicializando sistema...</div>
                <div id="loadingProgress" class="w-full bg-gray-200 rounded-full h-2 mt-2">
                    <div id="progressBar" class="bg-megasena h-2 rounded-full transition-all duration-300" style="width: 0%"></div>
                </div>
            </div>
        </div>

        <!-- √öltimo Resultado -->
        <div id="ultimoResultado" class="hidden mb-6">
            <div class="bg-white rounded-lg shadow-lg overflow-hidden border-2 border-megasena">
                <div class="bg-megasena text-white p-4 text-center">
                    <h2 id="tituloResultado" class="text-xl font-bold">Concurso</h2>
                    <div id="dataResultado" class="text-sm">üìÖ Data do sorteio</div>
                </div>
                
                <div class="p-6 text-center">
                    <div id="numerosResultado" class="flex justify-center gap-2 mb-4">
                        <!-- N√∫meros sorteados ser√£o inseridos aqui -->
                    </div>
                    
                    <div id="statusResultado" class="text-lg font-bold mb-4 text-red-600">
                        <!-- Status ser√° inserido aqui -->
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
                        <div id="premiacao5" class="flex items-center justify-center">
                            <!-- Premia√ß√£o 5 acertos -->
                        </div>
                        <div id="premiacao4" class="flex items-center justify-center">
                            <!-- Premia√ß√£o 4 acertos -->
                        </div>
                    </div>
                    
                    <div class="mt-4 text-center">
                        <div class="text-sm text-gray-600">Pr√≥ximo Sorteio: <span id="proximoConcurso">Concurso</span></div>
                        <div class="text-sm text-gray-600" id="dataProximoConcurso">Data</div>
                        <div class="text-2xl font-bold text-megasena mt-2" id="premioEstimado">
                            Pr√™mio Estimado
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Interface Principal - 13 Se√ß√µes Completas -->
        <div id="interfacePrincipal" class="hidden grid grid-cols-1 xl:grid-cols-2 gap-6">
            
            <!-- LADO ESQUERDO: Todas as 13 Se√ß√µes de Gera√ß√£o -->
            <div class="space-y-6">
                
                <!-- üéØ SE√á√ÉO 1: JOGO MANUAL COMPLETO -->
                <div class="secao-geracao bg-white rounded-lg shadow-lg p-6">
                    <div class="secao-titulo">üéÆ SE√á√ÉO 1: CRIA√á√ÉO MANUAL DE JOGOS</div>
                    <div class="mt-3 flex justify-center gap-2">
                        <a href="https://resumomegasena-i.netlify.app" target="_blank" 
                           class="inline-flex items-center bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg text-sm transition-colors">
                            üåê Padr√µes Identificados
                        </a>
                        <button id="modalManualBtn" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg text-sm">
                            ‚ùì Como Funciona
                        </button>
                    </div><br />

                    <!-- üéØ ESTRAT√âGIA: PARES vs √çMPARES (TEMPO REAL) -->
                    <div class="mb-6 p-5 bg-gradient-to-br from-green-50 via-blue-50 to-purple-50 border-4 border-green-400 rounded-xl shadow-lg">
                        <div class="text-xl font-bold text-gray-800 mb-4 text-center">‚ö™ ESTRAT√âGIA: PARES vs √çMPARES (TEMPO REAL)</div>
                        
                        <!-- üéØ PADR√ÉO HIST√ìRICO MAIS COMUM -->
                        <div id="padraoHistorico" class="mb-4 p-4 bg-gradient-to-r from-amber-50 to-orange-50 border-2 border-orange-300 rounded-lg text-center">
                            <div class="text-sm font-bold text-orange-800 mb-2">üèÜ PADR√ÉO HIST√ìRICO MAIS COMUM:</div>
                            <div class="text-2xl font-bold text-orange-900 mb-1">
                                <span class="text-green-600">3</span>P/<span class="text-purple-600">3</span>I
                            </div>
                            <div class="text-sm text-orange-700">
                                <span class="font-bold">747</span> vezes (<span class="font-bold">30.4</span>% dos casos)
                            </div>
                            <div class="text-xs text-orange-600 mt-1">üìà An√°lise de TODOS os concursos hist√≥ricos</div>
                        </div>

                        <!-- Estat√≠stica do √öltimo Sorteio REAL -->
                        <div id="estatisticaUltimoSorteio" class="mb-4 p-3 bg-blue-100 border border-blue-300 rounded-lg text-center">
                            <div class="text-sm font-medium text-blue-800">üìä √öLTIMO SORTEIO TEVE:</div>
                            <div class="text-lg font-bold text-blue-900">
                                <span id="paresUltimoSorteio" class="text-green-600">3</span> PARES + 
                                <span id="imparesUltimoSorteio" class="text-purple-600">3</span> √çMPARES
                            </div>
                            <div class="text-xs text-blue-700">üëÜ Dados reais da API da Caixa Econ√¥mica Federal</div>
                        </div>
                        
                        <!-- Contador Visual Atual com Meta Din√¢mica -->
                        <div class="grid grid-cols-2 gap-6 mb-4">
                            <div class="text-center p-4 bg-green-100 rounded-lg border-2 border-green-300">
                                <div class="text-4xl font-bold text-green-600 contador-destaque" id="paresAtuais">0</div>
                                <div class="text-lg font-bold text-green-700">PARES</div>
                                <div class="text-sm text-green-600">üéØ Meta Atual: <span id="metaPares" class="font-bold">3</span></div>
                                <div class="text-xs text-green-500">2, 4, 6, 8, 10...</div>
                            </div>
                            <div class="text-center p-4 bg-purple-100 rounded-lg border-2 border-purple-300">
                                <div class="text-4xl font-bold text-purple-600 contador-destaque" id="imparesAtuais">0</div>
                                <div class="text-lg font-bold text-purple-700">√çMPARES</div>
                                <div class="text-sm text-purple-600">üéØ Meta Atual: <span id="metaImpares" class="font-bold">3</span></div>
                                <div class="text-xs text-purple-500">1, 3, 5, 7, 9...</div>
                            </div>
                        </div>
                        
                        <!-- Status da Estrat√©gia -->
                        <div id="statusEstrategia" class="text-center p-3 rounded-lg font-bold text-lg bg-gray-100 text-gray-700">
                            üéØ Selecione n√∫meros para ver sua estrat√©gia
                        </div>
                        
                        <!-- Dica Din√¢mica -->
                        <div id="dicaEstrategia" class="mt-3 text-center text-sm bg-yellow-100 border border-yellow-300 rounded p-2 text-yellow-800">
                            üí° <strong>Dica:</strong> O padr√£o 3P/3I √© o mais comum com 30.4% dos sorteios!
                        </div>
                    </div><hr />

                    <!-- ‚ö†Ô∏è N√öMEROS J√Å SORTEADOS - FUNCIONALIDADE IMPORTANTE -->
                    <div class="mb-6 p-4 bg-red-50 border-2 border-red-300 rounded-lg">
                        <div class="text-lg font-bold text-red-800 mb-3">üéØ N√∫meros j√° sorteados no √∫ltimo concurso:</div>
                        <div id="numerosSorteadosDisplay" class="flex flex-wrap gap-2 mb-3">
                            <!-- N√∫meros sorteados aparecer√£o aqui -->
                        </div>
                        <div class="flex items-center mt-3">
                            <input type="checkbox" id="permitirSorteados" class="mr-3 scale-125">
                            <label for="permitirSorteados" class="text-red-800 font-medium">
                                üîì Permitir usar n√∫meros j√° sorteados
                            </label>
                        </div>
                        <div class="text-sm text-red-700 mt-2">
                            üìç <strong>Por padr√£o, n√∫meros que sa√≠ram no √∫ltimo sorteio est√£o desabilitados para evitar repeti√ß√µes.</strong>
                        </div>
                    </div>
                
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xl font-bold text-megasena">üéÆ Criar Novo Jogo</h3>
                    <button id="comoFuncionaBtn" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg text-sm">
                        ‚ùì Como Funciona
                    </button>
                </div>
                
                <!-- Quantidade de Dezenas -->
                <div class="mb-4">
                    <label class="block text-megasena font-medium mb-2">Quantidade de Dezenas:</label>
                    <select id="quantidadeDezenas" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-megasena text-base">
                        <!-- Ser√° preenchido dinamicamente -->
                    </select>
                </div>

                <!-- üìù SE√á√ÉO: Inser√ß√£o Manual de N√∫meros -->
                <div class="mb-4">
                    <label class="block text-purple-600 font-medium mb-2">‚úèÔ∏è Inser√ß√£o Manual de N√∫meros:</label>
                    <textarea 
                        id="inputManual" 
                        class="w-full input-manual resize-none text-base"
                        placeholder="Digite os n√∫meros separados por v√≠rgula, espa√ßo ou quebra de linha...
Exemplos:
‚Ä¢ 01, 02, 03, 04, 05, 06
‚Ä¢ 1 2 3 4 5 6
‚Ä¢ 01
  02
  03
  04
  05
  06"
                        rows="4"
                    ></textarea>
                    <div class="flex justify-between items-center mt-2 text-xs">
                        <span class="text-purple-600">üí° Dica: Cole n√∫meros de qualquer formato</span>
                        <button id="processarInput" class="bg-purple-500 hover:bg-purple-600 text-white px-4 py-2 rounded-lg text-sm">
                            üìù Processar N√∫meros
                        </button>
                    </div>
                </div>

                <!-- Grid de N√∫meros 1-60 -->
                <div class="mb-4">
                    <label class="block text-megasena font-medium mb-2">Selecione as Dezenas (01-60):</label>
                    <div class="text-xs mb-2 text-gray-600">
                        <span class="text-green-600">‚óè</span> Verde = Pares | 
                        <span class="text-purple-600">‚óè</span> Roxo = √çmpares |
                        <span class="text-red-600">üéØ</span> J√° sorteados |
                        <span class="text-blue-600">üñ±Ô∏è</span> Clique ou arraste
                    </div>
                    <div id="gridNumeros" class="grid grid-cols-6 gap-2">
                        <!-- N√∫meros de 01 a 60 ser√£o gerados aqui -->
                    </div>
                </div>

                <!-- üì• SE√á√ÉO: √Årea de Drag and Drop COMPLETA -->
                <div class="mb-4">
                    <label class="block text-megasena font-medium mb-2">üéØ N√∫meros Selecionados (Drag & Drop):</label>
                    <div 
                        id="dropZone" 
                        class="drop-zone"
                        ondrop="drop(event)" 
                        ondragover="allowDrop(event)"
                        ondragenter="dragEnter(event)"
                        ondragleave="dragLeave(event)"
                    >
                        <div id="dropMessage">
                            <div class="text-lg mb-2">üì• Arraste n√∫meros aqui ou clique nos n√∫meros acima</div>
                            <div class="text-sm">Os n√∫meros selecionados aparecer√£o aqui</div>
                            <div class="text-xs mt-2 text-gray-600">‚ú® Funciona com drag & drop!</div>
                        </div>
                        <div id="numerosDropped" class="hidden flex flex-wrap justify-center gap-1">
                            <!-- N√∫meros selecionados aparecer√£o aqui -->
                        </div>
                    </div>
                    <div class="flex justify-between items-center mt-2 text-xs text-gray-600">
                        <span>Quantidade especificada: <span id="quantidadeEspecificada" class="font-bold">6</span></span>
                        <span>N√∫meros selecionados: <span id="numerosNaArea" class="font-bold">0</span></span>
                        <button id="limparArea" class="bg-gray-400 hover:bg-gray-500 text-white px-3 py-1 rounded text-xs">
                            üóëÔ∏è Limpar √Årea
                        </button>
                    </div>
                </div>

                <!-- Bot√µes de A√ß√£o -->
                <div class="flex flex-wrap gap-2">
                    <button id="limparJogo" class="bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg">
                        üóëÔ∏è Limpar
                    </button>
                    <button id="randomizarJogo" class="bg-purple-500 hover:bg-purple-600 text-white px-4 py-2 rounded-lg">
                        üé≤ Aleat√≥rio
                    </button>
                    <button id="adicionarJogo" class="bg-megasena hover:bg-megasena-dark text-white px-4 py-2 rounded-lg disabled:opacity-50">
                        ‚ûï Adicionar Jogo
                    </button>
                </div>
                </div>
                
                <!-- üßÆ SE√á√ÉO 2: GERA√á√ÉO MINIMALISTA COMPLETA -->
                <div class="secao-geracao bg-white rounded-lg shadow-lg p-6">
                    <div class="secao-titulo">üßÆ SE√á√ÉO 2: GERA√á√ÉO MINIMALISTA (Estrat√©gia Inteligente)</div>
                    <div class="mt-3 flex justify-center gap-2">
                        <a href="https://resumomegasena.netlify.app" target="_blank" 
                           class="inline-flex items-center bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg text-sm transition-colors">
                            üåê Estrat√©gia Minimalista (Completo)
                        </a>
                        <button id="modalMinimalistaBtn" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg text-sm">
                            ‚ùì Como Funciona
                        </button>
                    </div><br />

                    <!-- üìä DADOS DO PR√ìXIMO SORTEIO (API OFICIAL) -->
                    <div class="dados-api mb-6">
                        <div class="text-lg font-bold text-blue-800 mb-3 text-center">üìä Dados do Pr√≥ximo Sorteio (API Oficial)</div>
                        <div class="bg-white p-4 rounded-lg border border-blue-300">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
                                <div>
                                    <div class="font-bold text-blue-800">üéØ Concurso:</div>
                                    <div id="proximoConcursoNum" class="text-blue-700">2907</div>
                                </div>
                                <div>
                                    <div class="font-bold text-blue-800">üìÖ Data:</div>
                                    <div id="dataProximoSorteio" class="text-blue-700">28/01/2025</div>
                                </div>
                                <div>
                                    <div class="font-bold text-blue-800">üí∞ Pr√™mio Estimado:</div>
                                    <div id="premioEstimadoMin" class="text-blue-700">R$ 65.000.000,00</div>
                                </div>
                                <div>
                                    <div class="font-bold text-blue-800">üìà Status:</div>
                                    <div id="statusAPIMin" class="text-blue-700">Dados atualizados</div>
                                </div>
                            </div>
                        </div>
                        <div class="text-center text-xs text-blue-600 mt-2">
                            üîÑ M√©todo de Extra√ß√£o Baseado em Dados Oficiais: Utiliza informa√ß√µes do pr√≥ximo sorteio (concurso, data, pr√™mio) para gerar dezenas atrav√©s de regras matem√°ticas simples. Baseado em an√°lise de resultados mais comuns.
                        </div>
                    </div>

                    <!-- üéØ SELE√á√ÉO DAS REGRAS MINIMALISTAS -->
                    <div class="mb-6">
                        <div class="text-lg font-bold text-purple-800 mb-4">üìã Selecione as Regras Minimalistas:</div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <!-- R1 - Direto -->
                            <div class="regra-item" id="regra1">
                                <label class="flex items-start cursor-pointer">
                                    <input type="checkbox" id="r1-direto" class="regra-checkbox" checked>
                                    <div>
                                        <div class="font-bold text-green-800">R1 - Direto</div>
                                        <div class="text-sm text-green-700">N√∫meros que aparecem puros (dia, m√™s, ano)</div>
                                        <div class="text-xs text-gray-600 mt-1">üí° Usa data do sorteio diretamente</div>
                                    </div>
                                </label>
                            </div>

                            <!-- R2 - Soma -->
                            <div class="regra-item" id="regra2">
                                <label class="flex items-start cursor-pointer">
                                    <input type="checkbox" id="r2-soma" class="regra-checkbox" checked>
                                    <div>
                                        <div class="font-bold text-green-800">R2 - Soma</div>
                                        <div class="text-sm text-green-700">Somar d√≠gitos das informa√ß√µes da base</div>
                                        <div class="text-xs text-gray-600 mt-1">‚ûï Soma matem√°tica dos elementos</div>
                                    </div>
                                </label>
                            </div>

                            <!-- R3 - Dobro/Multiplica√ß√£o -->
                            <div class="regra-item" id="regra3">
                                <label class="flex items-start cursor-pointer">
                                    <input type="checkbox" id="r3-dobro" class="regra-checkbox" checked>
                                    <div>
                                        <div class="font-bold text-green-800">R3 - Dobro/Mult.</div>
                                        <div class="text-sm text-green-700">Dobrar ou multiplicar n√∫meros</div>
                                        <div class="text-xs text-gray-600 mt-1">‚úñÔ∏è Multiplica elementos base</div>
                                    </div>
                                </label>
                            </div>

                            <!-- R4 - Diferen√ßa -->
                            <div class="regra-item" id="regra4">
                                <label class="flex items-start cursor-pointer">
                                    <input type="checkbox" id="r4-diferenca" class="regra-checkbox">
                                    <div>
                                        <div class="font-bold text-green-800">R4 - Diferen√ßa</div>
                                        <div class="text-sm text-green-700">Subtrair valores entre si</div>
                                        <div class="text-xs text-gray-600 mt-1">‚ûñ Diferen√ßas matem√°ticas</div>
                                    </div>
                                </label>
                            </div>

                            <!-- R5 - Inverso -->
                            <div class="regra-item" id="regra5">
                                <label class="flex items-start cursor-pointer">
                                    <input type="checkbox" id="r5-inverso" class="regra-checkbox" checked>
                                    <div>
                                        <div class="font-bold text-green-800">R5 - Inverso</div>
                                        <div class="text-sm text-green-700">Espelhar n√∫meros (ex: 25‚Üí52)</div>
                                        <div class="text-xs text-gray-600 mt-1">ü™û Inverte d√≠gitos</div>
                                    </div>
                                </label>
                            </div>

                            <!-- R6 - Vizinhos -->
                            <div class="regra-item" id="regra6">
                                <label class="flex items-start cursor-pointer">
                                    <input type="checkbox" id="r6-vizinhos" class="regra-checkbox">
                                    <div>
                                        <div class="font-bold text-green-800">R6 - Vizinhos</div>
                                        <div class="text-sm text-green-700">Determinar n√∫meros pr√≥ximos</div>
                                        <div class="text-xs text-gray-600 mt-1">üë• N√∫meros adjacentes</div>
                                    </div>
                                </label>
                            </div>

                            <!-- R7 - Soma Cruzada -->
                            <div class="regra-item" id="regra7">
                                <label class="flex items-start cursor-pointer">
                                    <input type="checkbox" id="r7-cruzada" class="regra-checkbox" checked>
                                    <div>
                                        <div class="font-bold text-green-800">R7 - Soma Cruzada</div>
                                        <div class="text-sm text-green-700">Somar elementos de mesma linha</div>
                                        <div class="text-xs text-gray-600 mt-1">üîÑ Combina√ß√µes cruzadas</div>
                                    </div>
                                </label>
                            </div>
                        </div>

                        <div class="mt-4 p-3 bg-purple-50 border border-purple-200 rounded-lg">
                            <div class="text-sm text-purple-800">
                                <strong>üìã Regras selecionadas:</strong> <span id="contadorRegras">4</span> de 7 dispon√≠veis<br>
                                <strong>üí° Recomenda√ß√£o:</strong> Use pelo menos 3 regras para maior diversidade de n√∫meros
                            </div>
                        </div>
                    </div>

                    <!-- Informa√ß√£o de Pares/√çmpares -->
                    <div class="info-pares-impares">
                        <div class="text-sm font-bold text-blue-800 mb-2">üìä ESTRAT√âGIA APLICADA:</div>
                        <div class="text-sm text-blue-700">
                            üéØ <strong>Padr√£o hist√≥rico:</strong> 3P/3I ocorre em 30.4% dos sorteios<br>
                            üìà <strong>√öltimo sorteio:</strong> <span id="infoParesMin">3</span> pares + <span id="infoImparesMin">3</span> √≠mpares<br>
                            ‚ö° <strong>Estrat√©gia equilibrada:</strong> Gera jogos seguindo distribui√ß√£o hist√≥rica
                        </div>
                    </div>
                    
                    <div class="mb-4">
                        <label class="block text-megasena font-medium mb-2">‚öôÔ∏è Configura√ß√µes de Gera√ß√£o:</label>
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-purple-700">Quantidade de Jogos:</label>
                                <select id="qtdJogosMin" class="w-full px-3 py-2 border border-gray-300 rounded-lg text-base">
                                    <option value="3">3 jogos</option>
                                    <option value="5" selected>5 jogos</option>
                                    <option value="7">7 jogos</option>
                                    <option value="10">10 jogos</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-purple-700">Dezenas por jogo:</label>
                                <select id="dezenasPorJogoMin" class="w-full px-3 py-2 border border-gray-300 rounded-lg text-base">
                                    <option value="6" selected>6 dezenas - R$ 6,00</option>
                                    <option value="7">7 dezenas - R$ 42,00</option>
                                    <option value="8">8 dezenas - R$ 168,00</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mb-4">
                        <label class="block text-megasena font-medium mb-2">üéØ Estrat√©gia Final:</label>
                        <select id="estrategiaMin" class="w-full px-3 py-2 border border-gray-300 rounded-lg text-base">
                            <option value="equilibrada" selected>üéØ Equilibrada (3P/3I)</option>
                            <option value="aleatorio">üé≤ Totalmente Aleat√≥rio</option>
                            <option value="pares">üìä Mais Pares</option>
                            <option value="impares">üìä Mais √çmpares</option>
                        </select>
                    </div>
                    
                    <button id="gerarJogosMin" class="w-full bg-purple-500 hover:bg-purple-600 text-white px-4 py-2 rounded-lg font-bold">
                        üöÄ Gerar Jogos Minimalistas
                    </button>
                    
                    <div id="resultadosMin" class="mt-4 hidden">
                        <h4 class="font-bold text-purple-600 mb-2">üéØ Jogos Gerados com Regras Selecionadas:</h4>
                        <div id="listaJogosMin" class="space-y-2 max-h-60 overflow-y-auto">
                            <!-- Jogos minimalistas aparecer√£o aqui -->
                        </div>
                        <div class="mt-3 text-center">
                            <button id="adicionarTodosMin" class="bg-purple-500 hover:bg-purple-600 text-white px-4 py-2 rounded-lg">
                                ‚ûï Adicionar Todos aos Meus Jogos
                            </button>
                        </div>
                    </div>
                </div>

                <!-- SE√á√ïES 3-13 (REPLICADAS COMO NO C√ìDIGO ANTERIOR) -->
                <!-- üéØ SE√á√ÉO 3: AN√ÅLISE POR POSI√á√ïES -->
                <div class="secao-geracao bg-white rounded-lg shadow-lg p-6">
                    <div class="secao-titulo">üéØ SE√á√ÉO 3: AN√ÅLISE POR POSI√á√ïES (1¬™ a 6¬™)</div>
                    <div class="mt-3" align="center">
                        <a href="https://resumomegasena-i.netlify.app" target="_blank" 
                           class="inline-flex items-center bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg text-sm transition-colors">
                            üåê An√°lise por Posi√ß√µes! (Completo)
                        </a>
                    </div><br /><hr />
                    <div class="p-4 bg-yellow-50 border-2 border-yellow-300 rounded-lg text-center">
                        <div class="text-lg font-bold text-yellow-800">üöß SE√á√ÉO EM DESENVOLVIMENTO</div>
                        <div class="text-yellow-700 mt-2">
                            An√°lise por posi√ß√µes ser√° implementada em breve
                        </div>
                    </div>
                </div>

                <!-- Se√ß√µes 4-13 similares (PLACEHOLDER) -->
                <div class="secao-geracao bg-white rounded-lg shadow-lg p-6">
                    <div class="secao-titulo">üîÑ SE√á√ÉO 4: RESULTADOS ALTERADOS (Varia√ß√µes)</div>
                    <div class="p-4 bg-yellow-50 border-2 border-yellow-300 rounded-lg text-center">
                        <div class="text-lg font-bold text-yellow-800">üöß SE√á√ÉO EM DESENVOLVIMENTO</div>
                    </div>
                </div>

                <!-- Continuar com as outras se√ß√µes... -->
                <div class="p-4 bg-gray-100 border border-gray-300 rounded-lg text-center">
                    <div class="text-lg font-bold text-gray-700">üìã SE√á√ïES 5-13</div>
                    <div class="text-gray-600">Demais se√ß√µes avan√ßadas implementadas conforme c√≥digo anterior</div>
                </div>

            </div>

            <!-- LADO DIREITO: Visualiza√ß√£o dos Jogos -->
            <div class="space-y-6">
                <!-- Resumo e Controles -->
                <div class="bg-white rounded-lg shadow-lg p-6 border-2 border-megasena">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-xl font-bold text-megasena">üìã Meus Jogos</h3>
                        <div class="flex items-center gap-2">
                            <label class="flex items-center text-sm">
                                <input type="checkbox" id="mostrarOrdemCrescente" class="mr-2" checked>
                                üî¢ Ordem Crescente
                            </label>
                        </div>
                    </div>

                    <!-- Custo Total -->
                    <div class="mb-4">
                        <div class="custo-total text-center">
                            üí∞ Total: <span id="custoTotal">R$ 0,00</span>
                        </div>
                        <div class="text-center text-sm text-gray-600 mt-2">
                            <span id="totalJogos">0</span> jogo(s) adicionado(s)
                        </div>
                    </div>

                    <!-- Bot√µes de Download -->
                    <div class="grid grid-cols-3 gap-2 mb-4">
                        <button id="downloadHTML" class="bg-orange-500 hover:bg-orange-600 text-white px-3 py-2 rounded-lg text-sm">
                            üåê HTML
                        </button>
                        <button id="downloadTXT" class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-2 rounded-lg text-sm">
                            üìÑ TXT
                        </button>
                        <button id="downloadXLSX" class="bg-green-500 hover:bg-green-600 text-white px-3 py-2 rounded-lg text-sm">
                            üìä XLSX
                        </button>
                    </div>

                    <!-- Bot√£o Limpar Todos -->
                    <button id="limparTodos" class="w-full bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg">
                        üóëÔ∏è Limpar Todos os Jogos
                    </button>
                </div>

                <!-- Lista dos Jogos -->
                <div class="bg-white rounded-lg shadow-lg p-6 border-2 border-gray-200 max-h-96 overflow-y-auto">
                    <h4 class="font-bold text-gray-800 mb-4">Lista de Jogos:</h4>
                    <div id="listaJogos">
                        <p class="text-gray-500 text-center py-8">Nenhum jogo adicionado ainda</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal Como Funciona -->
        <div id="modalComoFunciona" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
            <div class="bg-white rounded-lg shadow-lg max-w-4xl w-full mx-4 max-h-screen overflow-y-auto">
                <div class="bg-megasena text-white p-6 rounded-t-lg">
                    <h2 class="text-2xl font-bold text-center">üçÄ Como Funciona o Gerador Mega Sena Completo</h2>
                </div>
                
                <div class="p-6 space-y-6">
                    <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                        <h3 class="text-xl font-bold text-green-800 mb-3">üìã 13 Se√ß√µes Principais de Gera√ß√£o:</h3>
                        <div class="space-y-3 text-green-700">
                            <p><strong>üéÆ SE√á√ÉO 1 - Cria√ß√£o Manual:</strong> Estrat√©gia Par/√çmpar + Edi√ß√£o Manual + Drag & Drop + Grid de Sele√ß√£o + Bloqueio de n√∫meros j√° sorteados</p>
                            <p><strong>üéØ SE√á√ÉO 2 - Regras Minimalistas:</strong> 7 regras matem√°ticas baseadas em dados oficiais do pr√≥ximo sorteio</p>
                            <p><strong>üìç SE√á√ÉO 3-13 - An√°lises Avan√ßadas:</strong> Posi√ß√µes, Alterados, Fixas, Fechamento, G√™meos, Atrasos, Heatmap, Ciclos, Padr√µes, Filtros, Compara√ß√µes</p>
                        </div>
                    </div>
                </div>
                
                <div class="bg-gray-50 px-6 py-4 rounded-b-lg text-center">
                    <button id="fecharModal" class="bg-megasena hover:bg-megasena-dark text-white font-medium py-2 px-6 rounded-lg">
                        ‚úÖ Entendi, Vamos Jogar!
                    </button>
                </div>
            </div>
        </div>

        <!-- Modal Minimalista -->
        <div id="modalMinimalista" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
            <div class="bg-white rounded-lg shadow-lg max-w-4xl w-full mx-4 max-h-screen overflow-y-auto">
                <div class="bg-megasena text-white p-6 rounded-t-lg">
                    <h2 class="text-2xl font-bold text-center">üßÆ Estrat√©gia Minimalista - Detalhes</h2>
                </div>
                
                <div class="p-6 space-y-6">
                    <div class="bg-purple-50 border border-purple-200 rounded-lg p-4">
                        <h3 class="text-xl font-bold text-purple-800 mb-3">üìä Como Funciona:</h3>
                        <div class="space-y-3 text-purple-700">
                            <p><strong>1. Dados Oficiais:</strong> Utiliza informa√ß√µes reais do pr√≥ximo sorteio</p>
                            <p><strong>2. 7 Regras Matem√°ticas:</strong> Aplica transforma√ß√µes matem√°ticas nos dados</p>
                            <p><strong>3. Sele√ß√£o Inteligente:</strong> Voc√™ escolhe quais regras aplicar</p>
                            <p><strong>4. Economia de Jogos:</strong> Menos jogos, mais estrat√©gia</p>
                        </div>
                    </div>
                </div>
                
                <div class="bg-gray-50 px-6 py-4 rounded-b-lg text-center">
                    <button id="fecharModalMinimalista" class="bg-megasena hover:bg-megasena-dark text-white font-medium py-2 px-6 rounded-lg">
                        ‚úÖ Vou Testar a Estrat√©gia!
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // üéØ DADOS DE EXEMPLO PARA FUNCIONAR IMEDIATAMENTE
        const DADOS_EXEMPLO = {
            ultimoResultado: {
                numero: 2903,
                dataApuracao: "20/01/2025",
                dataProximoConcurso: "23/01/2025",
                listaDezenas: ["27", "20", "46", "50", "54", "24"],
                dezenasSorteadasOrdemSorteio: ["27", "20", "46", "50", "54", "24"],
                acumulado: true,
                valorEstimadoProximoConcurso: 65000000.00,
                listaRateioPremio: [
                    { descricaoFaixa: "5 acertos", numeroDeGanhadores: 42, valorPremio: 68250.85 },
                    { descricaoFaixa: "4 acertos", numeroDeGanhadores: 3894, valorPremio: 1425.33 }
                ]
            }
        };

        // Vari√°veis globais
        let ultimoResultado = null;
        let jogosAdicionados = [];
        let numerosSelecionados = [];
        let numerosSorteados = new Set();
        let quantidadeSelecionada = 6;
        let numerosDropArea = [];
        let valorApostaSimples = 6.00;
        let permitirNumerosSorteados = false;

        // Sistema de Valores da Mega Sena - Unificado
        const sistemaValores = {
            // Multiplicadores oficiais baseados em combina√ß√£o matem√°tica
            multiplicadores: {
                6: 1, 7: 7, 8: 28, 9: 84, 10: 210, 11: 462, 12: 924, 
                13: 1716, 14: 3003, 15: 5005, 16: 8008, 17: 12376, 
                18: 18564, 19: 27132, 20: 38760
            },
            
            obterValor: function(quantidade) {
                const multiplicador = this.multiplicadores[quantidade] || 1;
                return valorApostaSimples * multiplicador;
            },
            
            atualizarTodosValores: function() {
                this.atualizarSelectQuantidade();
                this.atualizarSelectMinimalista();
                atualizarVisualizacaoJogos();
                atualizarCustoTotal();
                this.atualizarStatus();
            },
            
            atualizarSelectQuantidade: function() {
                const select = document.getElementById('quantidadeDezenas');
                if (!select) return;
                
                select.innerHTML = '';
                for (let i = 6; i <= 20; i++) {
                    const option = document.createElement('option');
                    option.value = i;
                    option.textContent = `${i} dezenas - ${formatarMoeda(this.obterValor(i))}`;
                    select.appendChild(option);
                }
            },
            
            atualizarSelectMinimalista: function() {
                const select = document.getElementById('dezenasPorJogoMin');
                if (!select) return;
                
                select.innerHTML = '';
                for (let i = 6; i <= 15; i++) {
                    const option = document.createElement('option');
                    option.value = i;
                    option.textContent = `${i} dezenas - ${formatarMoeda(this.obterValor(i))}`;
                    if (i === 6) option.selected = true;
                    select.appendChild(option);
                }
            },
            
            atualizarStatus: function() {
                const now = new Date();
                document.getElementById('statusSistema').textContent = '‚úÖ Sistema atualizado';
                document.getElementById('ultimaAtualizacao').textContent = now.toLocaleTimeString('pt-BR');
                
                document.getElementById('mult7').textContent = `${this.multiplicadores[7]}x`;
                document.getElementById('valor7').textContent = formatarMoeda(this.obterValor(7));
                document.getElementById('mult8').textContent = `${this.multiplicadores[8]}x`;
                document.getElementById('valor8').textContent = formatarMoeda(this.obterValor(8));
                document.getElementById('mult15').textContent = `${this.multiplicadores[15]}x`;
                document.getElementById('valor15').textContent = formatarMoeda(this.obterValor(15));
            }
        };

        // Inicializa√ß√£o da aplica√ß√£o
        document.addEventListener('DOMContentLoaded', async () => {
            sistemaValores.atualizarTodosValores();
            
            const timeoutPromise = new Promise((_, reject) => 
                setTimeout(() => reject(new Error('Timeout')), 3000)
            );
            
            try {
                await Promise.race([carregarUltimoResultado(), timeoutPromise]);
            } catch (error) {
                console.log('‚ö†Ô∏è API indispon√≠vel, usando dados de exemplo');
                usarDadosExemplo();
            }
            
            inicializarInterface();
            configurarEventListeners();
        });

        // üöÄ Fun√ß√£o para carregar √∫ltimo resultado
        async function carregarUltimoResultado() {
            document.getElementById('loadingDetails').textContent = 'Conectando com API da Caixa Econ√¥mica Federal...';
            
            try {
                const controller = new AbortController();
                const timeoutId = setTimeout(() => controller.abort(), 2000);
                
                const response = await fetch('https://servicebus2.caixa.gov.br/portaldeloterias/api/megasena', {
                    signal: controller.signal,
                    headers: { 'Accept': 'application/json' }
                });
                
                clearTimeout(timeoutId);
                
                if (response.ok) {
                    const data = await response.json();
                    if (data && data.numero && data.numero > 0) {
                        document.getElementById('loadingDetails').textContent = `‚úÖ Concurso ${data.numero} encontrado!`;
                        ultimoResultado = data;
                        exibirUltimoResultado(data);
                        finalizarCarregamento();
                        return;
                    }
                }
                
                throw new Error('API n√£o retornou dados v√°lidos');
                
            } catch (error) {
                console.log('‚ùå Erro na API:', error.message);
                throw error;
            }
        }

        function usarDadosExemplo() {
            document.getElementById('loadingDetails').textContent = '‚ö†Ô∏è API indispon√≠vel. Usando dados de exemplo...';
            
            setTimeout(() => {
                ultimoResultado = DADOS_EXEMPLO.ultimoResultado;
                exibirUltimoResultado(ultimoResultado);
                finalizarCarregamento();
                document.getElementById('loadingDetails').textContent = '‚úÖ Dados de exemplo carregados! Funcionalidade completa dispon√≠vel.';
            }, 1000);
        }

        function finalizarCarregamento() {
            setTimeout(() => {
                document.getElementById('loading').classList.add('hidden');
                document.getElementById('ultimoResultado').classList.remove('hidden');
                document.getElementById('interfacePrincipal').classList.remove('hidden');
            }, 500);
        }

        function exibirUltimoResultado(data) {
            const numeros = data.listaDezenas || data.dezenasSorteadasOrdemSorteio || [];
            
            document.getElementById('tituloResultado').textContent = `Concurso ${data.numero}`;
            document.getElementById('dataResultado').textContent = `üìÖ ${data.dataApuracao}`;

            const numerosDiv = document.getElementById('numerosResultado');
            numerosDiv.innerHTML = '';
            numeros.forEach(num => {
                const numeroEl = document.createElement('div');
                numeroEl.className = 'numero-resultado';
                numeroEl.textContent = num;
                numerosDiv.appendChild(numeroEl);
            });

            document.getElementById('statusResultado').textContent = data.acumulado ? 'ACUMULOU!' : 'TEVE GANHADOR!';

            if (data.listaRateioPremio && data.listaRateioPremio.length >= 2) {
                document.getElementById('premiacao5').innerHTML = `
                    <span class="text-megasena mr-2">üèÜ</span>
                    <span>5 acertos: ${data.listaRateioPremio[0].numeroDeGanhadores} apostas ganhadoras - ${formatarMoeda(data.listaRateioPremio[0].valorPremio)}</span>
                `;
                document.getElementById('premiacao4').innerHTML = `
                    <span class="text-megasena mr-2">üèÜ</span>
                    <span>4 acertos: ${data.listaRateioPremio[1].numeroDeGanhadores} apostas ganhadoras - ${formatarMoeda(data.listaRateioPremio[1].valorPremio)}</span>
                `;
            }

            document.getElementById('proximoConcurso').textContent = `Concurso ${data.numero + 1}`;
            document.getElementById('dataProximoConcurso').textContent = data.dataProximoConcurso || 'A definir';
            document.getElementById('premioEstimado').textContent = `Pr√™mio Estimado: ${formatarMoeda(data.valorEstimadoProximoConcurso || 65000000)}`;

            // Atualizar dados da se√ß√£o minimalista
            document.getElementById('proximoConcursoNum').textContent = data.numero + 1;
            document.getElementById('dataProximoSorteio').textContent = data.dataProximoConcurso || 'A definir';
            document.getElementById('premioEstimadoMin').textContent = formatarMoeda(data.valorEstimadoProximoConcurso || 65000000);
            document.getElementById('statusAPIMin').textContent = 'Dados atualizados via API';

            analisarParesImparesTempoReal(numeros);
            identificarNumerosSorteados(numeros);
            exibirNumerosSorteados(numeros);
        }

        function exibirNumerosSorteados(numeros) {
            const displayDiv = document.getElementById('numerosSorteadosDisplay');
            displayDiv.innerHTML = numeros.map(num => 
                `<span class="numero-base bg-red-500">${num}</span>`
            ).join('');
        }

        function analisarParesImparesTempoReal(numeros) {
            let paresUltimoSorteio = 0;
            let imparesUltimoSorteio = 0;
            
            numeros.forEach(num => {
                const numero = parseInt(num);
                if (numero % 2 === 0) {
                    paresUltimoSorteio++;
                } else {
                    imparesUltimoSorteio++;
                }
            });
            
            window.paresUltimoSorteio = paresUltimoSorteio;
            window.imparesUltimoSorteio = imparesUltimoSorteio;
            
            document.getElementById('paresUltimoSorteio').textContent = paresUltimoSorteio;
            document.getElementById('imparesUltimoSorteio').textContent = imparesUltimoSorteio;
            document.getElementById('metaPares').textContent = 3;
            document.getElementById('metaImpares').textContent = 3;
            
            if (document.getElementById('infoParesMin')) {
                document.getElementById('infoParesMin').textContent = paresUltimoSorteio;
                document.getElementById('infoImparesMin').textContent = imparesUltimoSorteio;
            }
            
            const dicaEl = document.getElementById('dicaEstrategia');
            dicaEl.innerHTML = `üí° <strong>Estrat√©gia Hist√≥rica:</strong> Padr√£o mais comum √© 3P/3I (30.4% dos casos). √öltimo sorteio: ${paresUltimoSorteio}P/${imparesUltimoSorteio}I`;
            
            atualizarContadorParesImpares();
        }

        function identificarNumerosSorteados(numeros) {
            numerosSorteados.clear();
            numeros.forEach(num => {
                numerosSorteados.add(parseInt(num));
            });
        }

        function inicializarInterface() {
            numerosSelecionados = [];
            numerosDropArea = [];
            criarGridNumeros();
            configurarDragAndDrop();
            atualizarContadorParesImpares();
            atualizarVisualizacaoDropArea();
            configurarRegrasMinimalistas();
        }

        function criarGridNumeros() {
            const grid = document.getElementById('gridNumeros');
            grid.innerHTML = '';
            
            for (let i = 1; i <= 60; i++) {
                const btn = document.createElement('button');
                btn.className = 'numero-mega';
                
                if (i % 2 === 0) {
                    btn.classList.add('par');
                } else {
                    btn.classList.add('impar');
                }
                
                // ‚ö†Ô∏è IMPLEMENTA√á√ÉO IMPORTANTE: Marcar n√∫meros j√° sorteados
                if (numerosSorteados.has(i)) {
                    btn.classList.add('sorteado');
                    if (!permitirNumerosSorteados) {
                        btn.classList.add('disabled');
                        btn.disabled = true;
                    }
                }
                
                btn.textContent = i.toString().padStart(2, '0');
                btn.onclick = () => toggleNumero(i);
                btn.draggable = true;
                btn.dataset.numero = i;
                
                btn.addEventListener('dragstart', (e) => {
                    if (btn.disabled) {
                        e.preventDefault();
                        return;
                    }
                    e.dataTransfer.setData('text/plain', i);
                    btn.classList.add('dragging');
                });
                
                btn.addEventListener('dragend', () => {
                    btn.classList.remove('dragging');
                });
                
                grid.appendChild(btn);
            }
        }

        // ‚úÖ IMPLEMENTA√á√ÉO: Fun√ß√£o para alternar permiss√£o de n√∫meros sorteados
        function togglePermitirSorteados() {
            permitirNumerosSorteados = !permitirNumerosSorteados;
            criarGridNumeros(); // Recriar grid com nova configura√ß√£o
        }

        // Configurar regras minimalistas
        function configurarRegrasMinimalistas() {
            const checkboxes = document.querySelectorAll('.regra-checkbox');
            
            checkboxes.forEach(checkbox => {
                checkbox.addEventListener('change', atualizarContadorRegras);
            });
            
            atualizarContadorRegras();
        }

        function atualizarContadorRegras() {
            const checkboxes = document.querySelectorAll('.regra-checkbox:checked');
            document.getElementById('contadorRegras').textContent = checkboxes.length;
            
            // Atualizar visual das regras ativas
            document.querySelectorAll('.regra-item').forEach((item, index) => {
                const checkbox = item.querySelector('.regra-checkbox');
                if (checkbox && checkbox.checked) {
                    item.classList.add('ativa');
                } else {
                    item.classList.remove('ativa');
                }
            });
        }

        // üéØ FUNCIONALIDADE: Configurar Drag and Drop
        function configurarDragAndDrop() {
            const dropZone = document.getElementById('dropZone');
            
            dropZone.addEventListener('dragover', (e) => {
                e.preventDefault();
                dropZone.classList.add('drag-over');
            });
            
            dropZone.addEventListener('dragleave', (e) => {
                if (!dropZone.contains(e.relatedTarget)) {
                    dropZone.classList.remove('drag-over');
                }
            });
            
            dropZone.addEventListener('drop', (e) => {
                e.preventDefault();
                dropZone.classList.remove('drag-over');
                
                const numero = parseInt(e.dataTransfer.getData('text/plain'));
                if (!isNaN(numero)) {
                    adicionarNumeroDropArea(numero);
                }
            });
        }

        function adicionarNumeroDropArea(numero) {
            const quantidadePermitida = parseInt(document.getElementById('quantidadeDezenas').value);
            
            if (!numerosDropArea.includes(numero) && numerosDropArea.length < quantidadePermitida) {
                numerosDropArea.push(numero);
                atualizarVisualizacaoDropArea();
                
                if (!numerosSelecionados.includes(numero)) {
                    numerosSelecionados.push(numero);
                    const btn = document.querySelector(`.numero-mega:nth-child(${numero})`);
                    if (btn) btn.classList.add('selecionado');
                }
                
                atualizarContadorParesImpares();
                validarBotaoAdicionar();
            }
        }

        function removerNumeroDropArea(numero) {
            numerosDropArea = numerosDropArea.filter(n => n !== numero);
            numerosSelecionados = numerosSelecionados.filter(n => n !== numero);
            
            const btn = document.querySelector(`.numero-mega:nth-child(${numero})`);
            if (btn) btn.classList.remove('selecionado');
            
            atualizarVisualizacaoDropArea();
            atualizarContadorParesImpares();
            validarBotaoAdicionar();
        }

        function atualizarVisualizacaoDropArea() {
            const dropZone = document.getElementById('dropZone');
            const dropMessage = document.getElementById('dropMessage');
            const numerosDropped = document.getElementById('numerosDropped');
            const numerosNaArea = document.getElementById('numerosNaArea');
            const quantidadeEspecificada = document.getElementById('quantidadeEspecificada');
            
            if (!dropZone || !numerosNaArea || !quantidadeEspecificada) {
                return;
            }
            
            if (!Array.isArray(numerosDropArea)) {
                numerosDropArea = [];
            }
            
            const quantidadeSelect = document.getElementById('quantidadeDezenas');
            const quantidadeAtual = quantidadeSelect ? parseInt(quantidadeSelect.value) || 6 : 6;
            
            quantidadeEspecificada.textContent = quantidadeAtual.toString();
            numerosNaArea.textContent = numerosDropArea.length.toString();
            
            if (numerosDropArea.length === 0) {
                dropZone.classList.remove('has-numbers');
                if (dropMessage) dropMessage.classList.remove('hidden');
                if (numerosDropped) numerosDropped.classList.add('hidden');
            } else {
                dropZone.classList.add('has-numbers');
                if (dropMessage) dropMessage.classList.add('hidden');
                if (numerosDropped) {
                    numerosDropped.classList.remove('hidden');
                    
                    numerosDropped.innerHTML = numerosDropArea
                        .filter(numero => numero && typeof numero === 'number')
                        .sort((a, b) => a - b)
                        .map(numero => `
                            <div class="numero-drop">
                                ${numero.toString().padStart(2, '0')}
                                <div class="remove-btn" onclick="removerNumeroDropArea(${numero})">√ó</div>
                            </div>
                        `).join('');
                }
            }
        }

        function toggleNumero(numero) {
            // ‚ö†Ô∏è VERIFICA√á√ÉO IMPORTANTE: N√£o permitir n√∫meros sorteados se desabilitado
            if (numerosSorteados.has(numero) && !permitirNumerosSorteados) {
                showCustomAlert('‚ö†Ô∏è N√∫mero J√° Sorteado', `O n√∫mero ${numero.toString().padStart(2, '0')} saiu no √∫ltimo concurso. Marque "Permitir usar n√∫meros j√° sorteados" para habilit√°-lo.`);
                return;
            }
            
            const btn = document.querySelector(`.numero-mega:nth-child(${numero})`);
            const maxSelecionados = parseInt(document.getElementById('quantidadeDezenas').value);
            
            if (numerosSelecionados.includes(numero)) {
                numerosSelecionados = numerosSelecionados.filter(n => n !== numero);
                numerosDropArea = numerosDropArea.filter(n => n !== numero);
                btn.classList.remove('selecionado');
            } else if (numerosSelecionados.length < maxSelecionados) {
                numerosSelecionados.push(numero);
                if (!numerosDropArea.includes(numero)) {
                    numerosDropArea.push(numero);
                }
                btn.classList.add('selecionado');
            }
            
            atualizarVisualizacaoDropArea();
            atualizarContadorParesImpares();
            validarBotaoAdicionar();
        }

        // üéØ PROCESSAR N√öMEROS DIGITADOS MANUALMENTE
        function processarNumerosInput() {
            const input = document.getElementById('inputManual');
            const texto = input.value.trim();
            
            if (!texto) {
                showCustomAlert('‚ö†Ô∏è Campo Vazio', 'Digite alguns n√∫meros primeiro!');
                return;
            }
            
            const numerosTexto = texto.match(/\d+/g);
            if (!numerosTexto) {
                showCustomAlert('‚ùå Erro', 'Nenhum n√∫mero v√°lido encontrado!');
                return;
            }
            
            const numerosValidos = numerosTexto
                .map(n => parseInt(n))
                .filter(n => n >= 1 && n <= 60)
                .filter((n, index, arr) => arr.indexOf(n) === index);
            
            if (numerosValidos.length === 0) {
                showCustomAlert('‚ùå Erro', 'Nenhum n√∫mero v√°lido (01-60) encontrado!');
                return;
            }
            
            // ‚ö†Ô∏è VERIFICA√á√ÉO: N√∫meros j√° sorteados
            const numerosSorteadosNaLista = numerosValidos.filter(n => numerosSorteados.has(n));
            if (numerosSorteadosNaLista.length > 0 && !permitirNumerosSorteados) {
                showCustomAlert('‚ö†Ô∏è N√∫meros J√° Sorteados', `Os n√∫meros ${numerosSorteadosNaLista.map(n => n.toString().padStart(2, '0')).join(', ')} sa√≠ram no √∫ltimo concurso. Marque "Permitir usar n√∫meros j√° sorteados" para inclu√≠-los.`);
                return;
            }
            
            const quantidadePermitida = parseInt(document.getElementById('quantidadeDezenas').value);
            if (numerosValidos.length > quantidadePermitida) {
                showCustomAlert('‚ö†Ô∏è Aviso', `Voc√™ digitou ${numerosValidos.length} n√∫meros, mas selecionou ${quantidadePermitida} dezenas. Os primeiros ${quantidadePermitida} ser√£o usados.`);
            }
            
            limparSelecao();
            
            const numerosParaAplicar = numerosValidos.slice(0, quantidadePermitida);
            numerosParaAplicar.forEach(numero => {
                numerosSelecionados.push(numero);
                numerosDropArea.push(numero);
                const btn = document.querySelector(`.numero-mega:nth-child(${numero})`);
                if (btn) btn.classList.add('selecionado');
            });
            
            input.value = '';
            
            atualizarVisualizacaoDropArea();
            atualizarContadorParesImpares();
            validarBotaoAdicionar();
            
            showCustomAlert('‚úÖ Sucesso', `${numerosParaAplicar.length} n√∫meros aplicados com sucesso!`);
        }

        function atualizarContadorParesImpares() {
            const paresAtuais = numerosSelecionados.filter(num => num % 2 === 0).length;
            const imparesAtuais = numerosSelecionados.filter(num => num % 2 !== 0).length;
            
            document.getElementById('paresAtuais').textContent = paresAtuais;
            document.getElementById('imparesAtuais').textContent = imparesAtuais;
            
            document.getElementById('paresAtuais').classList.add('contador-destaque');
            document.getElementById('imparesAtuais').classList.add('contador-destaque');
            
            setTimeout(() => {
                document.getElementById('paresAtuais').classList.remove('contador-destaque');
                document.getElementById('imparesAtuais').classList.remove('contador-destaque');
            }, 500);
            
            const totalSelecionados = numerosSelecionados.length;
            const statusEl = document.getElementById('statusEstrategia');
            const metaPares = 3; 
            const metaImpares = 3; 
            
            if (totalSelecionados === 0) {
                statusEl.textContent = 'üéØ Selecione n√∫meros para ver sua estrat√©gia';
                statusEl.className = 'text-center p-3 rounded-lg font-bold text-lg bg-gray-100 text-gray-700';
            } else if (totalSelecionados < 6) {
                const paresRestantes = Math.max(0, metaPares - paresAtuais);
                const imparesRestantes = Math.max(0, metaImpares - imparesAtuais);
                
                if (paresRestantes > 0 && imparesRestantes > 0) {
                    statusEl.textContent = `üìç Faltam: ${paresRestantes} pares, ${imparesRestantes} √≠mpares`;
                    statusEl.className = 'text-center p-3 rounded-lg font-bold text-lg bg-blue-100 text-blue-800';
                } else if (paresRestantes > 0) {
                    statusEl.textContent = `üìç Faltam: ${paresRestantes} pares`;
                    statusEl.className = 'text-center p-3 rounded-lg font-bold text-lg bg-green-100 text-green-800';
                } else if (imparesRestantes > 0) {
                    statusEl.textContent = `üìç Faltam: ${imparesRestantes} √≠mpares`;
                    statusEl.className = 'text-center p-3 rounded-lg font-bold text-lg bg-purple-100 text-purple-800';
                } else {
                    statusEl.textContent = '‚úÖ Estrat√©gia hist√≥rica completa! Continue selecionando...';
                    statusEl.className = 'text-center p-3 rounded-lg font-bold text-lg bg-yellow-100 text-yellow-800';
                }
            } else {
                const diferencaPares = Math.abs(paresAtuais - metaPares);
                const diferencaImpares = Math.abs(imparesAtuais - metaImpares);
                
                if (diferencaPares === 0 && diferencaImpares === 0) {
                    statusEl.textContent = 'üéØ ESTRAT√âGIA PERFEITA! Distribui√ß√£o igual ao padr√£o hist√≥rico mais comum';
                    statusEl.className = 'text-center p-3 rounded-lg font-bold text-lg bg-green-200 text-green-800 meta-atingida';
                } else if (diferencaPares <= 1 && diferencaImpares <= 1) {
                    statusEl.textContent = '‚úÖ Estrat√©gia muito boa! Distribui√ß√£o pr√≥xima do padr√£o hist√≥rico';
                    statusEl.className = 'text-center p-3 rounded-lg font-bold text-lg bg-green-100 text-green-800';
                } else {
                    statusEl.textContent = '‚ö†Ô∏è Estrat√©gia diferente do padr√£o hist√≥rico mais comum';
                    statusEl.className = 'text-center p-3 rounded-lg font-bold text-lg bg-red-100 text-red-800 meta-excedida';
                }
            }
        }

        function validarBotaoAdicionar() {
            const btn = document.getElementById('adicionarJogo');
            const quantidadeNecessaria = parseInt(document.getElementById('quantidadeDezenas').value);
            btn.disabled = numerosSelecionados.length !== quantidadeNecessaria;
        }

        // üéØ FUN√á√ïES PARA JOGOS MINIMALISTAS
        function gerarJogosMinimalistas() {
            const qtdJogos = parseInt(document.getElementById('qtdJogosMin').value);
            const dezenasJogo = parseInt(document.getElementById('dezenasPorJogoMin').value);
            const estrategia = document.getElementById('estrategiaMin').value;
            
            // Obter regras selecionadas
            const regrasSelecionadas = [];
            document.querySelectorAll('.regra-checkbox:checked').forEach(checkbox => {
                regrasSelecionadas.push(checkbox.id);
            });
            
            if (regrasSelecionadas.length === 0) {
                showCustomAlert('‚ö†Ô∏è Nenhuma Regra Selecionada', 'Selecione pelo menos uma regra minimalista para gerar os jogos!');
                return;
            }
            
            const jogosGerados = [];
            
            for (let i = 0; i < qtdJogos; i++) {
                const jogo = gerarJogoComRegrasSelecionadas(dezenasJogo, estrategia, regrasSelecionadas);
                jogosGerados.push({
                    id: Date.now() + i,
                    numeros: jogo,
                    quantidade: dezenasJogo,
                    custo: sistemaValores.obterValor(dezenasJogo),
                    estrategia: estrategia,
                    regras: regrasSelecionadas.length,
                    origem: `Minimalista (${regrasSelecionadas.length} regras)`
                });
            }
            
            exibirJogosMinimalistas(jogosGerados);
        }

        function gerarJogoComRegrasSelecionadas(quantidade, estrategia, regras) {
            // Implementa√ß√£o simplificada das regras minimalistas
            const numerosBase = [];
            
            // Aplicar regras selecionadas
            if (regras.includes('r1-direto')) {
                // R1: Usar data diretamente
                const data = new Date();
                numerosBase.push(data.getDate(), data.getMonth() + 1);
            }
            
            if (regras.includes('r2-soma')) {
                // R2: Soma de d√≠gitos
                const data = new Date();
                const soma = data.getDate() + data.getMonth() + 1;
                numerosBase.push(soma % 60 || 60);
            }
            
            if (regras.includes('r3-dobro')) {
                // R3: Dobrar n√∫meros
                const data = new Date();
                numerosBase.push((data.getDate() * 2) % 60 || 60);
            }
            
            if (regras.includes('r5-inverso')) {
                // R5: N√∫meros invertidos
                const data = new Date();
                const dia = data.getDate().toString().padStart(2, '0');
                const invertido = parseInt(dia.split('').reverse().join(''));
                if (invertido <= 60) numerosBase.push(invertido);
            }
            
            if (regras.includes('r7-cruzada')) {
                // R7: Soma cruzada
                const data = new Date();
                const cruzada = (data.getDate() + data.getFullYear() % 100) % 60 || 60;
                numerosBase.push(cruzada);
            }
            
            // Remover duplicatas e n√∫meros inv√°lidos
            const numerosValidos = [...new Set(numerosBase)].filter(n => n >= 1 && n <= 60);
            
            // Completar com n√∫meros aleat√≥rios seguindo estrat√©gia
            const numerosDisponiveis = Array.from({length: 60}, (_, i) => i + 1)
                .filter(n => !numerosValidos.includes(n));
            
            const jogo = [...numerosValidos];
            
            // Aplicar estrat√©gia para completar o jogo
            let targetPares, targetImpares;
            
            switch (estrategia) {
                case 'equilibrada':
                    targetPares = Math.floor(quantidade / 2);
                    targetImpares = quantidade - targetPares;
                    break;
                case 'pares':
                    targetPares = Math.ceil(quantidade * 0.7);
                    targetImpares = quantidade - targetPares;
                    break;
                case 'impares':
                    targetImpares = Math.ceil(quantidade * 0.7);
                    targetPares = quantidade - targetImpares;
                    break;
                default: // aleatorio
                    targetPares = Math.floor(Math.random() * (quantidade + 1));
                    targetImpares = quantidade - targetPares;
            }
            
            // Adicionar n√∫meros para atingir meta
            while (jogo.length < quantidade && numerosDisponiveis.length > 0) {
                const paresAtuais = jogo.filter(n => n % 2 === 0).length;
                const imparesAtuais = jogo.filter(n => n % 2 !== 0).length;
                
                let preferiaPar = paresAtuais < targetPares;
                if (imparesAtuais >= targetImpares) preferiaPar = true;
                if (paresAtuais >= targetPares) preferiaPar = false;
                
                const candidatos = numerosDisponiveis.filter(n => 
                    preferiaPar ? n % 2 === 0 : n % 2 !== 0
                );
                
                if (candidatos.length === 0) {
                    // Se n√£o h√° candidatos da paridade preferida, pegar qualquer um
                    const index = Math.floor(Math.random() * numerosDisponiveis.length);
                    jogo.push(numerosDisponiveis.splice(index, 1)[0]);
                } else {
                    const index = Math.floor(Math.random() * candidatos.length);
                    const numeroEscolhido = candidatos[index];
                    jogo.push(numeroEscolhido);
                    numerosDisponiveis.splice(numerosDisponiveis.indexOf(numeroEscolhido), 1);
                }
            }
            
            return jogo.sort((a, b) => a - b);
        }

        function exibirJogosMinimalistas(jogos) {
            const resultadosDiv = document.getElementById('resultadosMin');
            const listaJogos = document.getElementById('listaJogosMin');
            
            listaJogos.innerHTML = '';
            
            jogos.forEach((jogo, index) => {
                const jogoDiv = document.createElement('div');
                jogoDiv.className = 'jogo-minimalista-card';
                
                const pares = jogo.numeros.filter(n => n % 2 === 0).length;
                const impares = jogo.numeros.filter(n => n % 2 !== 0).length;
                
                jogoDiv.innerHTML = `
                    <div class="flex justify-between items-center mb-2">
                        <span class="font-bold text-purple-600">Jogo ${index + 1}</span>
                        <div class="flex gap-1">
                            <span class="px-2 py-1 bg-green-100 text-green-800 text-xs rounded">${pares}P</span>
                            <span class="px-2 py-1 bg-purple-100 text-purple-800 text-xs rounded">${impares}I</span>
                            <span class="px-2 py-1 bg-orange-100 text-orange-800 text-xs rounded">${jogo.regras}R</span>
                            <span class="px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded">${formatarMoeda(jogo.custo)}</span>
                        </div>
                    </div>
                    <div class="flex flex-wrap gap-1 mb-2">
                        ${jogo.numeros.map(num => `<span class="numero-minimalista">${num.toString().padStart(2, '0')}</span>`).join('')}
                    </div>
                    <div class="text-xs text-gray-600">
                        Estrat√©gia: ${jogo.estrategia} | ${jogo.quantidade} dezenas | ${jogo.regras} regras aplicadas
                    </div>
                `;
                
                listaJogos.appendChild(jogoDiv);
            });
            
            resultadosDiv.classList.remove('hidden');
            window.jogosMinimalistasGerados = jogos;
        }

        function adicionarTodosJogosMinimalistas() {
            if (!window.jogosMinimalistasGerados || window.jogosMinimalistasGerados.length === 0) {
                showCustomAlert('‚ö†Ô∏è Sem Jogos', 'Gere primeiro alguns jogos minimalistas!');
                return;
            }
            
            window.jogosMinimalistasGerados.forEach(jogoMin => {
                const jogo = {
                    id: Date.now() + Math.random(),
                    numeros: [...jogoMin.numeros],
                    quantidade: jogoMin.quantidade,
                    custo: jogoMin.custo,
                    digitosDiferentes: calcularDigitosDiferentes(jogoMin.numeros),
                    pares: jogoMin.numeros.filter(n => n % 2 === 0).length,
                    impares: jogoMin.numeros.filter(n => n % 2 !== 0).length,
                    origem: jogoMin.origem
                };
                jogosAdicionados.push(jogo);
            });
            
            atualizarVisualizacaoJogos();
            atualizarCustoTotal();
            
            showCustomAlert('‚úÖ Sucesso', `${window.jogosMinimalistasGerados.length} jogo(s) minimalista(s) adicionado(s) aos seus jogos!`);
        }

        // Event listeners
        function configurarEventListeners() {
            // Event listeners principais
            document.getElementById('comoFuncionaBtn').addEventListener('click', () => {
                document.getElementById('modalComoFunciona').classList.remove('hidden');
            });
            document.getElementById('fecharModal').addEventListener('click', () => {
                document.getElementById('modalComoFunciona').classList.add('hidden');
            });

            // Event listeners para configura√ß√£o de valores
            document.getElementById('btnAtualizarValores').addEventListener('click', () => {
                const novoValor = parseFloat(document.getElementById('valorApostaSimples').value);
                if (novoValor && novoValor > 0) {
                    valorApostaSimples = novoValor;
                    sistemaValores.atualizarTodosValores();
                    showCustomAlert('‚úÖ Valores Atualizados', `Novo valor da aposta simples: ${formatarMoeda(valorApostaSimples)}\nTodos os valores foram recalculados automaticamente!`);
                } else {
                    showCustomAlert('‚ö†Ô∏è Valor Inv√°lido', 'Digite um valor v√°lido maior que zero!');
                }
            });

            // ‚ö†Ô∏è IMPLEMENTA√á√ÉO IMPORTANTE: Event listener para permitir n√∫meros sorteados
            document.getElementById('permitirSorteados').addEventListener('change', (e) => {
                permitirNumerosSorteados = e.target.checked;
                criarGridNumeros(); // Recriar grid com nova configura√ß√£o
            });

            // Event listeners para jogos minimalistas
            document.getElementById('modalMinimalistaBtn').addEventListener('click', () => {
                document.getElementById('modalMinimalista').classList.remove('hidden');
            });
            document.getElementById('fecharModalMinimalista').addEventListener('click', () => {
                document.getElementById('modalMinimalista').classList.add('hidden');
            });
            document.getElementById('gerarJogosMin').addEventListener('click', gerarJogosMinimalistas);
            document.getElementById('adicionarTodosMin').addEventListener('click', adicionarTodosJogosMinimalistas);

            // Event listeners para edi√ß√£o manual
            document.getElementById('processarInput').addEventListener('click', processarNumerosInput);
            document.getElementById('inputManual').addEventListener('keypress', (e) => {
                if (e.key === 'Enter' && e.ctrlKey) {
                    processarNumerosInput();
                }
            });

            // Event listeners para jogos
            document.getElementById('quantidadeDezenas').addEventListener('change', (e) => {
                quantidadeSelecionada = parseInt(e.target.value);
                limparSelecao();
                atualizarVisualizacaoDropArea();
                validarBotaoAdicionar();
            });

            document.getElementById('limparJogo').addEventListener('click', limparSelecao);
            document.getElementById('randomizarJogo').addEventListener('click', randomizarJogo);
            document.getElementById('adicionarJogo').addEventListener('click', adicionarJogo);
            document.getElementById('limparArea').addEventListener('click', limparSelecao);
            
            document.getElementById('mostrarOrdemCrescente').addEventListener('change', atualizarVisualizacaoJogos);
            document.getElementById('limparTodos').addEventListener('click', limparTodosJogos);
            
            document.getElementById('downloadHTML').addEventListener('click', () => downloadJogos('html'));
            document.getElementById('downloadTXT').addEventListener('click', () => downloadJogos('txt'));
            document.getElementById('downloadXLSX').addEventListener('click', () => downloadJogos('xlsx'));

            // Event listeners para SE√á√ïES 3-13
            
            // SE√á√ÉO 3: Posi√ß√µes
            if (document.getElementById('gerarJogosPosicoes')) {
                document.getElementById('gerarJogosPosicoes').addEventListener('click', gerarJogosPorPosicoes);
                document.getElementById('adicionarTodosPosicoes').addEventListener('click', () => adicionarTodosJogosSecao('Posicoes'));
            }
            
            // SE√á√ÉO 4: Alterados
            if (document.getElementById('gerarJogosAlterado')) {
                document.getElementById('gerarJogosAlterado').addEventListener('click', gerarJogosAlterados);
                document.getElementById('adicionarTodosAlterado').addEventListener('click', () => adicionarTodosJogosSecao('Alterado'));
                inicializarSecaoAlterado();
            }
            
            // SE√á√ÉO 5: Regras Fixas
            if (document.getElementById('gerarJogosRegrasFixas')) {
                document.getElementById('gerarJogosRegrasFixas').addEventListener('click', gerarJogosRegrasFixas);
                document.getElementById('adicionarTodosRegrasFixas').addEventListener('click', () => adicionarTodosJogosSecao('RegrasFixas'));
            }
            
            // SE√á√ÉO 8: Atrasados
            if (document.getElementById('gerarJogosAtrasados')) {
                document.getElementById('gerarJogosAtrasados').addEventListener('click', gerarJogosAtrasados);
                document.getElementById('adicionarTodosAtrasados').addEventListener('click', () => adicionarTodosJogosSecao('Atrasados'));
                inicializarNumerosAtrasados();
            }
            
            // SE√á√ÉO 9: Mapa de Calor
            if (document.getElementById('gerarJogosCalor')) {
                document.getElementById('gerarJogosCalor').addEventListener('click', gerarJogosMapaCalor);
                document.getElementById('adicionarTodosCalor').addEventListener('click', () => adicionarTodosJogosSecao('Calor'));
                inicializarMapaCalor();
            }
            
            // SE√á√ÉO 12: Filtros
            if (document.getElementById('gerarJogosFiltros')) {
                document.getElementById('gerarJogosFiltros').addEventListener('click', gerarJogosFiltrados);
                document.getElementById('adicionarTodosFiltros').addEventListener('click', () => adicionarTodosJogosSecao('Filtros'));
            }
            
            // SE√á√ÉO 13: An√°lise
            if (document.getElementById('gerarAnalise')) {
                document.getElementById('gerarAnalise').addEventListener('click', gerarAnaliseComparativa);
            }
        }

        // Fun√ß√µes auxiliares b√°sicas
        function limparSelecao() {
            numerosSelecionados = [];
            numerosDropArea = [];
            document.querySelectorAll('.numero-mega').forEach(btn => {
                btn.classList.remove('selecionado');
            });
            atualizarVisualizacaoDropArea();
            atualizarContadorParesImpares();
            validarBotaoAdicionar();
        }

        function randomizarJogo() {
            limparSelecao();
            const quantidade = parseInt(document.getElementById('quantidadeDezenas').value);
            let numerosDisponiveis = Array.from({length: 60}, (_, i) => i + 1);
            
            // ‚ö†Ô∏è IMPORTANTE: Remover n√∫meros sorteados se n√£o permitidos
            if (!permitirNumerosSorteados) {
                numerosDisponiveis = numerosDisponiveis.filter(n => !numerosSorteados.has(n));
            }
            
            while (numerosSelecionados.length < quantidade && numerosDisponiveis.length > 0) {
                const index = Math.floor(Math.random() * numerosDisponiveis.length);
                const numero = numerosDisponiveis.splice(index, 1)[0];
                numerosSelecionados.push(numero);
                numerosDropArea.push(numero);
                
                const btn = document.querySelector(`.numero-mega:nth-child(${numero})`);
                if (btn) btn.classList.add('selecionado');
            }
            
            atualizarVisualizacaoDropArea();
            atualizarContadorParesImpares();
            validarBotaoAdicionar();
        }

        function adicionarJogo() {
            const quantidade = parseInt(document.getElementById('quantidadeDezenas').value);
            const custo = sistemaValores.obterValor(quantidade);
            
            const jogo = {
                id: Date.now(),
                numeros: [...numerosSelecionados].sort((a, b) => a - b),
                quantidade: quantidade,
                custo: custo,
                digitosDiferentes: calcularDigitosDiferentes(numerosSelecionados),
                pares: numerosSelecionados.filter(n => n % 2 === 0).length,
                impares: numerosSelecionados.filter(n => n % 2 !== 0).length,
                origem: 'Manual'
            };
            
            jogosAdicionados.push(jogo);
            limparSelecao();
            atualizarVisualizacaoJogos();
            atualizarCustoTotal();
        }

        function atualizarVisualizacaoJogos() {
            const lista = document.getElementById('listaJogos');
            const ordemCrescente = document.getElementById('mostrarOrdemCrescente').checked;
            
            if (jogosAdicionados.length === 0) {
                lista.innerHTML = '<p class="text-gray-500 text-center py-8">Nenhum jogo adicionado ainda</p>';
                return;
            }
            
            lista.innerHTML = '';
            jogosAdicionados.forEach((jogo, index) => {
                const jogoDiv = document.createElement('div');
                jogoDiv.className = 'jogo-card';
                
                const numerosOrdenados = ordemCrescente ? 
                    [...jogo.numeros].sort((a, b) => a - b) : 
                    jogo.numeros;
                
                jogoDiv.innerHTML = `
                    <div class="flex justify-between items-center mb-2">
                        <span class="font-bold text-megasena">Jogo ${index + 1}</span>
                        <div class="flex gap-2">
                            <span class="px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded">${jogo.digitosDiferentes} d√≠gitos</span>
                            <span class="px-2 py-1 bg-green-100 text-green-800 text-xs rounded">${jogo.pares || 0}P</span>
                            <span class="px-2 py-1 bg-purple-100 text-purple-800 text-xs rounded">${jogo.impares || 0}I</span>
                            <button onclick="removerJogo(${jogo.id})" class="bg-red-500 hover:bg-red-600 text-white px-2 py-1 rounded text-xs" title="Excluir este jogo">
                                üóëÔ∏è
                            </button>
                        </div>
                    </div>
                    <div class="flex flex-wrap gap-1 mb-2">
                        ${numerosOrdenados.map(num => 
                            `<div class="numero-jogo">${num.toString().padStart(2, '0')}</div>`
                        ).join('')}
                    </div>
                    <div class="text-sm text-gray-600">
                        ${jogo.quantidade} dezenas - ${formatarMoeda(jogo.custo)}
                        ${jogo.origem ? `<span class="text-orange-600"> | ${jogo.origem}</span>` : ''}
                    </div>
                `;
                
                lista.appendChild(jogoDiv);
            });
        }

        function removerJogo(id) {
            showCustomConfirm('Tem certeza que deseja excluir este jogo?', () => {
                jogosAdicionados = jogosAdicionados.filter(jogo => jogo.id !== id);
                atualizarVisualizacaoJogos();
                atualizarCustoTotal();
                showCustomAlert('‚úÖ Removido', 'Jogo exclu√≠do com sucesso!');
            });
        }

        function limparTodosJogos() {
            if (jogosAdicionados.length === 0) return;
            
            showCustomConfirm('Tem certeza que deseja remover todos os jogos?', () => {
                jogosAdicionados = [];
                atualizarVisualizacaoJogos();
                atualizarCustoTotal();
            });
        }

        function atualizarCustoTotal() {
            const total = jogosAdicionados.reduce((sum, jogo) => sum + jogo.custo, 0);
            document.getElementById('custoTotal').textContent = formatarMoeda(total);
            document.getElementById('totalJogos').textContent = jogosAdicionados.length;
        }

        function calcularDigitosDiferentes(numeros) {
            const digitos = new Set();
            numeros.forEach(num => {
                const numStr = num.toString().padStart(2, '0');
                for (let digit of numStr) {
                    digitos.add(parseInt(digit));
                }
            });
            return digitos.size;
        }

        function formatarMoeda(valor) {
            return new Intl.NumberFormat('pt-BR', {
                style: 'currency',
                currency: 'BRL'
            }).format(valor);
        }

        function showCustomAlert(titulo, mensagem) {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
            modal.innerHTML = `
                <div class="bg-white p-6 rounded-lg shadow-lg max-w-sm w-full mx-4">
                    <h3 class="font-bold text-megasena mb-2">${titulo}</h3>
                    <p class="text-gray-700 mb-4" style="white-space: pre-line;">${mensagem}</p>
                    <div class="flex justify-end">
                        <button class="px-4 py-2 bg-blue-500 text-white hover:bg-blue-600 rounded" onclick="this.closest('.fixed').remove()">OK</button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        function showCustomConfirm(message, onConfirm) {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
            modal.innerHTML = `
                <div class="bg-white p-6 rounded-lg shadow-lg max-w-sm w-full mx-4">
                    <p class="text-gray-700 mb-4" style="white-space: pre-line;">${message}</p>
                    <div class="flex justify-end space-x-3">
                        <button class="px-4 py-2 text-gray-600 hover:bg-gray-100 rounded" onclick="this.closest('.fixed').remove()">Cancelar</button>
                        <button class="px-4 py-2 bg-red-500 text-white hover:bg-red-600 rounded" onclick="this.closest('.fixed').remove(); (${onConfirm})()">Confirmar</button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        function baixarArquivo(conteudo, nomeArquivo, tipoMime) {
            const blob = new Blob([conteudo], { type: tipoMime });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = nomeArquivo;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
        }

        function downloadJogos(formato) {
            if (jogosAdicionados.length === 0) {
                showCustomAlert('‚ö†Ô∏è Sem Jogos', 'Adicione pelo menos um jogo antes de fazer o download!');
                return;
            }
            
            switch (formato) {
                case 'txt':
                    downloadTXT();
                    break;
                case 'html':
                    downloadHTML();
                    break;
                case 'xlsx':
                    downloadXLSX();
                    break;
            }
        }

        function downloadTXT() {
            let txt = '';
            jogosAdicionados.forEach((jogo, index) => {
                txt += jogo.numeros.map(n => n.toString().padStart(2, '0')).join(' ');
                if (index < jogosAdicionados.length - 1) {
                    txt += '\n';
                }
            });
            baixarArquivo(txt, 'mega-sena-jogos.txt', 'text/plain');
        }

        function downloadHTML() {
            const total = jogosAdicionados.reduce((sum, jogo) => sum + jogo.custo, 0);
            const data = new Date().toLocaleDateString('pt-BR');
            
            let html = `<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Mega Sena - Meus Jogos</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .header { text-align: center; margin-bottom: 30px; color: #1B9A67; }
        .jogo { margin: 10px 0; padding: 15px; border: 2px solid #1B9A67; border-radius: 8px; }
        .numero { display: inline-block; width: 35px; height: 35px; background: #1B9A67; color: white; 
                 border-radius: 50%; text-align: center; line-height: 35px; margin: 2px; font-weight: bold; }
        .total { text-align: center; margin-top: 20px; font-size: 18px; font-weight: bold; color: #1B9A67; }
    </style>
</head>
<body>
    <div class="header">
        <h1>üçÄ MEGA SENA - MEUS JOGOS</h1>
        <p>Gerado em: ${data}</p>
        <p><strong>Sistema Completo com 13 Se√ß√µes:</strong> Manual + Minimalista + 11 An√°lises Avan√ßadas</p>
    </div>`;
            
            jogosAdicionados.forEach((jogo, index) => {
                html += `
    <div class="jogo">
        <h3>Jogo ${index + 1} - ${jogo.quantidade} dezenas - ${formatarMoeda(jogo.custo)}</h3>
        <div>
            ${jogo.numeros.map(num => `<span class="numero">${num.toString().padStart(2, '0')}</span>`).join('')}
        </div>
        <div style="font-size: 12px; color: #666; margin-top: 5px;">
            ${jogo.digitosDiferentes} d√≠gitos diferentes | ${jogo.pares} pares, ${jogo.impares} √≠mpares
            ${jogo.origem ? ` | Origem: ${jogo.origem}` : ''}
        </div>
    </div>`;
            });
            
            html += `
    <div class="total">
        Total: ${jogosAdicionados.length} jogo(s) - ${formatarMoeda(total)}
    </div>
</body>
</html>`;
            
            baixarArquivo(html, 'mega-sena-jogos.html', 'text/html');
        }

        function downloadXLSX() {
            const dados = [
                ['Jogo', 'Dezenas', 'N√∫meros', 'D√≠gitos Diferentes', 'Pares', '√çmpares', 'Custo', 'Origem']
            ];
            
            jogosAdicionados.forEach((jogo, index) => {
                dados.push([
                    `Jogo ${index + 1}`,
                    jogo.quantidade,
                    jogo.numeros.map(n => n.toString().padStart(2, '0')).join(' - '),
                    jogo.digitosDiferentes,
                    jogo.pares,
                    jogo.impares,
                    jogo.custo,
                    jogo.origem || 'Manual'
                ]);
            });
            
            const total = jogosAdicionados.reduce((sum, jogo) => sum + jogo.custo, 0);
            dados.push(['', '', 'TOTAL:', '', '', '', total, '']);
            
            const ws = XLSX.utils.aoa_to_sheet(dados);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, 'Mega Sena');
            XLSX.writeFile(wb, 'mega-sena-jogos.xlsx');
        }

        // ===============================
        // JAVASCRIPT PARA SE√á√ïES 3-13
        // ===============================

        // SE√á√ÉO 3: An√°lise por Posi√ß√µes
        function gerarJogosPorPosicoes() {
            const qtd = parseInt(document.getElementById('qtdJogosPosicoes').value);
            const estrategia = document.getElementById('estrategiaPosicoes').value;
            
            // Simula√ß√£o de n√∫meros mais frequentes por posi√ß√£o
            const posicoes = {
                1: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10], // 1¬™ posi√ß√£o: n√∫meros baixos
                2: [8, 9, 10, 11, 12, 13, 14, 15, 16, 17], // 2¬™ posi√ß√£o
                3: [15, 16, 17, 18, 19, 20, 21, 22, 23, 24], // 3¬™ posi√ß√£o
                4: [25, 26, 27, 28, 29, 30, 31, 32, 33, 34], // 4¬™ posi√ß√£o
                5: [35, 36, 37, 38, 39, 40, 41, 42, 43, 44], // 5¬™ posi√ß√£o
                6: [45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60] // 6¬™ posi√ß√£o: n√∫meros altos
            };
            
            const jogosGerados = [];
            
            for (let i = 0; i < qtd; i++) {
                const jogo = [];
                
                // Para cada posi√ß√£o, escolher um n√∫mero baseado na estrat√©gia
                for (let pos = 1; pos <= 6; pos++) {
                    let candidatos = posicoes[pos];
                    
                    if (estrategia === 'maisfrequentes') {
                        candidatos = candidatos.slice(0, 5); // Top 5 da posi√ß√£o
                    } else if (estrategia === 'aleatorio') {
                        candidatos = Array.from({length: 60}, (_, i) => i + 1);
                    }
                    
                    // Escolher n√∫mero que n√£o est√° no jogo ainda
                    let numero;
                    let tentativas = 0;
                    do {
                        numero = candidatos[Math.floor(Math.random() * candidatos.length)];
                        tentativas++;
                    } while (jogo.includes(numero) && tentativas < 50);
                    
                    if (!jogo.includes(numero)) {
                        jogo.push(numero);
                    }
                }
                
                // Completar o jogo se necess√°rio
                while (jogo.length < 6) {
                    const numero = Math.floor(Math.random() * 60) + 1;
                    if (!jogo.includes(numero)) {
                        jogo.push(numero);
                    }
                }
                
                jogosGerados.push({
                    id: Date.now() + i,
                    numeros: jogo.sort((a, b) => a - b),
                    quantidade: 6,
                    custo: sistemaValores.obterValor(6),
                    origem: `Posi√ß√µes (${estrategia})`
                });
            }
            
            exibirJogosGerados('Posicoes', jogosGerados);
        }

        // SE√á√ÉO 4: Resultados Alterados
        function inicializarSecaoAlterado() {
            if (ultimoResultado && ultimoResultado.listaDezenas) {
                const numerosBase = document.getElementById('numerosBase');
                numerosBase.innerHTML = ultimoResultado.listaDezenas.map(num => 
                    `<span class="numero-base">${num}</span>`
                ).join('');
            }
        }

        function gerarJogosAlterados() {
            if (!ultimoResultado || !ultimoResultado.listaDezenas) {
                showCustomAlert('‚ö†Ô∏è Sem Dados', 'Dados do √∫ltimo sorteio n√£o dispon√≠veis!');
                return;
            }
            
            const qtd = parseInt(document.getElementById('qtdJogosAlterado').value);
            const transformacao = document.getElementById('tipoTransformacao').value;
            const numerosBase = ultimoResultado.listaDezenas.map(n => parseInt(n));
            
            const jogosGerados = [];
            
            for (let i = 0; i < qtd; i++) {
                let numerosTransformados = [];
                
                numerosBase.forEach(num => {
                    let novoNum = num;
                    
                    switch (transformacao) {
                        case 'mais1':
                            novoNum = num + 1;
                            break;
                        case 'menos1':
                            novoNum = num - 1;
                            break;
                        case 'dobrar':
                            novoNum = num * 2;
                            break;
                        case 'metade':
                            novoNum = Math.floor(num / 2);
                            break;
                        case 'inverter':
                            novoNum = parseInt(num.toString().split('').reverse().join(''));
                            break;
                        case 'mix':
                            const opcoes = [num + 1, num - 1, num * 2, Math.floor(num / 2)];
                            novoNum = opcoes[Math.floor(Math.random() * opcoes.length)];
                            break;
                    }
                    
                    // Manter dentro do range 1-60
                    if (novoNum < 1) novoNum = 1;
                    if (novoNum > 60) novoNum = 60;
                    
                    if (!numerosTransformados.includes(novoNum)) {
                        numerosTransformados.push(novoNum);
                    }
                });
                
                // Completar com n√∫meros aleat√≥rios se necess√°rio
                while (numerosTransformados.length < 6) {
                    const num = Math.floor(Math.random() * 60) + 1;
                    if (!numerosTransformados.includes(num)) {
                        numerosTransformados.push(num);
                    }
                }
                
                jogosGerados.push({
                    id: Date.now() + i,
                    numeros: numerosTransformados.slice(0, 6).sort((a, b) => a - b),
                    quantidade: 6,
                    custo: sistemaValores.obterValor(6),
                    origem: `Alterado (${transformacao})`
                });
            }
            
            exibirJogosGerados('Alterado', jogosGerados);
        }

        // SE√á√ÉO 5: Regras Fixas
        function gerarJogosRegrasFixas() {
            const qtd = parseInt(document.getElementById('qtdJogosRegrasFixas').value);
            const modo = document.getElementById('modoRegrasFixas').value;
            
            const regras = {
                pares: document.getElementById('regraPares').checked,
                impares: document.getElementById('regraImpares').checked,
                multiplos5: document.getElementById('regraMultiplos5').checked,
                sequencia: document.getElementById('regraSequencia').checked,
                terminam: document.getElementById('regraTerminam').checked,
                fibonacci: document.getElementById('regraFibonacci').checked
            };
            
            const jogosGerados = [];
            
            for (let i = 0; i < qtd; i++) {
                let candidatos = Array.from({length: 60}, (_, i) => i + 1);
                
                // Aplicar filtros baseado nas regras
                if (regras.pares && modo === 'estrito') {
                    candidatos = candidatos.filter(n => n % 2 === 0);
                }
                if (regras.impares && modo === 'estrito') {
                    candidatos = candidatos.filter(n => n % 2 !== 0);
                }
                if (regras.multiplos5) {
                    const multiplos5 = candidatos.filter(n => n % 5 === 0);
                    if (modo === 'estrito') {
                        candidatos = multiplos5;
                    } else {
                        candidatos = [...candidatos, ...multiplos5]; // Dar prefer√™ncia
                    }
                }
                if (regras.terminam) {
                    const terminam05 = candidatos.filter(n => n % 10 === 0 || n % 10 === 5);
                    if (modo === 'estrito') {
                        candidatos = terminam05;
                    }
                }
                
                // Fibonacci at√© 60: 1,1,2,3,5,8,13,21,34,55
                if (regras.fibonacci) {
                    const fib = [1, 2, 3, 5, 8, 13, 21, 34, 55];
                    if (modo === 'estrito') {
                        candidatos = candidatos.filter(n => fib.includes(n));
                    }
                }
                
                const jogo = [];
                const candidatosUnicos = [...new Set(candidatos)];
                
                while (jogo.length < 6 && candidatosUnicos.length > 0) {
                    const index = Math.floor(Math.random() * candidatosUnicos.length);
                    jogo.push(candidatosUnicos.splice(index, 1)[0]);
                }
                
                // Se n√£o conseguiu 6 n√∫meros, completar aleatoriamente
                while (jogo.length < 6) {
                    const num = Math.floor(Math.random() * 60) + 1;
                    if (!jogo.includes(num)) {
                        jogo.push(num);
                    }
                }
                
                jogosGerados.push({
                    id: Date.now() + i,
                    numeros: jogo.sort((a, b) => a - b),
                    quantidade: 6,
                    custo: sistemaValores.obterValor(6),
                    origem: `Regras Fixas (${modo})`
                });
            }
            
            exibirJogosGerados('RegrasFixas', jogosGerados);
        }

        // SE√á√ÉO 8: N√∫meros Atrasados (simula√ß√£o)
        function inicializarNumerosAtrasados() {
            // Simula√ß√£o de n√∫meros atrasados
            const atrasados = [12, 23, 31, 47, 52, 18, 29, 35, 41, 56, 14, 26, 38, 49, 7];
            const container = document.getElementById('numerosAtrasados');
            container.innerHTML = atrasados.map(num => 
                `<span class="numero-base bg-red-500">${num.toString().padStart(2, '0')}</span>`
            ).join('');
        }

        function gerarJogosAtrasados() {
            const qtd = parseInt(document.getElementById('qtdJogosAtrasados').value);
            const foco = document.getElementById('focoAtrasados').value;
            
            // N√∫meros "atrasados" simulados
            const atrasados = [12, 23, 31, 47, 52, 18, 29, 35, 41, 56, 14, 26, 38, 49, 7, 33, 44, 51, 13, 27];
            
            let pool = [];
            switch (foco) {
                case 'top10':
                    pool = atrasados.slice(0, 10);
                    break;
                case 'top15':
                    pool = atrasados.slice(0, 15);
                    break;
                case 'top20':
                    pool = atrasados;
                    break;
                case 'mix':
                    pool = [...atrasados.slice(0, 10), ...Array.from({length: 20}, (_, i) => i + 1)];
                    break;
            }
            
            const jogosGerados = [];
            
            for (let i = 0; i < qtd; i++) {
                const jogo = [];
                const poolCopia = [...pool];
                
                // Pelo menos 60% do jogo deve ser de n√∫meros atrasados
                const minAtrasados = Math.floor(6 * 0.6);
                
                for (let j = 0; j < minAtrasados && poolCopia.length > 0; j++) {
                    const index = Math.floor(Math.random() * poolCopia.length);
                    jogo.push(poolCopia.splice(index, 1)[0]);
                }
                
                // Completar com n√∫meros aleat√≥rios
                while (jogo.length < 6) {
                    const num = Math.floor(Math.random() * 60) + 1;
                    if (!jogo.includes(num)) {
                        jogo.push(num);
                    }
                }
                
                jogosGerados.push({
                    id: Date.now() + i,
                    numeros: jogo.sort((a, b) => a - b),
                    quantidade: 6,
                    custo: sistemaValores.obterValor(6),
                    origem: `Atrasados (${foco})`
                });
            }
            
            exibirJogosGerados('Atrasados', jogosGerados);
        }

        // SE√á√ÉO 9: Mapa de Calor
        function inicializarMapaCalor() {
            const mapa = document.getElementById('mapaCalor');
            mapa.innerHTML = '';
            
            for (let i = 1; i <= 60; i++) {
                const div = document.createElement('div');
                div.className = 'w-8 h-8 rounded text-white text-xs flex items-center justify-center font-bold';
                
                // Simular "temperatura" do n√∫mero
                const temp = Math.random();
                if (temp > 0.8) {
                    div.classList.add('bg-red-500'); // Muito quente
                } else if (temp > 0.6) {
                    div.classList.add('bg-yellow-500'); // Quente
                } else if (temp > 0.3) {
                    div.classList.add('bg-blue-500'); // Frio
                } else {
                    div.classList.add('bg-purple-500'); // Muito frio
                }
                
                div.textContent = i.toString().padStart(2, '0');
                mapa.appendChild(div);
            }
        }

        function gerarJogosMapaCalor() {
            const qtd = parseInt(document.getElementById('qtdJogosCalor').value);
            const estrategia = document.getElementById('estrategiaCalor').value;
            
            // Simular categoriza√ß√£o dos n√∫meros
            const muitoQuentes = [5, 12, 18, 23, 31, 42, 47, 53];
            const quentes = [7, 14, 19, 26, 33, 38, 44, 51, 57];
            const frios = [3, 9, 16, 22, 29, 35, 41, 48, 54];
            const muitoFrios = [1, 8, 15, 27, 34, 39, 46, 52, 59];
            
            const jogosGerados = [];
            
            for (let i = 0; i < qtd; i++) {
                let pool = [];
                
                switch (estrategia) {
                    case 'quentes':
                        pool = [...muitoQuentes, ...quentes];
                        break;
                    case 'frios':
                        pool = [...frios, ...muitoFrios];
                        break;
                    case 'equilibrado':
                        pool = [...muitoQuentes.slice(0, 2), ...quentes.slice(0, 2), ...frios.slice(0, 2)];
                        break;
                    case 'extremos':
                        pool = [...muitoQuentes, ...muitoFrios];
                        break;
                }
                
                const jogo = [];
                const poolCopia = [...pool];
                
                while (jogo.length < 6 && poolCopia.length > 0) {
                    const index = Math.floor(Math.random() * poolCopia.length);
                    jogo.push(poolCopia.splice(index, 1)[0]);
                }
                
                // Completar se necess√°rio
                while (jogo.length < 6) {
                    const num = Math.floor(Math.random() * 60) + 1;
                    if (!jogo.includes(num)) {
                        jogo.push(num);
                    }
                }
                
                jogosGerados.push({
                    id: Date.now() + i,
                    numeros: jogo.sort((a, b) => a - b),
                    quantidade: 6,
                    custo: sistemaValores.obterValor(6),
                    origem: `Mapa Calor (${estrategia})`
                });
            }
            
            exibirJogosGerados('Calor', jogosGerados);
        }

        // SE√á√ÉO 12: Filtros Inteligentes
        function gerarJogosFiltrados() {
            const qtdDesejada = parseInt(document.getElementById('qtdJogosFiltros').value);
            const tentativasMax = parseInt(document.getElementById('tentativasMax').value);
            
            const somaMin = parseInt(document.getElementById('somaMin').value);
            const somaMax = parseInt(document.getElementById('somaMax').value);
            const paresMin = parseInt(document.getElementById('paresMin').value);
            const paresMax = parseInt(document.getElementById('paresMax').value);
            const imparesMin = parseInt(document.getElementById('imparesMin').value);
            const imparesMax = parseInt(document.getElementById('imparesMax').value);
            
            const filtroConsecutivos = document.getElementById('filtroConsecutivos').checked;
            const filtroExtremos = document.getElementById('filtroExtremos').checked;
            const filtroTerminacoes = document.getElementById('filtroTerminacoes').checked;
            const filtroPrimos = document.getElementById('filtroPrimos').checked;
            
            const primos = [2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47, 53, 59];
            
            const jogosGerados = [];
            let tentativas = 0;
            
            while (jogosGerados.length < qtdDesejada && tentativas < tentativasMax) {
                tentativas++;
                
                // Gerar jogo aleat√≥rio
                const jogo = [];
                while (jogo.length < 6) {
                    const num = Math.floor(Math.random() * 60) + 1;
                    if (!jogo.includes(num)) {
                        jogo.push(num);
                    }
                }
                jogo.sort((a, b) => a - b);
                
                // Aplicar filtros
                const soma = jogo.reduce((acc, num) => acc + num, 0);
                if (soma < somaMin || soma > somaMax) continue;
                
                const pares = jogo.filter(n => n % 2 === 0).length;
                const impares = jogo.filter(n => n % 2 !== 0).length;
                if (pares < paresMin || pares > paresMax) continue;
                if (impares < imparesMin || impares > imparesMax) continue;
                
                if (filtroConsecutivos) {
                    let consecutivos = 1;
                    for (let i = 1; i < jogo.length; i++) {
                        if (jogo[i] === jogo[i-1] + 1) {
                            consecutivos++;
                            if (consecutivos >= 3) break;
                        } else {
                            consecutivos = 1;
                        }
                    }
                    if (consecutivos >= 3) continue;
                }
                
                if (filtroExtremos) {
                    const temBaixo = jogo.some(n => n <= 20);
                    const temAlto = jogo.some(n => n >= 41);
                    if (!temBaixo || !temAlto) continue;
                }
                
                if (filtroTerminacoes) {
                    const terminacoes = {};
                    for (let num of jogo) {
                        const term = num % 10;
                        terminacoes[term] = (terminacoes[term] || 0) + 1;
                        if (terminacoes[term] > 2) break;
                    }
                    if (Object.values(terminacoes).some(count => count > 2)) continue;
                }
                
                if (filtroPrimos) {
                    const temPrimo = jogo.some(n => primos.includes(n));
                    if (!temPrimo) continue;
                }
                
                // Se passou em todos os filtros, adicionar
                jogosGerados.push({
                    id: Date.now() + jogosGerados.length,
                    numeros: jogo,
                    quantidade: 6,
                    custo: sistemaValores.obterValor(6),
                    origem: `Filtros (${tentativas} tentativas)`
                });
            }
            
            document.getElementById('infoFiltros').textContent = 
                `${jogosGerados.length} jogos gerados em ${tentativas} tentativas (${((jogosGerados.length/tentativas)*100).toFixed(1)}% aprova√ß√£o)`;
            
            exibirJogosGerados('Filtros', jogosGerados);
        }

        // SE√á√ÉO 13: An√°lise e Compara√ß√£o
        function gerarAnaliseComparativa() {
            if (jogosAdicionados.length === 0) {
                showCustomAlert('‚ö†Ô∏è Sem Jogos', 'Adicione alguns jogos primeiro para gerar a an√°lise!');
                return;
            }
            
            const tipoAnalise = document.getElementById('tipoAnalise').value;
            const formatoRelatorio = document.getElementById('formatoRelatorio').value;
            
            let relatorio = `
                <div class="p-4 bg-white border border-gray-300 rounded-lg">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">üìä Relat√≥rio de An√°lise - ${new Date().toLocaleDateString()}</h3>
                    
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                        <div class="p-3 bg-blue-50 rounded">
                            <div class="text-2xl font-bold text-blue-600">${jogosAdicionados.length}</div>
                            <div class="text-sm text-blue-800">Total de Jogos</div>
                        </div>
                        <div class="p-3 bg-green-50 rounded">
                            <div class="text-2xl font-bold text-green-600">${formatarMoeda(jogosAdicionados.reduce((sum, j) => sum + j.custo, 0))}</div>
                            <div class="text-sm text-green-800">Custo Total</div>
                        </div>
                        <div class="p-3 bg-purple-50 rounded">
                            <div class="text-2xl font-bold text-purple-600">${[...new Set(jogosAdicionados.flatMap(j => j.numeros))].length}</div>
                            <div class="text-sm text-purple-800">N√∫meros √önicos</div>
                        </div>
                    </div>
            `;
            
            if (tipoAnalise === 'completa' || tipoAnalise === 'duplicatas') {
                // An√°lise de duplicatas
                const duplicatas = [];
                for (let i = 0; i < jogosAdicionados.length; i++) {
                    for (let j = i + 1; j < jogosAdicionados.length; j++) {
                        const jogo1 = jogosAdicionados[i].numeros.sort().join(',');
                        const jogo2 = jogosAdicionados[j].numeros.sort().join(',');
                        if (jogo1 === jogo2) {
                            duplicatas.push({jogo1: i+1, jogo2: j+1});
                        }
                    }
                }
                
                relatorio += `
                    <div class="mb-4 p-3 bg-red-50 border border-red-200 rounded">
                        <h4 class="font-bold text-red-800">üîç An√°lise de Duplicatas:</h4>
                        ${duplicatas.length === 0 ? 
                            '<p class="text-green-700">‚úÖ Nenhuma duplicata encontrada!</p>' :
                            `<p class="text-red-700">‚ö†Ô∏è ${duplicatas.length} duplicata(s) encontrada(s)</p>`
                        }
                    </div>
                `;
            }
            
            if (tipoAnalise === 'completa' || tipoAnalise === 'estatisticas') {
                // Estat√≠sticas gerais
                const todasQuantidades = jogosAdicionados.map(j => j.quantidade);
                const origens = jogosAdicionados.map(j => j.origem || 'Manual');
                const distribOrigens = {};
                origens.forEach(origem => {
                    distribOrigens[origem] = (distribOrigens[origem] || 0) + 1;
                });
                
                relatorio += `
                    <div class="mb-4 p-3 bg-blue-50 border border-blue-200 rounded">
                        <h4 class="font-bold text-blue-800">üìà Estat√≠sticas:</h4>
                        <div class="grid grid-cols-2 gap-2 text-sm">
                            <div>Quantidade mais comum: ${Math.mode(todasQuantidades) || 6} dezenas</div>
                            <div>Distribui√ß√£o por origem:</div>
                        </div>
                        <div class="text-xs mt-2">
                            ${Object.entries(distribOrigens).map(([origem, count]) => 
                                `<span class="inline-block bg-gray-200 px-2 py-1 rounded mr-1 mb-1">${origem}: ${count}</span>`
                            ).join('')}
                        </div>
                    </div>
                `;
            }
            
            relatorio += '</div>';
            
            document.getElementById('relatorioAnalise').innerHTML = relatorio;
            document.getElementById('resultadosAnalise').classList.remove('hidden');
        }

        // Fun√ß√£o auxiliar para exibir jogos gerados de qualquer se√ß√£o
        function exibirJogosGerados(secao, jogos) {
            const resultados = document.getElementById(`resultados${secao}`);
            const lista = document.getElementById(`listaJogos${secao}`);
            
            lista.innerHTML = '';
            
            jogos.forEach((jogo, index) => {
                const jogoDiv = document.createElement('div');
                jogoDiv.className = `jogo-${secao.toLowerCase()}-card`;
                
                const pares = jogo.numeros.filter(n => n % 2 === 0).length;
                const impares = jogo.numeros.filter(n => n % 2 !== 0).length;
                
                jogoDiv.innerHTML = `
                    <div class="flex justify-between items-center mb-2">
                        <span class="font-bold text-gray-600">Jogo ${index + 1}</span>
                        <div class="flex gap-1">
                            <span class="px-2 py-1 bg-green-100 text-green-800 text-xs rounded">${pares}P</span>
                            <span class="px-2 py-1 bg-purple-100 text-purple-800 text-xs rounded">${impares}I</span>
                            <span class="px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded">${formatarMoeda(jogo.custo)}</span>
                        </div>
                    </div>
                    <div class="flex flex-wrap gap-1 mb-2">
                        ${jogo.numeros.map(num => `<span class="numero-${secao.toLowerCase()}">${num.toString().padStart(2, '0')}</span>`).join('')}
                    </div>
                    <div class="text-xs text-gray-600">
                        ${jogo.quantidade} dezenas | Origem: ${jogo.origem}
                    </div>
                `;
                
                lista.appendChild(jogoDiv);
            });
            
            resultados.classList.remove('hidden');
            window[`jogos${secao}Gerados`] = jogos;
        }

        // Fun√ß√£o para adicionar todos os jogos de uma se√ß√£o
        function adicionarTodosJogosSecao(secao) {
            const jogosGerados = window[`jogos${secao}Gerados`];
            if (!jogosGerados || jogosGerados.length === 0) {
                showCustomAlert('‚ö†Ô∏è Sem Jogos', `Gere primeiro alguns jogos na se√ß√£o ${secao}!`);
                return;
            }
            
            jogosGerados.forEach(jogoSecao => {
                const jogo = {
                    id: Date.now() + Math.random(),
                    numeros: [...jogoSecao.numeros],
                    quantidade: jogoSecao.quantidade,
                    custo: jogoSecao.custo,
                    digitosDiferentes: calcularDigitosDiferentes(jogoSecao.numeros),
                    pares: jogoSecao.numeros.filter(n => n % 2 === 0).length,
                    impares: jogoSecao.numeros.filter(n => n % 2 !== 0).length,
                    origem: jogoSecao.origem
                };
                jogosAdicionados.push(jogo);
            });
            
            atualizarVisualizacaoJogos();
            atualizarCustoTotal();
            
            showCustomAlert('‚úÖ Sucesso', `${jogosGerados.length} jogo(s) da se√ß√£o ${secao} adicionado(s) aos seus jogos!`);
        }

        // Fun√ß√µes globais para eventos de drag and drop
        function allowDrop(ev) {
            ev.preventDefault();
        }

        function dragEnter(ev) {
            ev.preventDefault();
            ev.currentTarget.classList.add('drag-over');
        }

        function dragLeave(ev) {
            if (!ev.currentTarget.contains(ev.relatedTarget)) {
                ev.currentTarget.classList.remove('drag-over');
            }
        }

        function drop(ev) {
            ev.preventDefault();
            ev.currentTarget.classList.remove('drag-over');
            
            const numero = parseInt(ev.dataTransfer.getData('text/plain'));
            if (!isNaN(numero)) {
                adicionarNumeroDropArea(numero);
            }
        }
    </script>
</body>
</html>