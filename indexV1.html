<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mega Sena - Gerador de Palpites Avan√ßado com Regras Minimalistas</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        megasena: '#1B9A67',
                        'megasena-light': '#2db87f',
                        'megasena-dark': '#158755',
                        'megasena-bg': '#f0fdf4'
                    }
                }
            }
        }
    </script>
    <style>
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }
        @keyframes glow {
            0%, 100% { box-shadow: 0 0 5px rgba(27, 154, 103, 0.3); }
            50% { box-shadow: 0 0 20px rgba(27, 154, 103, 0.6); }
        }
        .loading-circle {
            width: 80px;
            height: 80px;
            background: linear-gradient(45deg, #1B9A67, #2db87f, #158755);
            border-radius: 50%;
            animation: pulse 2s infinite;
        }
        
        .numero-mega {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, #1B9A67, #2db87f);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.2s;
            border: 2px solid transparent;
        }
        
        .numero-mega:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 15px rgba(27, 154, 103, 0.4);
        }
        
        .numero-mega.selecionado {
            background: linear-gradient(135deg, #dc2626, #ef4444);
            box-shadow: 0 0 0 3px rgba(220, 38, 38, 0.3);
            border-color: #dc2626;
        }
        
        .numero-mega.disabled {
            background: #9ca3af;
            cursor: not-allowed;
            opacity: 0.5;
        }
        
        .numero-mega.sorteado {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            border: 2px solid #fbbf24;
            position: relative;
        }
        
        .numero-mega.sorteado::after {
            content: "üéØ";
            position: absolute;
            top: -8px;
            right: -8px;
            font-size: 12px;
        }
        
        .numero-mega.sorteado.disabled {
            background: #6b7280;
            opacity: 0.4;
            cursor: not-allowed;
        }

        .numero-mega.par {
            border: 2px solid #10b981;
        }
        .numero-mega.impar {
            border: 2px solid #8b5cf6;
        }

        .contador-destaque {
            animation: bounce 1s ease-in-out;
        }
        
        .meta-atingida {
            background: linear-gradient(45deg, #10b981, #34d399) !important;
            color: white;
            animation: pulse 1s infinite;
        }
        
        .meta-excedida {
            background: linear-gradient(45deg, #ef4444, #f87171) !important;
            color: white;
            animation: pulse 0.5s infinite;
        }

        .numero-mega.dragging {
            opacity: 0.5;
            transform: scale(0.9);
        }

        .drop-zone {
            min-height: 120px;
            border: 3px dashed #1B9A67;
            border-radius: 12px;
            background: linear-gradient(135deg, #f0fdf4, #dcfce7);
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            color: #1B9A67;
            font-weight: bold;
            transition: all 0.3s;
            position: relative;
        }

        .drop-zone.drag-over {
            background: linear-gradient(135deg, #dcfce7, #bbf7d0);
            border-color: #158755;
            transform: scale(1.02);
        }

        .drop-zone.has-numbers {
            background: linear-gradient(to right, #f0fdf4, #dcfce7);
            border-style: solid;
            padding: 16px;
        }

        .numero-drop {
            width: 35px;
            height: 35px;
            background: linear-gradient(135deg, #1B9A67, #2db87f);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 14px;
            margin: 2px;
            position: relative;
        }

        .numero-drop .remove-btn {
            position: absolute;
            top: -8px;
            right: -8px;
            background: #dc2626;
            color: white;
            border-radius: 50%;
            width: 16px;
            height: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            cursor: pointer;
            opacity: 0;
            transition: opacity 0.2s;
        }

        .numero-drop:hover .remove-btn {
            opacity: 1;
        }
        
        .jogo-card {
            background: linear-gradient(to right, #f0fdf4, #dcfce7);
            border: 2px solid #1B9A67;
            border-radius: 12px;
            padding: 16px;
            margin: 8px 0;
        }
        
        .numero-jogo {
            width: 35px;
            height: 35px;
            background: linear-gradient(135deg, #1B9A67, #2db87f);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 14px;
        }
        
        .custo-total {
            background: linear-gradient(45deg, #1B9A67, #158755);
            color: white;
            padding: 12px 20px;
            border-radius: 8px;
            font-weight: bold;
            font-size: 18px;
        }

        .digito-badge {
            background: linear-gradient(45deg, #3b82f6, #1d4ed8);
            color: white;
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: bold;
        }

        .numero-resultado {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #1B9A67, #2db87f);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 18px;
            margin: 0 4px;
        }

        .estatisticas-reais {
            background: linear-gradient(135deg, #f0fdf4, #dcfce7);
            border: 3px solid #1B9A67;
            border-radius: 12px;
            padding: 16px;
            margin: 16px 0;
        }

        .loading-real {
            color: #1B9A67;
            font-weight: bold;
            text-align: center;
            padding: 20px;
        }

        .palpite-card {
            background: linear-gradient(135deg, #f0fdf4, #dcfce7);
            border: 2px solid #1B9A67;
            border-radius: 12px;
            padding: 12px;
            margin: 8px 0;
        }

        .numero-palpite {
            width: 30px;
            height: 30px;
            background: linear-gradient(135deg, #1B9A67, #2db87f);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 12px;
            margin: 2px;
        }

        .numero-atrasado {
            background: linear-gradient(135deg, #dc2626, #ef4444) !important;
            animation: pulse 2s infinite;
        }

        .numero-candidato {
            background: linear-gradient(135deg, #f59e0b, #d97706) !important;
            border: 2px solid #fbbf24;
        }

        .bola-numero {
            background: linear-gradient(135deg, #1B9A67, #2db87f);
            color: white;
            border-radius: 50%;
            width: 25px;
            height: 25px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 10px;
            margin: 1px;
        }

        .numero-estrategico {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.2s;
            border: 3px solid transparent;
            position: relative;
        }

        .numero-estrategico:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        .numero-estrategico.selecionado-estrategico {
            border-color: #8b5cf6;
            box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.3);
        }

        .numero-muito-atrasado {
            background: linear-gradient(135deg, #dc2626, #b91c1c);
            color: white;
            animation: pulse 2s infinite;
        }

        .numero-atrasado-estrategico {
            background: linear-gradient(135deg, #ea580c, #dc2626);
            color: white;
        }

        .numero-candidato-estrategico {
            background: linear-gradient(135deg, #d97706, #f59e0b);
            color: white;
        }

        .numero-frequente-estrategico {
            background: linear-gradient(135deg, #059669, #10b981);
            color: white;
        }

        .numero-normal-estrategico {
            background: linear-gradient(135deg, #6b7280, #9ca3af);
            color: white;
        }

        .numero-oculto {
            opacity: 0.3;
            transform: scale(0.8);
            cursor: not-allowed;
        }

        .numero-estrategico::after {
            content: attr(data-posicao);
            position: absolute;
            top: -8px;
            right: -8px;
            background: #8b5cf6;
            color: white;
            border-radius: 50%;
            width: 16px;
            height: 16px;
            font-size: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        /* Estilos para Regras Minimalistas */
        .numero-base {
            background: linear-gradient(135deg, #1B9A67, #2db87f);
            color: white;
            border-radius: 6px;
            padding: 4px 8px;
            font-size: 12px;
            font-weight: bold;
            margin: 2px;
            display: inline-block;
        }

        .jogo-minimalista-card {
            background: linear-gradient(to right, #f0fdf4, #dcfce7);
            border: 2px solid #1B9A67;
            border-radius: 12px;
            padding: 12px;
            margin: 8px 0;
        }

        .numero-minimalista {
            width: 35px;
            height: 35px;
            background: linear-gradient(135deg, #1B9A67, #2db87f);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 14px;
            margin: 2px;
        }

        .regra-badge {
            background: linear-gradient(45deg, #8b5cf6, #7c3aed);
            color: white;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 10px;
            font-weight: bold;
            margin: 1px;
        }

        .tooltip-regra {
            position: fixed;
            background: #333;
            color: white;
            padding: 12px 16px;
            border-radius: 8px;
            font-size: 13px;
            max-width: 300px;
            z-index: 1000;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            pointer-events: none;
            line-height: 1.4;
        }

        .tooltip-regra::before {
            content: '';
            position: absolute;
            top: -6px;
            left: 50%;
            transform: translateX(-50%);
            border-left: 6px solid transparent;
            border-right: 6px solid transparent;
            border-bottom: 6px solid #333;
        }

        /* Se√ß√µes destacadas para gera√ß√£o de jogos */
        .secao-geracao {
            border: 3px solid #1B9A67;
            border-radius: 15px;
            background: linear-gradient(135deg, #f0fdf4, #dcfce7);
            position: relative;
            animation: glow 3s ease-in-out infinite;
        }

        .secao-geracao::before {
            content: "üéØ GERA√á√ÉO DE JOGOS";
            position: absolute;
            top: -12px;
            left: 20px;
            background: #1B9A67;
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
        }

        .secao-titulo {
            background: linear-gradient(45deg, #1B9A67, #2db87f);
            color: white;
            padding: 12px 20px;
            margin: -24px -24px 20px -24px;
            border-radius: 12px 12px 0 0;
            font-weight: bold;
            font-size: 18px;
            text-align: center;
        }

        .config-principal {
            background: linear-gradient(135deg, #fef3c7, #fde68a);
            border: 3px solid #f59e0b;
            border-radius: 15px;
            position: relative;
        }

        .config-principal::before {
            content: "‚öôÔ∏è CONFIGURA√á√ÉO PRINCIPAL";
            position: absolute;
            top: -12px;
            left: 20px;
            background: #f59e0b;
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
        }
    </style>
</head>
<body class="bg-megasena-bg min-h-screen">
    <div class="container mx-auto px-4 py-6">
        <!-- Header -->
        <div class="text-center mb-6">
            <h1 class="text-4xl font-bold text-megasena mb-2">üçÄ MEGA SENA</h1>
            <p class="text-gray-600">Gerador de Palpites com An√°lise Estat√≠stica + Regras Minimalistas</p>
            <div class="mt-3">
                <a href="https://resultadosdigitosmegasena.netlify.app" target="_blank" 
                   class="inline-flex items-center bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg text-sm transition-colors">
                    üåê Ver - An√°lise dos Digitos (Completo)
                </a>
            </div>
        </div>

        <!-- ‚öôÔ∏è CONFIGURA√á√ÉO PRINCIPAL DE VALORES -->
        <div class="config-principal p-6 mb-6">
            <div class="secao-titulo">‚öôÔ∏è CONFIGURA√á√ÉO PRINCIPAL - VALORES DA MEGA SENA</div>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                <div>
                    <label class="block text-orange-800 font-medium mb-2">üí∞ Valor da Aposta Simples (6 dezenas):</label>
                    <div class="flex gap-2">
                        <span class="text-orange-800 font-bold text-lg">R$</span>
                        <input 
                            type="number" 
                            id="valorApostaSimples" 
                            value="6.00" 
                            min="1" 
                            max="100" 
                            step="0.01"
                            class="w-24 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 text-base font-bold text-center"
                        >
                        <button id="btnAtualizarValores" class="bg-orange-500 hover:bg-orange-600 text-white px-4 py-2 rounded-lg">
                            üîÑ Atualizar
                        </button>
                    </div>
                    <div class="text-xs text-orange-600 mt-1">
                        <strong>Padr√£o oficial:</strong> R$ 6,00 (CEF)
                    </div>
                </div>
                
                <div>
                    <label class="block text-orange-800 font-medium mb-2">üìä Multiplicadores Autom√°ticos:</label>
                    <div class="bg-white p-3 rounded border text-xs">
                        <div><strong>7 dezenas:</strong> <span id="mult7">7x</span> = <span id="valor7">R$ 42,00</span></div>
                        <div><strong>8 dezenas:</strong> <span id="mult8">28x</span> = <span id="valor8">R$ 168,00</span></div>
                        <div><strong>15 dezenas:</strong> <span id="mult15">5005x</span> = <span id="valor15">R$ 30.030,00</span></div>
                    </div>
                </div>
                
                <div>
                    <label class="block text-orange-800 font-medium mb-2">üí° Status do Sistema:</label>
                    <div class="bg-green-100 p-3 rounded border text-xs text-green-800">
                        <div id="statusSistema">‚úÖ Sistema configurado</div>
                        <div><strong>√öltima atualiza√ß√£o:</strong> <span id="ultimaAtualizacao">-</span></div>
                        <div><strong>Total de op√ß√µes:</strong> 15 (6-20 dezenas)</div>
                    </div>
                </div>
            </div>
            
            <div class="bg-orange-100 border border-orange-300 rounded p-3 text-sm text-orange-800">
                <strong>üìå Como funciona:</strong> Defina o valor da aposta simples acima e todos os outros valores ser√£o calculados automaticamente usando os multiplicadores oficiais da Caixa. O sistema atualiza automaticamente todas as se√ß√µes (sele√ß√£o, jogos minimalistas, an√°lises, etc.).
            </div>
        </div>

        <!-- Loading -->
        <div id="loading" class="text-center py-8">
            <div class="loading-circle mx-auto mb-4"></div>
            <p class="text-megasena font-medium">üîç Buscando √∫ltimo resultado da Mega Sena...</p>
            <div class="loading-real mt-4">
                <div id="loadingDetails">Conectando com API da Caixa Econ√¥mica Federal...</div>
            </div>
        </div>

        <!-- √öltimo Resultado -->
        <div id="ultimoResultado" class="hidden mb-6">
            <div class="bg-white rounded-lg shadow-lg overflow-hidden border-2 border-megasena">
                <div class="bg-megasena text-white p-4 text-center">
                    <h2 id="tituloResultado" class="text-xl font-bold">Concurso</h2>
                    <div id="dataResultado" class="text-sm">üìÖ Data do sorteio</div>
                </div>
                
                <div class="p-6 text-center">
                    <div id="numerosResultado" class="flex justify-center gap-2 mb-4">
                        <!-- N√∫meros sorteados ser√£o inseridos aqui -->
                    </div>
                    
                    <div id="statusResultado" class="text-lg font-bold mb-4 text-red-600">
                        <!-- Status ser√° inserido aqui -->
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
                        <div id="premiacao5" class="flex items-center justify-center">
                            <!-- Premia√ß√£o 5 acertos -->
                        </div>
                        <div id="premiacao4" class="flex items-center justify-center">
                            <!-- Premia√ß√£o 4 acertos -->
                        </div>
                    </div>
                    
                    <div class="mt-4 text-center">
                        <div class="text-sm text-gray-600">Pr√≥ximo Sorteio: <span id="proximoConcurso">Concurso</span></div>
                        <div class="text-sm text-gray-600" id="dataProximoConcurso">Data</div>
                        <div class="text-2xl font-bold text-megasena mt-2" id="premioEstimado">
                            Pr√™mio Estimado
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Interface Principal - Dividida em 2 Colunas -->
        <div id="interfacePrincipal" class="hidden grid grid-cols-1 xl:grid-cols-2 gap-6">
            
            <!-- LADO ESQUERDO: Cria√ß√£o de Jogos -->
            <div class="space-y-6">
                
                <!-- üéØ SE√á√ÉO 1: JOGO MANUAL -->
                <div class="secao-geracao bg-white rounded-lg shadow-lg p-6">
                    <div class="secao-titulo">üéÆ SE√á√ÉO 1: CRIA√á√ÉO MANUAL DE JOGOS</div>
					    <div class="mt-3" align="center">
							<a href="https://resumomegasena-i.netlify.app" target="_blank" 
							   class="inline-flex items-center bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg text-sm transition-colors">
								üåê Padr√µes Identificados (Completo)
							</a>
						</div><br /><hr />
					
					<div class="flex justify-between items-center mb-4">
                        <h3 class="text-xl font-bold text-megasena">üéÆ Criar Novo Jogo</h3>
                        <button id="comoFuncionaBtn" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg text-sm">
                            ‚ùì Como Funciona
                        </button>
                    </div>
                    
                    <!-- Quantidade de Dezenas -->
                    <div class="mb-4">
                        <label class="block text-megasena font-medium mb-2">Quantidade de Dezenas:</label>
                        <select id="quantidadeDezenas" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-megasena text-base">
                            <!-- Ser√° preenchido dinamicamente -->
                        </select>
                    </div>

                    <!-- üéØ CONTADOR DE PARES/√çMPARES COM DADOS REAIS -->
                    <div class="mb-6 p-5 bg-gradient-to-br from-green-50 via-blue-50 to-purple-50 border-4 border-green-400 rounded-xl shadow-lg">
                        <div class="text-xl font-bold text-gray-800 mb-4 text-center">‚ö™ ESTRAT√âGIA: PARES vs √çMPARES (TEMPO REAL)</div>
                        
                        <!-- üéØ SE√á√ÉO: Padr√£o Hist√≥rico Mais Comum -->
                        <div id="padraoHistorico" class="mb-4 p-4 bg-gradient-to-r from-amber-50 to-orange-50 border-2 border-orange-300 rounded-lg text-center">
                            <div class="text-sm font-bold text-orange-800 mb-2">üèÜ PADR√ÉO HIST√ìRICO MAIS COMUM:</div>
                            <div id="padraoMaisComum" class="text-2xl font-bold text-orange-900 mb-1">
                                <span class="text-green-600" id="padraoParesHistorico">3</span>P/<span class="text-purple-600" id="padraoImparesHistorico">3</span>I
                            </div>
                            <div class="text-sm text-orange-700">
                                <span id="padraoOcorrencias" class="font-bold">664</span> vezes (<span id="padraoPorcentagem" class="font-bold">30.6</span>% dos casos)
                            </div>
                            <div class="text-xs text-orange-600 mt-1">üìà An√°lise de TODOS os concursos hist√≥ricos</div>
                        </div>

                        <!-- Estat√≠stica do √öltimo Sorteio REAL -->
                        <div id="estatisticaUltimoSorteio" class="mb-4 p-3 bg-blue-100 border border-blue-300 rounded-lg text-center">
                            <div class="text-sm font-medium text-blue-800">üìä √öLTIMO SORTEIO TEVE:</div>
                            <div class="text-lg font-bold text-blue-900">
                                <span id="paresUltimoSorteio" class="text-green-600">2</span> PARES + 
                                <span id="imparesUltimoSorteio" class="text-purple-600">4</span> √çMPARES
                            </div>
                            <div class="text-xs text-blue-700">üëÜ Dados reais da API da Caixa Econ√¥mica Federal</div>
                        </div>
                        
                        <!-- Contador Visual Atual com Meta Din√¢mica -->
                        <div class="grid grid-cols-2 gap-6 mb-4">
                            <div class="text-center p-4 bg-green-100 rounded-lg border-2 border-green-300">
                                <div class="text-4xl font-bold text-green-600 contador-destaque" id="paresAtuais">0</div>
                                <div class="text-lg font-bold text-green-700">PARES</div>
                                <div class="text-sm text-green-600">üéØ Meta Atual: <span id="metaPares" class="font-bold">3</span></div>
                                <div class="text-xs text-green-500">2, 4, 6, 8, 10...</div>
                            </div>
                            <div class="text-center p-4 bg-purple-100 rounded-lg border-2 border-purple-300">
                                <div class="text-4xl font-bold text-purple-600 contador-destaque" id="imparesAtuais">0</div>
                                <div class="text-lg font-bold text-purple-700">√çMPARES</div>
                                <div class="text-sm text-purple-600">üéØ Meta Atual: <span id="metaImpares" class="font-bold">3</span></div>
                                <div class="text-xs text-purple-500">1, 3, 5, 7, 9...</div>
                            </div>
                        </div>
                        
                        <!-- Status da Estrat√©gia -->
                        <div id="statusEstrategia" class="text-center p-3 rounded-lg font-bold text-lg bg-gray-100 text-gray-700">
                            üéØ Selecione n√∫meros para ver sua estrat√©gia
                        </div>
                        
                        <!-- Dica Din√¢mica -->
                        <div id="dicaEstrategia" class="mt-3 text-center text-sm bg-yellow-100 border border-yellow-300 rounded p-2 text-yellow-800">
                            üí° <strong>Dica:</strong> O padr√£o mais comum √© 3 pares e 3 √≠mpares (30.6% dos casos)
                        </div>
                    </div>

                    <!-- ‚úèÔ∏è SE√á√ÉO: Campo para Editar N√∫meros Inseridos -->
                    <div class="mb-4">
                        <label class="block text-megasena font-medium mb-2">‚úèÔ∏è Editar N√∫meros Manualmente:</label>
                        <div class="flex gap-2">
                            <textarea 
                                id="editarNumeros" 
                                class="flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-megasena text-base resize-none" 
                                placeholder="Jogo √∫nico: 02 15 23 32 44 47&#10;M√∫ltiplos jogos (uma linha = um jogo):&#10;10 20 33 40 51 60&#10;11 20 33 40 52 60&#10;12 20 33 40 53 60"
                                rows="3"
                                maxlength="500"
                            ></textarea>
                            <button id="aplicarNumeros" class="bg-megasena hover:bg-megasena-dark text-white px-4 py-2 rounded-lg">
                                ‚úÖ Aplicar
                            </button>
                        </div>
                        <div class="text-xs text-gray-600 mt-1">
                            <strong>Jogo √∫nico:</strong> Digite n√∫meros de 01 a 60 separados por espa√ßo/v√≠rgula.<br>
                            <strong>M√∫ltiplos jogos:</strong> Uma linha por jogo. Sistema detecta automaticamente a quantidade de dezenas (6-20).
                        </div>
                    </div>

                    <!-- An√°lise Complementar -->
                    <div id="analiseDigitos" class="mb-4 p-3 bg-blue-50 border border-blue-200 rounded-lg">
                        <div class="text-sm font-medium text-blue-800 mb-2">üìä An√°lise Complementar:</div>
                        <div class="grid grid-cols-2 gap-2 text-xs">
                            <div>Dezenas selecionadas: <span id="dezenasCount" class="font-bold">0</span></div>
                            <div>D√≠gitos diferentes: <span id="digitosCount" class="font-bold">0</span></div>
                        </div>
                        <div id="sugestaoDigitos" class="mt-2 text-xs text-blue-700">
                            <!-- Sugest√£o baseada no √∫ltimo sorteio REAL -->
                        </div>
                    </div>

                    <!-- Grid de N√∫meros 1-60 -->
                    <div class="mb-4">
                        <label class="block text-megasena font-medium mb-2">Selecione as Dezenas (01-60):</label>
                        <div class="text-xs mb-2 text-gray-600">
                            <span class="text-green-600">‚óè</span> Verde = Pares | 
                            <span class="text-purple-600">‚óè</span> Roxo = √çmpares | 
                            <span class="text-orange-600">üéØ</span> = J√° sa√≠ram no √∫ltimo sorteio
                        </div>
                        <div id="gridNumeros" class="grid grid-cols-6 gap-2">
                            <!-- N√∫meros de 01 a 60 ser√£o gerados aqui -->
                        </div>
                        
                        <!-- Controle de N√∫meros Sorteados -->
                        <div id="controleNumerosSorteados" class="mt-3 p-3 bg-orange-50 border border-orange-200 rounded-lg hidden">
                            <div class="flex justify-between items-center mb-2">
                                <div class="text-sm font-medium text-orange-800">
                                    üéØ N√∫meros j√° sorteados: <span id="numerosSorteadosLista" class="font-bold"></span>
                                </div>
                                <label class="flex items-center text-sm">
                                    <input type="checkbox" id="permitirNumerosSorteados" class="mr-2">
                                    <span class="text-orange-700">Permitir usar n√∫meros j√° sorteados</span>
                                </label>
                            </div>
                            <div class="text-xs text-orange-600">
                                Por padr√£o, n√∫meros que sa√≠ram no √∫ltimo sorteio est√£o <strong>desabilitados</strong> para evitar repeti√ß√µes.
                            </div>
                        </div>
                    </div>

                    <!-- üì• SE√á√ÉO: √Årea de Drag and Drop -->
                    <div class="mb-4">
                        <label class="block text-megasena font-medium mb-2">üéØ √Årea de Drag & Drop:</label>
                        <div id="dropZone" class="drop-zone">
                            <div id="dropMessage">
                                <div class="text-lg mb-2">üì• Arraste n√∫meros ou arquivos .txt aqui</div>
                                <div class="text-sm">Clique nos n√∫meros acima ou arraste arquivo .txt com jogos</div>
                            </div>
                            <div id="numerosDropped" class="hidden flex flex-wrap justify-center gap-1">
                                <!-- N√∫meros arrastados aparecer√£o aqui -->
                            </div>
                        </div>
                        <div class="flex justify-between items-center mt-2 text-xs text-gray-600">
                            <span>Quantidade especificada: <span id="quantidadeEspecificada" class="font-bold">6</span></span>
                            <span>N√∫meros na √°rea: <span id="numerosNaArea" class="font-bold">0</span></span>
                        </div>
                    </div>

                    <!-- Bot√µes de A√ß√£o -->
                    <div class="flex flex-wrap gap-2">
                        <button id="limparJogo" class="bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg">
                            üóëÔ∏è Limpar
                        </button>
                        <button id="randomizarJogo" class="bg-purple-500 hover:bg-purple-600 text-white px-4 py-2 rounded-lg">
                            üé≤ Aleat√≥rio
                        </button>
                        <button id="adicionarJogo" class="bg-megasena hover:bg-megasena-dark text-white px-4 py-2 rounded-lg disabled:opacity-50">
                            ‚ûï Adicionar Jogo
                        </button>
                    </div>
                </div>

                <!-- üéØ SE√á√ÉO 2: REGRAS MINIMALISTAS -->
                <div class="secao-geracao bg-white rounded-lg shadow-lg p-6">
                    <div class="secao-titulo">üéØ SE√á√ÉO 2: ESTRAT√âGIA MINIMALISTA</div>
					    <div class="mt-3" align="center">
							<a href="https://resumomegasena.netlify.app" target="_blank" 
							   class="inline-flex items-center bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg text-sm transition-colors">
								üåê Estrat√©gia Minimalista! (Completo)
							</a>
						</div><br /><hr />
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-lg font-bold text-megasena">üéØ Estrat√©gia Minimalista</h3>
                        <button id="btnInfoMinimalista" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg text-sm">
                            ‚ùì Como Funciona
                        </button>
                    </div>

                    <div class="mb-4 p-3 bg-green-50 border border-green-200 rounded-lg">
                        <div class="text-sm font-medium text-green-800 mb-2">üìä M√©todo de Extra√ß√£o Baseado em Dados Oficiais:</div>
                        <div class="text-xs text-green-700">
                            Utiliza informa√ß√µes do <strong>pr√≥ximo sorteio</strong> (concurso, data, pr√™mio) para gerar dezenas atrav√©s de regras matem√°ticas simples.
                            Baseado em an√°lise de resultados reais anteriores.
                        </div>
                    </div>

                    <!-- Informa√ß√µes do Pr√≥ximo Sorteio (API) -->
                    <div id="infoProximoSorteio" class="mb-4 p-4 bg-megasena text-white rounded-lg">
                        <div class="text-sm font-bold mb-2">üìÖ Dados do Pr√≥ximo Sorteio (API Oficial):</div>
                        <div id="dadosProximoSorteio" class="text-sm">
                            Carregando informa√ß√µes...
                        </div>
                    </div>

                    <!-- Sele√ß√£o de Regras -->
                    <div class="mb-6">
                        <label class="block text-megasena font-medium mb-3">üîß Selecione as Regras Minimalistas:</label>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                            <label class="flex items-center p-3 bg-gray-50 rounded-lg hover:bg-gray-100 cursor-pointer">
                                <input type="checkbox" id="regra1" class="mr-3 scale-125" checked>
                                <div class="flex-1">
                                    <span class="font-bold text-megasena">R1 - Direto</span>
                                    <div class="text-xs text-gray-600">N√∫meros que aparecem puros (dia, m√™s, concurso)</div>
                                </div>
                                <button type="button" class="ml-2 text-blue-500 hover:text-blue-700 regra-info" data-regra="1">‚ÑπÔ∏è</button>
                            </label>

                            <label class="flex items-center p-3 bg-gray-50 rounded-lg hover:bg-gray-100 cursor-pointer">
                                <input type="checkbox" id="regra2" class="mr-3 scale-125" checked>
                                <div class="flex-1">
                                    <span class="font-bold text-megasena">R2 - Soma</span>
                                    <div class="text-xs text-gray-600">Somar dois n√∫meros da base</div>
                                </div>
                                <button type="button" class="ml-2 text-blue-500 hover:text-blue-700 regra-info" data-regra="2">‚ÑπÔ∏è</button>
                            </label>

                            <label class="flex items-center p-3 bg-gray-50 rounded-lg hover:bg-gray-100 cursor-pointer">
                                <input type="checkbox" id="regra3" class="mr-3 scale-125" checked>
                                <div class="flex-1">
                                    <span class="font-bold text-megasena">R3 - Dobro/Mult.</span>
                                    <div class="text-xs text-gray-600">Dobrar ou multiplicar n√∫meros</div>
                                </div>
                                <button type="button" class="ml-2 text-blue-500 hover:text-blue-700 regra-info" data-regra="3">‚ÑπÔ∏è</button>
                            </label>

                            <label class="flex items-center p-3 bg-gray-50 rounded-lg hover:bg-gray-100 cursor-pointer">
                                <input type="checkbox" id="regra4" class="mr-3 scale-125">
                                <div class="flex-1">
                                    <span class="font-bold text-megasena">R4 - Diferen√ßa</span>
                                    <div class="text-xs text-gray-600">Subtrair valores entre si</div>
                                </div>
                                <button type="button" class="ml-2 text-blue-500 hover:text-blue-700 regra-info" data-regra="4">‚ÑπÔ∏è</button>
                            </label>

                            <label class="flex items-center p-3 bg-gray-50 rounded-lg hover:bg-gray-100 cursor-pointer">
                                <input type="checkbox" id="regra5" class="mr-3 scale-125" checked>
                                <div class="flex-1">
                                    <span class="font-bold text-megasena">R5 - Invers√£o</span>
                                    <div class="text-xs text-gray-600">Espelhar n√∫meros (ex: 25‚Üí52)</div>
                                </div>
                                <button type="button" class="ml-2 text-blue-500 hover:text-blue-700 regra-info" data-regra="5">‚ÑπÔ∏è</button>
                            </label>

                            <label class="flex items-center p-3 bg-gray-50 rounded-lg hover:bg-gray-100 cursor-pointer">
                                <input type="checkbox" id="regra6" class="mr-3 scale-125">
                                <div class="flex-1">
                                    <span class="font-bold text-megasena">R6 - Vizinhos</span>
                                    <div class="text-xs text-gray-600">Aproximar para n√∫meros pr√≥ximos</div>
                                </div>
                                <button type="button" class="ml-2 text-blue-500 hover:text-blue-700 regra-info" data-regra="6">‚ÑπÔ∏è</button>
                            </label>

                            <label class="flex items-center p-3 bg-gray-50 rounded-lg hover:bg-gray-100 cursor-pointer">
                                <input type="checkbox" id="regra7" class="mr-3 scale-125" checked>
                                <div class="flex-1">
                                    <span class="font-bold text-megasena">R7 - Soma Cruzada</span>
                                    <div class="text-xs text-gray-600">Somar elementos da mesma linha</div>
                                </div>
                                <button type="button" class="ml-2 text-blue-500 hover:text-blue-700 regra-info" data-regra="7">‚ÑπÔ∏è</button>
                            </label>
                        </div>
                    </div>

                    <!-- Controles de Gera√ß√£o -->
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                        <div>
                            <label class="block text-megasena font-medium mb-2">üéÆ Quantidade de Jogos:</label>
                            <select id="qtdJogosMinimalista" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-megasena text-base">
                                <option value="1">1 jogo</option>
                                <option value="2">2 jogos</option>
                                <option value="3" selected>3 jogos</option>
                                <option value="5">5 jogos</option>
                                <option value="10">10 jogos</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-megasena font-medium mb-2">üî¢ Dezenas por Jogo:</label>
                            <select id="dezenasMinimalista" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-megasena text-base">
                                <!-- Ser√° preenchido dinamicamente -->
                            </select>
                        </div>
                        <div class="flex items-end">
                            <button id="btnGerarMinimalista" class="bg-megasena hover:bg-megasena-dark text-white font-bold px-6 py-2 rounded-lg w-full">
                                üöÄ Gerar Jogos Minimalistas
                            </button>
                        </div>
                    </div>

                    <!-- N√∫meros Base Extra√≠dos -->
                    <div id="numerosBaseExtraidos" class="mb-4 p-3 bg-blue-50 border border-blue-200 rounded-lg hidden">
                        <div class="text-sm font-medium text-blue-800 mb-2">üîç N√∫meros Base Extra√≠dos:</div>
                        <div id="listaBaseExtraidos" class="flex flex-wrap gap-2">
                            <!-- N√∫meros base ser√£o inseridos aqui -->
                        </div>
                    </div>

                    <!-- Jogos Minimalistas Gerados -->
                    <div id="jogosMinimalistasGerados" class="hidden">
                        <h4 class="font-bold text-megasena mb-3">üéØ Jogos Minimalistas Gerados:</h4>
                        <div id="listaJogosMinimalistas" class="space-y-3">
                            <!-- Jogos ser√£o inseridos aqui -->
                        </div>
                        
                        <!-- Estat√≠sticas dos Jogos Gerados -->
                        <div id="estatisticasMinimalistas" class="mt-4 p-3 bg-green-50 border border-green-200 rounded-lg">
                            <div class="text-sm font-medium text-green-800 mb-2">üìä Estat√≠sticas dos Jogos:</div>
                            <div class="grid grid-cols-2 md:grid-cols-4 gap-2 text-xs">
                                <div>Total: <span id="totalJogosMin" class="font-bold">0</span> jogo(s)</div>
                                <div>Custo: <span id="custoTotalMin" class="font-bold">R$ 0,00</span></div>
                                <div>Regras usadas: <span id="regrasUsadas" class="font-bold">0</span></div>
                                <div>N√∫meros √∫nicos: <span id="numerosUnicosMin" class="font-bold">0</span></div>
                            </div>
                        </div>
                        
                        <!-- Bot√µes de A√ß√£o para Jogos Minimalistas -->
                        <div class="mt-4 flex gap-2 justify-center">
                            <button id="btnAdicionarMinimalistas" class="bg-megasena hover:bg-megasena-dark text-white px-4 py-2 rounded-lg">
                                ‚ûï Adicionar aos Meus Jogos
                            </button>
                            <button id="btnDownloadMinimalistas" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg">
                                üì• Download Jogos
                            </button>
                            <button id="btnLimparMinimalistas" class="bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg">
                                üóëÔ∏è Limpar
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Tabela de Probabilidades -->
                <div class="bg-white rounded-lg shadow-lg p-6 border-2 border-blue-200">
                    <h3 class="text-lg font-bold text-blue-800 mb-4">üìä Probabilidades de Acerto</h3>
                    <div class="overflow-x-auto">
                        <table class="w-full text-xs">
                            <thead class="bg-blue-100">
                                <tr>
                                    <th class="p-2 text-left">Dezenas</th>
                                    <th class="p-2 text-right">Valor</th>
                                    <th class="p-2 text-right">Sena</th>
                                    <th class="p-2 text-right">Quina</th>
                                    <th class="p-2 text-right">Quadra</th>
                                </tr>
                            </thead>
                            <tbody id="tabelaProbabilidades">
                                <!-- Ser√° preenchida dinamicamente -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- üéØ SE√á√ÉO 3: AN√ÅLISE POR POSI√á√ïES -->
                <div class="secao-geracao bg-white rounded-lg shadow-lg p-6">
                    <div class="secao-titulo">üéØ SE√á√ÉO 3: AN√ÅLISE POR POSI√á√ïES - N√öMEROS ATRASADOS</div>
						<div class="mt-3" align="center">
							<a href="https://resumomegasena-i.netlify.app" target="_blank" 
							   class="inline-flex items-center bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg text-sm transition-colors">
								üåê An√°lise por Posi√ß√µes! (Completo)
							</a>
						</div><br /><hr />
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-lg font-bold text-orange-800">üéØ An√°lise por Posi√ß√µes - N√∫meros Atrasados</h3>
                        <div class="flex gap-2">
                            <button id="btnCarregarPosicoes" class="bg-orange-500 hover:bg-orange-600 text-white px-4 py-2 rounded-lg text-sm">
                                üîÑ Carregar An√°lise
                            </button>
                            <button id="btnTogglePosicoes" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg text-sm">
                                üëÅÔ∏è Mostrar/Ocultar
                            </button>
                        </div>
                    </div>

                    <!-- Loading da An√°lise de Posi√ß√µes -->
                    <div id="loadingPosicoes" class="text-center py-8 hidden">
                        <div class="loading-circle mx-auto mb-4"></div>
                        <p class="text-orange-600 font-medium">üîç Analisando √∫ltimos concursos por posi√ß√£o...</p>
                        <div id="progressoPosicoes" class="mt-4 text-sm text-gray-600"></div>
                    </div>

                    <!-- Controles da An√°lise -->
                    <div id="controlesPosicoes" class="hidden mb-6 p-4 bg-orange-50 border border-orange-200 rounded-lg">
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                            <div>
                                <label class="block text-orange-800 font-medium mb-2">üìä Quantidade de Concursos:</label>
                                <select id="qtdConcursosPosicoes" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 text-base">
                                    <option value="20">√öltimos 20 concursos</option>
                                    <option value="30" selected>√öltimos 30 concursos</option>
                                    <option value="50">√öltimos 50 concursos</option>
                                    <option value="100">√öltimos 100 concursos</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-orange-800 font-medium mb-2">üéØ Filtro por Posi√ß√£o:</label>
                                <select id="filtroPosicoesAnalise" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 text-base">
                                    <option value="todas">Todas as Posi√ß√µes</option>
                                    <option value="1">Apenas 1¬™ Bola</option>
                                    <option value="2">Apenas 2¬™ Bola</option>
                                    <option value="3">Apenas 3¬™ Bola</option>
                                    <option value="4">Apenas 4¬™ Bola</option>
                                    <option value="5">Apenas 5¬™ Bola</option>
                                    <option value="6">Apenas 6¬™ Bola</option>
                                </select>
                            </div>
                            <div class="flex items-end">
                                <button id="btnAnalisarPosicoes" class="bg-orange-500 hover:bg-orange-600 text-white px-6 py-2 rounded-lg w-full">
                                    üîç Analisar
                                </button>
                            </div>
                        </div>
                        
                        <!-- Informa√ß√µes da An√°lise -->
                        <div id="infoAnalise" class="text-sm text-orange-700 bg-orange-100 p-3 rounded hidden">
                            <!-- Ser√° preenchido dinamicamente -->
                        </div>
                    </div>

                    <!-- Resultados da An√°lise por Posi√ß√µes -->
                    <div id="resultadosPosicoes" class="hidden">
                        
                        <!-- Resumo Executivo -->
                        <div class="mb-6 p-4 bg-gradient-to-r from-orange-50 to-yellow-50 border-2 border-orange-300 rounded-lg">
                            <h4 class="text-lg font-bold text-orange-800 mb-3 text-center">üìà Resumo Executivo</h4>
                            <div class="grid grid-cols-2 md:grid-cols-3 gap-4 text-center">
                                <div class="bg-white p-3 rounded-lg border border-orange-200">
                                    <div class="text-2xl font-bold text-orange-600" id="totalNumerosAtrasados">0</div>
                                    <div class="text-sm text-orange-800">N√∫meros Atrasados</div>
                                </div>
                                <div class="bg-white p-3 rounded-lg border border-orange-200">
                                    <div class="text-2xl font-bold text-orange-600" id="posicaoMaisAtrasada">-</div>
                                    <div class="text-sm text-orange-800">Posi√ß√£o + Atrasada</div>
                                </div>
                                <div class="bg-white p-3 rounded-lg border border-orange-200">
                                    <div class="text-2xl font-bold text-orange-600" id="numeroMaisAtrasado">-</div>
                                    <div class="text-sm text-orange-800">N√∫mero + Atrasado</div>
                                </div>
                            </div>
                        </div>

                        <!-- Tabela de An√°lise por Posi√ß√µes -->
                        <div class="overflow-x-auto">
                            <table class="w-full text-sm border">
                                <thead>
                                    <tr class="bg-orange-500 text-white">
                                        <th class="p-3 border text-center">Posi√ß√£o</th>
                                        <th class="p-3 border text-center">√öltimo N√∫mero</th>
                                        <th class="p-3 border text-center">N√∫meros Atrasados</th>
                                        <th class="p-3 border text-center">Candidatos TOP</th>
                                        <th class="p-3 border text-center">Concursos Sem Sair</th>
                                        <th class="p-3 border text-center">Sugest√£o</th>
                                    </tr>
                                </thead>
                                <tbody id="tabelaAnaliseCorpo">
                                    <!-- Ser√° preenchido via JavaScript -->
                                </tbody>
                            </table>
                        </div>

                        <!-- üéØ SE√á√ÉO: Grid de Sele√ß√£o Estrat√©gica -->
                        <div class="mt-6 p-4 bg-gradient-to-r from-purple-50 to-pink-50 border-2 border-purple-400 rounded-lg">
                            <h4 class="text-lg font-bold text-purple-800 mb-4 text-center">üéØ Sele√ß√£o Manual Estrat√©gica</h4>
                            <p class="text-sm text-purple-700 text-center mb-4">Clique nos n√∫meros baseado na an√°lise por posi√ß√µes para criar seu jogo personalizado</p>
                            
                            <!-- Controles da Sele√ß√£o Estrat√©gica -->
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                                <div>
                                    <label class="block text-purple-800 font-medium mb-2">üéØ Posi√ß√£o Atual:</label>
                                    <select id="posicaoAtual" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 text-base">
                                        <option value="1">1¬™ Bola</option>
                                        <option value="2">2¬™ Bola</option>
                                        <option value="3">3¬™ Bola</option>
                                        <option value="4">4¬™ Bola</option>
                                        <option value="5">5¬™ Bola</option>
                                        <option value="6">6¬™ Bola</option>
                                        <option value="todas">Todas as Posi√ß√µes</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-purple-800 font-medium mb-2">üìä Filtro de N√∫meros:</label>
                                    <select id="filtroNumeros" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 text-base">
                                        <option value="todos">Todos os N√∫meros</option>
                                        <option value="atrasados">Apenas Atrasados</option>
                                        <option value="candidatos">Apenas Candidatos TOP</option>
                                        <option value="frequentes">Apenas Frequentes</option>
                                    </select>
                                </div>
                                <div class="flex items-end">
                                    <button id="btnAtualizarGrid" class="bg-purple-500 hover:bg-purple-600 text-white px-6 py-2 rounded-lg w-full">
                                        üîÑ Atualizar Grid
                                    </button>
                                </div>
                            </div>

                            <!-- Legenda da Grid Estrat√©gica -->
                            <div class="mb-4 p-3 bg-white rounded-lg border border-purple-200">
                                <div class="text-sm font-bold text-purple-800 mb-2 text-center">üìã Legenda da Grid Estrat√©gica:</div>
                                <div class="grid grid-cols-2 md:grid-cols-4 gap-2 text-xs">
                                    <div class="flex items-center">
                                        <span class="w-4 h-4 bg-red-500 rounded-full mr-2"></span>
                                        <span>Muito Atrasados</span>
                                    </div>
                                    <div class="flex items-center">
                                        <span class="w-4 h-4 bg-orange-500 rounded-full mr-2"></span>
                                        <span>Atrasados</span>
                                    </div>
                                    <div class="flex items-center">
                                        <span class="w-4 h-4 bg-yellow-500 rounded-full mr-2"></span>
                                        <span>Candidatos TOP</span>
                                    </div>
                                    <div class="flex items-center">
                                        <span class="w-4 h-4 bg-green-500 rounded-full mr-2"></span>
                                        <span>Frequentes</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Grid Estrat√©gica de N√∫meros -->
                            <div class="mb-4">
                                <div id="infoGridEstrategica" class="text-sm text-purple-700 bg-purple-100 p-3 rounded mb-4 text-center">
                                    Selecione uma posi√ß√£o e filtro acima para ver os n√∫meros estrat√©gicos
                                </div>
                                <div id="gridEstrategica" class="grid grid-cols-6 gap-2">
                                    <!-- Grid ser√° preenchida dinamicamente -->
                                </div>
                            </div>

                            <!-- Status da Sele√ß√£o Estrat√©gica -->
                            <div class="mb-4 p-3 bg-white rounded-lg border border-purple-200">
                                <div class="text-sm font-bold text-purple-800 mb-2">üìä Status da Sele√ß√£o:</div>
                                <div class="grid grid-cols-2 md:grid-cols-4 gap-4 text-center">
                                    <div>
                                        <div class="text-lg font-bold text-purple-600" id="numerosEstrategicos">0</div>
                                        <div class="text-xs text-purple-800">Selecionados</div>
                                    </div>
                                    <div>
                                        <div class="text-lg font-bold text-red-600" id="atrasadosEstrategicos">0</div>
                                        <div class="text-xs text-purple-800">Atrasados</div>
                                    </div>
                                    <div>
                                        <div class="text-lg font-bold text-yellow-600" id="candidatosEstrategicos">0</div>
                                        <div class="text-xs text-purple-800">Candidatos</div>
                                    </div>
                                    <div>
                                        <div class="text-lg font-bold text-green-600" id="frequentesEstrategicos">0</div>
                                        <div class="text-xs text-purple-800">Frequentes</div>
                                    </div>
                                </div>
                            </div>

                            <!-- Bot√µes de A√ß√£o da Sele√ß√£o Estrat√©gica -->
                            <div class="flex flex-wrap gap-2 justify-center">
                                <button id="btnLimparEstrategica" class="bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg">
                                    üóëÔ∏è Limpar Sele√ß√£o
                                </button>
                                <button id="btnSugestaoRapida" class="bg-orange-500 hover:bg-orange-600 text-white px-4 py-2 rounded-lg">
                                    ‚ö° Sugest√£o R√°pida
                                </button>
                                <button id="btnUsarEstrategica" class="bg-purple-500 hover:bg-purple-600 text-white px-4 py-2 rounded-lg disabled:opacity-50">
                                    ‚úÖ Usar Sele√ß√£o no Jogo Principal
                                </button>
                            </div>
                        </div>

                        <!-- Gerador de Palpites Baseado na An√°lise -->
                        <div class="mt-6 p-4 bg-gradient-to-r from-green-50 to-blue-50 border-2 border-green-400 rounded-lg">
                            <h4 class="text-lg font-bold text-green-800 mb-4 text-center">üé≤ Gerador de Palpites Inteligente</h4>
                            
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                                <div>
                                    <label class="block text-green-800 font-medium mb-2">üéØ Estrat√©gia:</label>
                                    <select id="estrategiaPalpite" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 text-base">
                                        <option value="atrasados">Focar nos Mais Atrasados</option>
                                        <option value="equilibrado">Estrat√©gia Equilibrada</option>
                                        <option value="misto">Misto (Atrasados + Frequentes)</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-green-800 font-medium mb-2">üéÆ Quantidade de Jogos:</label>
                                    <select id="qtdJogosPalpite" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 text-base">
                                        <option value="1">1 jogo</option>
                                        <option value="3">3 jogos</option>
                                        <option value="5" selected>5 jogos</option>
                                        <option value="10">10 jogos</option>
                                    </select>
                                </div>
                            </div>

                            <div class="text-center mb-4">
                                <button id="btnGerarPalpites" class="bg-green-500 hover:bg-green-600 text-white font-bold px-8 py-3 rounded-lg text-lg">
                                    üöÄ Gerar Palpites Inteligentes
                                </button>
                            </div>

                            <!-- Palpites Gerados -->
                            <div id="palpitesGerados" class="hidden">
                                <h5 class="font-bold text-green-800 mb-3">üéØ Palpites Baseados na An√°lise:</h5>
                                <div id="listaPalpites" class="space-y-3">
                                    <!-- Palpites ser√£o inseridos aqui -->
                                </div>
                                
                                <!-- Bot√µes de A√ß√£o para Palpites -->
                                <div class="mt-4 flex gap-2 justify-center">
                                    <button id="btnAdicionarPalpites" class="bg-megasena hover:bg-megasena-dark text-white px-4 py-2 rounded-lg">
                                        ‚ûï Adicionar aos Meus Jogos
                                    </button>
                                    <button id="btnDownloadPalpites" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg">
                                        üì• Download Palpites
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- LADO DIREITO: Visualiza√ß√£o dos Jogos -->
            <div class="space-y-6">
                <!-- Resumo e Controles -->
                <div class="bg-white rounded-lg shadow-lg p-6 border-2 border-megasena">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-xl font-bold text-megasena">üìã Meus Jogos</h3>
                        <div class="flex items-center gap-2">
                            <label class="flex items-center text-sm">
                                <input type="checkbox" id="mostrarOrdemCrescente" class="mr-2" checked>
                                üî¢ Ordem Crescente
                            </label>
                        </div>
                    </div>

                    <!-- Custo Total -->
                    <div class="mb-4">
                        <div class="custo-total text-center">
                            üí∞ Total: <span id="custoTotal">R$ 0,00</span>
                        </div>
                        <div class="text-center text-sm text-gray-600 mt-2">
                            <span id="totalJogos">0</span> jogo(s) adicionado(s)
                        </div>
                    </div>

                    <!-- Bot√µes de Download -->
                    <div class="grid grid-cols-3 gap-2 mb-4">
                        <button id="downloadHTML" class="bg-orange-500 hover:bg-orange-600 text-white px-3 py-2 rounded-lg text-sm">
                            üåê HTML
                        </button>
                        <button id="downloadTXT" class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-2 rounded-lg text-sm">
                            üìÑ TXT
                        </button>
                        <button id="downloadXLSX" class="bg-green-500 hover:bg-green-600 text-white px-3 py-2 rounded-lg text-sm">
                            üìä XLSX
                        </button>
                    </div>

                    <!-- Bot√£o Limpar Todos -->
                    <button id="limparTodos" class="w-full bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg">
                        üóëÔ∏è Limpar Todos os Jogos
                    </button>
                </div>

                <!-- Lista dos Jogos -->
                <div class="bg-white rounded-lg shadow-lg p-6 border-2 border-gray-200 max-h-96 overflow-y-auto">
                    <h4 class="font-bold text-gray-800 mb-4">Lista de Jogos:</h4>
                    <div id="listaJogos">
                        <p class="text-gray-500 text-center py-8">Nenhum jogo adicionado ainda</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal Como Funciona -->
        <div id="modalComoFunciona" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
            <div class="bg-white rounded-lg shadow-lg max-w-4xl w-full mx-4 max-h-screen overflow-y-auto">
                <div class="bg-megasena text-white p-6 rounded-t-lg">
                    <h2 class="text-2xl font-bold text-center">üçÄ Como Funciona o Gerador Mega Sena Completo</h2>
                </div>
                
                <div class="p-6 space-y-6">
                    <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                        <h3 class="text-xl font-bold text-green-800 mb-3">üìã 3 Se√ß√µes Principais de Gera√ß√£o:</h3>
                        <div class="space-y-3 text-green-700">
                            <p><strong>üéÆ SE√á√ÉO 1 - Cria√ß√£o Manual:</strong> Estrat√©gia Par/√çmpar + Edi√ß√£o Manual + Drag & Drop + Grid de Sele√ß√£o</p>
                            <p><strong>üéØ SE√á√ÉO 2 - Regras Minimalistas:</strong> 7 regras matem√°ticas baseadas em dados oficiais do pr√≥ximo sorteio</p>
                            <p><strong>üéØ SE√á√ÉO 3 - An√°lise por Posi√ß√µes:</strong> Identifica n√∫meros atrasados + Grid Estrat√©gica + Palpites Inteligentes</p>
                        </div>
                    </div>

                    <div class="bg-megasena-bg border border-megasena rounded-lg p-4">
                        <h3 class="text-xl font-bold text-megasena mb-3">üéØ Estrat√©gia Minimalista:</h3>
                        <div class="space-y-2 text-gray-700">
                            <p><strong>üìä Conceito:</strong> Utiliza dados oficiais do pr√≥ximo sorteio para gerar dezenas</p>
                            <p><strong>üîß 7 Regras:</strong> R1-Direto, R2-Soma, R3-Dobro, R4-Diferen√ßa, R5-Invers√£o, R6-Vizinhos, R7-Soma Cruzada</p>
                            <p><strong>‚úÖ Flexibilidade:</strong> Escolha quais regras usar, quantidade de jogos e dezenas</p>
                        </div>
                    </div>

                    <div class="bg-orange-50 border border-orange-200 rounded-lg p-4">
                        <h3 class="text-xl font-bold text-orange-800 mb-3">‚öôÔ∏è Sistema de Valores Unificado:</h3>
                        <div class="space-y-2 text-orange-700">
                            <p><strong>üí∞ Configura√ß√£o Central:</strong> Defina o valor da aposta simples (padr√£o R$ 6,00)</p>
                            <p><strong>üîÑ C√°lculo Autom√°tico:</strong> Todos os outros valores s√£o calculados automaticamente</p>
                            <p><strong>üìä Sempre Atualizado:</strong> Mudan√ßa √∫nica atualiza todo o sistema</p>
                        </div>
                    </div>
                </div>
                
                <div class="bg-gray-50 px-6 py-4 rounded-b-lg text-center">
                    <button id="fecharModal" class="bg-megasena hover:bg-megasena-dark text-white font-medium py-2 px-6 rounded-lg">
                        ‚úÖ Entendi, Vamos Jogar!
                    </button>
                </div>
            </div>
        </div>

        <!-- Modal Informa√ß√µes Regras Minimalistas -->
        <div id="modalInfoMinimalista" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
            <div class="bg-white rounded-lg shadow-lg max-w-4xl w-full mx-4 max-h-screen overflow-y-auto">
                <div class="bg-megasena text-white p-6 rounded-t-lg">
                    <h2 class="text-2xl font-bold text-center">üéØ Estrat√©gia Minimalista - Regras Detalhadas</h2>
                </div>
                
                <div class="p-6 space-y-6">
                    <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                        <h3 class="text-xl font-bold text-green-800 mb-3">üìä Como Funciona o M√©todo:</h3>
                        <div class="space-y-3 text-green-700">
                            <p><strong>1. Extra√ß√£o de Dados:</strong> Sistema pega informa√ß√µes oficiais do pr√≥ximo sorteio</p>
                            <p><strong>2. Aplica√ß√£o de Regras:</strong> Aplica regras matem√°ticas simples nos n√∫meros extra√≠dos</p>
                            <p><strong>3. Gera√ß√£o de Dezenas:</strong> Cria dezenas v√°lidas (01-60) baseadas nos c√°lculos</p>
                            <p><strong>4. Valida√ß√£o:</strong> Remove duplicatas e ajusta para a quantidade solicitada</p>
                        </div>
                    </div>

                    <div class="space-y-4">
                        <h3 class="text-xl font-bold text-megasena">üîß Detalhamento das 7 Regras:</h3>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
                                <h4 class="font-bold text-megasena mb-2">R1 - Direto</h4>
                                <p class="text-sm text-gray-700 mb-2"><strong>Conceito:</strong> Usar n√∫meros que aparecem "puros" nos dados</p>
                                <p class="text-xs text-gray-600"><strong>Exemplo:</strong> Data 21/08 ‚Üí dezenas 21, 08</p>
                            </div>

                            <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
                                <h4 class="font-bold text-megasena mb-2">R2 - Soma</h4>
                                <p class="text-sm text-gray-700 mb-2"><strong>Conceito:</strong> Somar dois n√∫meros da base</p>
                                <p class="text-xs text-gray-600"><strong>Exemplo:</strong> 21 + 25 = 46</p>
                            </div>

                            <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
                                <h4 class="font-bold text-megasena mb-2">R3 - Dobro/Multiplica√ß√£o</h4>
                                <p class="text-sm text-gray-700 mb-2"><strong>Conceito:</strong> Dobrar ou multiplicar n√∫meros</p>
                                <p class="text-xs text-gray-600"><strong>Exemplo:</strong> 21 √ó 2 = 42</p>
                            </div>

                            <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
                                <h4 class="font-bold text-megasena mb-2">R4 - Diferen√ßa</h4>
                                <p class="text-sm text-gray-700 mb-2"><strong>Conceito:</strong> Subtrair valores entre si</p>
                                <p class="text-xs text-gray-600"><strong>Exemplo:</strong> 35 - 21 = 14</p>
                            </div>

                            <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
                                <h4 class="font-bold text-megasena mb-2">R5 - Invers√£o</h4>
                                <p class="text-sm text-gray-700 mb-2"><strong>Conceito:</strong> Espelhar n√∫meros</p>
                                <p class="text-xs text-gray-600"><strong>Exemplo:</strong> 25 ‚Üí 52</p>
                            </div>

                            <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
                                <h4 class="font-bold text-megasena mb-2">R6 - Vizinhos</h4>
                                <p class="text-sm text-gray-700 mb-2"><strong>Conceito:</strong> N√∫meros pr√≥ximos</p>
                                <p class="text-xs text-gray-600"><strong>Exemplo:</strong> 35 ‚Üí 34, 36</p>
                            </div>

                            <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
                                <h4 class="font-bold text-megasena mb-2">R7 - Soma Cruzada</h4>
                                <p class="text-sm text-gray-700 mb-2"><strong>Conceito:</strong> Somar elementos da mesma categoria</p>
                                <p class="text-xs text-gray-600"><strong>Exemplo:</strong> Dia + M√™s = 29</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="bg-gray-50 px-6 py-4 rounded-b-lg text-center">
                    <button id="fecharModalMinimalista" class="bg-megasena hover:bg-megasena-dark text-white font-medium py-2 px-6 rounded-lg">
                        ‚úÖ Entendi, Vou Testar!
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // üéØ DADOS DE EXEMPLO PARA FUNCIONAR IMEDIATAMENTE
        const DADOS_EXEMPLO = {
            ultimoResultado: {
                numero: 2903,
                dataApuracao: "20/01/2025",
                dataProximoConcurso: "23/01/2025",
                listaDezenas: ["27", "20", "46", "50", "54", "24"],
                dezenasSorteadasOrdemSorteio: ["27", "20", "46", "50", "54", "24"],
                acumulado: true,
                valorEstimadoProximoConcurso: 65000000.00,
                listaRateioPremio: [
                    { descricaoFaixa: "5 acertos", numeroDeGanhadores: 42, valorPremio: 68250.85 },
                    { descricaoFaixa: "4 acertos", numeroDeGanhadores: 3894, valorPremio: 1425.33 }
                ]
            },
            concursosHistoricos: [
                { numero: 2903, data: "20/01/2025", posicoes: [27, 20, 46, 50, 54, 24] },
                { numero: 2902, data: "18/01/2025", posicoes: [48, 8, 45, 42, 21, 22] },
                { numero: 2901, data: "16/01/2025", posicoes: [2, 38, 28, 20, 47, 44] },
                { numero: 2900, data: "14/01/2025", posicoes: [60, 59, 55, 54, 50, 33] },
                { numero: 2899, data: "11/01/2025", posicoes: [28, 44, 22, 42, 10, 51] },
                { numero: 2898, data: "09/01/2025", posicoes: [32, 38, 30, 48, 14, 23] },
                { numero: 2897, data: "07/01/2025", posicoes: [6, 28, 1, 24, 57, 27] },
                { numero: 2896, data: "04/01/2025", posicoes: [43, 16, 8, 53, 12, 9] },
                { numero: 2895, data: "02/01/2025", posicoes: [44, 56, 9, 52, 11, 51] },
                { numero: 2894, data: "31/12/2024", posicoes: [29, 5, 25, 21, 49, 24] },
                { numero: 2893, data: "28/12/2024", posicoes: [1, 4, 17, 35, 44, 58] },
                { numero: 2892, data: "26/12/2024", posicoes: [15, 18, 26, 44, 54, 24] },
                { numero: 2891, data: "24/12/2024", posicoes: [12, 14, 35, 54, 26, 24] },
                { numero: 2890, data: "21/12/2024", posicoes: [52, 7, 6, 13, 29, 36] },
                { numero: 2889, data: "19/12/2024", posicoes: [12, 26, 40, 16, 29, 16] },
                { numero: 2888, data: "17/12/2024", posicoes: [27, 35, 19, 49, 9, 15] },
                { numero: 2887, data: "14/12/2024", posicoes: [38, 14, 37, 30, 20, 52] },
                { numero: 2886, data: "12/12/2024", posicoes: [35, 33, 59, 55, 2, 20] },
                { numero: 2885, data: "10/12/2024", posicoes: [36, 23, 10, 28, 36, 37] },
                { numero: 2884, data: "07/12/2024", posicoes: [36, 25, 37, 34, 52, 23] },
                { numero: 2883, data: "05/12/2024", posicoes: [54, 57, 60, 43, 49, 10] },
                { numero: 2882, data: "03/12/2024", posicoes: [52, 7, 6, 13, 29, 34] },
                { numero: 2881, data: "30/11/2024", posicoes: [12, 26, 40, 16, 29, 16] },
                { numero: 2880, data: "28/11/2024", posicoes: [27, 35, 19, 49, 9, 15] },
                { numero: 2879, data: "26/11/2024", posicoes: [41, 52, 11, 18, 47, 20] },
                { numero: 2878, data: "23/11/2024", posicoes: [49, 31, 47, 16, 6, 46] },
                { numero: 2877, data: "21/11/2024", posicoes: [13, 37, 54, 20, 15, 37] },
                { numero: 2876, data: "19/11/2024", posicoes: [45, 53, 1, 40, 31, 52] },
                { numero: 2875, data: "16/11/2024", posicoes: [36, 36, 40, 6, 40, 23] },
                { numero: 2874, data: "14/11/2024", posicoes: [1, 54, 52, 3, 1, 20] }
            ]
        };

        // Vari√°veis globais
        let ultimoResultado = null;
        let jogosAdicionados = [];
        let numerosSelecionados = [];
        let numerosSorteados = new Set();
        let quantidadeSelecionada = 6;
        let numerosDropArea = [];
        let concursosHistoricos = [];
        let analisePosicoesCarregada = false;
        let resultadosAnalise = {};
        let palpitesInteligentes = [];
        let numerosEstrategicos = [];
        let categoriasNumeros = {};
        let jogosMinimalistas = [];
        let dadosProximoSorteio = null;
        let valorApostaSimples = 6.00;

        // Sistema de Valores da Mega Sena - Unificado
        const sistemaValores = {
            // Multiplicadores oficiais baseados em combina√ß√£o matem√°tica
            multiplicadores: {
                6: 1,     // Base
                7: 7,     // C(7,6) = 7
                8: 28,    // C(8,6) = 28
                9: 84,    // C(9,6) = 84
                10: 210,  // C(10,6) = 210
                11: 462,  // C(11,6) = 462
                12: 924,  // C(12,6) = 924
                13: 1716, // C(13,6) = 1716
                14: 3003, // C(14,6) = 3003
                15: 5005, // C(15,6) = 5005
                16: 8008, // C(16,6) = 8008
                17: 12376, // C(17,6) = 12376
                18: 18564, // C(18,6) = 18564
                19: 27132, // C(19,6) = 27132
                20: 38760  // C(20,6) = 38760
            },
            
            obterValor: function(quantidade) {
                const multiplicador = this.multiplicadores[quantidade] || 1;
                return valorApostaSimples * multiplicador;
            },
            
            atualizarTodosValores: function() {
                // Atualizar select de quantidade de dezenas
                this.atualizarSelectQuantidade();
                
                // Atualizar select de dezenas minimalistas
                this.atualizarSelectMinimalista();
                
                // Atualizar tabela de probabilidades
                this.atualizarTabelaProbabilidades();
                
                // Atualizar visualiza√ß√£o dos jogos
                atualizarVisualizacaoJogos();
                atualizarCustoTotal();
                
                // Atualizar status
                this.atualizarStatus();
            },
            
            atualizarSelectQuantidade: function() {
                const select = document.getElementById('quantidadeDezenas');
                if (!select) return;
                
                select.innerHTML = '';
                for (let i = 6; i <= 20; i++) {
                    const option = document.createElement('option');
                    option.value = i;
                    option.textContent = `${i} dezenas - ${formatarMoeda(this.obterValor(i))}`;
                    select.appendChild(option);
                }
            },
            
            atualizarSelectMinimalista: function() {
                const select = document.getElementById('dezenasMinimalista');
                if (!select) return;
                
                select.innerHTML = '';
                for (let i = 6; i <= 15; i++) {
                    const option = document.createElement('option');
                    option.value = i;
                    option.textContent = `${i} dezenas - ${formatarMoeda(this.obterValor(i))}`;
                    if (i === 6) option.selected = true;
                    select.appendChild(option);
                }
            },
            
            atualizarTabelaProbabilidades: function() {
                const tbody = document.getElementById('tabelaProbabilidades');
                if (!tbody) return;
                
                tbody.innerHTML = '';
                const dezenas = [6, 7, 8, 9, 10, 15, 20];
                
                dezenas.forEach((dez, index) => {
                    const tr = document.createElement('tr');
                    if (index % 2 === 1) tr.className = 'bg-gray-50';
                    
                    tr.innerHTML = `
                        <td class="p-1">${dez}</td>
                        <td class="p-1 text-right">${formatarMoeda(this.obterValor(dez))}</td>
                        <td class="p-1 text-right">${this.obterProbabilidadeSena(dez)}</td>
                        <td class="p-1 text-right">${this.obterProbabilidadeQuina(dez)}</td>
                        <td class="p-1 text-right">${this.obterProbabilidadeQuadra(dez)}</td>
                    `;
                    tbody.appendChild(tr);
                });
            },
            
            obterProbabilidadeSena: function(dezenas) {
                const probabilidades = {
                    6: '50.063.860', 7: '7.151.980', 8: '1.787.995', 9: '595.998', 10: '238.399',
                    11: '108.363', 12: '54.182', 13: '29.175', 14: '16.671', 15: '10.003',
                    16: '6.252', 17: '4.045', 18: '2.697', 19: '1.845', 20: '1.292'
                };
                return probabilidades[dezenas] || 'N/A';
            },
            
            obterProbabilidadeQuina: function(dezenas) {
                const probabilidades = {
                    6: '154.518', 7: '44.981', 8: '17.192', 9: '7.791', 10: '3.973',
                    11: '2.211', 12: '1.317', 13: '828', 14: '544', 15: '370',
                    16: '260', 17: '188', 18: '139', 19: '105', 20: '81'
                };
                return probabilidades[dezenas] || 'N/A';
            },
            
            obterProbabilidadeQuadra: function(dezenas) {
                const probabilidades = {
                    6: '2.332', 7: '1.038', 8: '539', 9: '312', 10: '195',
                    11: '129', 12: '90', 13: '65', 14: '48', 15: '37',
                    16: '29', 17: '23', 18: '19', 19: '16', 20: '13'
                };
                return probabilidades[dezenas] || 'N/A';
            },
            
            atualizarStatus: function() {
                const now = new Date();
                document.getElementById('statusSistema').textContent = '‚úÖ Sistema atualizado';
                document.getElementById('ultimaAtualizacao').textContent = now.toLocaleTimeString('pt-BR');
                
                // Atualizar valores de exemplo
                document.getElementById('mult7').textContent = `${this.multiplicadores[7]}x`;
                document.getElementById('valor7').textContent = formatarMoeda(this.obterValor(7));
                document.getElementById('mult8').textContent = `${this.multiplicadores[8]}x`;
                document.getElementById('valor8').textContent = formatarMoeda(this.obterValor(8));
                document.getElementById('mult15').textContent = `${this.multiplicadores[15]}x`;
                document.getElementById('valor15').textContent = formatarMoeda(this.obterValor(15));
            }
        };

        // üéØ REGRAS MINIMALISTAS
        const regrasMinimalistas = {
            definicoes: {
                1: {
                    nome: "R1 - Direto",
                    descricao: "Usar n√∫meros que aparecem puros nos dados (dia, m√™s, concurso, pr√™mio)",
                    exemplo: "Data 21/08 ‚Üí dezenas 21, 08. Concurso 2904 ‚Üí dezenas 29, 04, 02"
                },
                2: {
                    nome: "R2 - Soma",
                    descricao: "Somar dois n√∫meros da base extra√≠da",
                    exemplo: "21 (dia) + 25 (ano) = 46. 35 (pr√™mio) + 8 (m√™s) = 43"
                },
                3: {
                    nome: "R3 - Dobro/Multiplica√ß√£o",
                    descricao: "Dobrar ou multiplicar n√∫meros da base (m√°ximo ‚â§60)",
                    exemplo: "21 √ó 2 = 42. 25 √ó 2 = 50 (se ‚â§60)"
                },
                4: {
                    nome: "R4 - Diferen√ßa",
                    descricao: "Subtrair valores entre si",
                    exemplo: "35 (pr√™mio) - 21 (dia) = 14. 65 (pr√™mio) - 19 (dia) = 46"
                },
                5: {
                    nome: "R5 - Invers√£o",
                    descricao: "Espelhar n√∫meros de dois d√≠gitos",
                    exemplo: "25 ‚Üí 52. 35 ‚Üí 53. 21 ‚Üí 12"
                },
                6: {
                    nome: "R6 - Vizinhos",
                    descricao: "Aproximar para n√∫meros pr√≥ximos (¬±1, ¬±2)",
                    exemplo: "35 ‚Üí 34, 36. 21 ‚Üí 20, 22"
                },
                7: {
                    nome: "R7 - Soma Cruzada",
                    descricao: "Somar elementos da mesma categoria",
                    exemplo: "Dia + M√™s = 21 + 8 = 29. D√≠gitos do pr√™mio = 3 + 5 = 8"
                }
            }
        };

        // Inicializa√ß√£o da aplica√ß√£o
        document.addEventListener('DOMContentLoaded', async () => {
            // Inicializar sistema de valores
            sistemaValores.atualizarTodosValores();
            
            const timeoutPromise = new Promise((_, reject) => 
                setTimeout(() => reject(new Error('Timeout')), 3000)
            );
            
            try {
                await Promise.race([carregarUltimoResultado(), timeoutPromise]);
            } catch (error) {
                console.log('‚ö†Ô∏è API indispon√≠vel, usando dados de exemplo');
                usarDadosExemplo();
            }
            
            inicializarInterface();
            configurarEventListeners();
        });

        // üöÄ Fun√ß√£o para carregar √∫ltimo resultado
        async function carregarUltimoResultado() {
            document.getElementById('loadingDetails').textContent = 'Conectando com API da Caixa Econ√¥mica Federal...';
            
            try {
                const controller = new AbortController();
                const timeoutId = setTimeout(() => controller.abort(), 2000);
                
                const response = await fetch('https://servicebus2.caixa.gov.br/portaldeloterias/api/megasena', {
                    signal: controller.signal,
                    headers: {
                        'Accept': 'application/json'
                    }
                });
                
                clearTimeout(timeoutId);
                
                if (response.ok) {
                    const data = await response.json();
                    if (data && data.numero && data.numero > 0) {
                        document.getElementById('loadingDetails').textContent = `‚úÖ Concurso ${data.numero} encontrado!`;
                        ultimoResultado = data;
                        exibirUltimoResultado(data);
                        atualizarDadosProximoSorteio(data);
                        finalizarCarregamento();
                        return;
                    }
                }
                
                throw new Error('API n√£o retornou dados v√°lidos');
                
            } catch (error) {
                console.log('‚ùå Erro na API:', error.message);
                throw error;
            }
        }

        // üéØ Usar dados de exemplo quando API falha
        function usarDadosExemplo() {
            document.getElementById('loadingDetails').textContent = '‚ö†Ô∏è API indispon√≠vel. Usando dados de exemplo...';
            
            setTimeout(() => {
                ultimoResultado = DADOS_EXEMPLO.ultimoResultado;
                concursosHistoricos = DADOS_EXEMPLO.concursosHistoricos;
                analisePosicoesCarregada = true;
                
                exibirUltimoResultado(ultimoResultado);
                atualizarDadosProximoSorteio(ultimoResultado);
                finalizarCarregamento();
                
                document.getElementById('loadingDetails').textContent = '‚úÖ Dados de exemplo carregados! Funcionalidade completa dispon√≠vel.';
            }, 1000);
        }

        function finalizarCarregamento() {
            setTimeout(() => {
                document.getElementById('loading').classList.add('hidden');
                document.getElementById('ultimoResultado').classList.remove('hidden');
                document.getElementById('interfacePrincipal').classList.remove('hidden');
            }, 500);
        }

        // üéØ ATUALIZAR DADOS DO PR√ìXIMO SORTEIO PARA REGRAS MINIMALISTAS
        function atualizarDadosProximoSorteio(data) {
            dadosProximoSorteio = {
                numero: data.numero + 1,
                data: data.dataProximoConcurso || '23/01/2025',
                premio: data.valorEstimadoProximoConcurso || 65000000
            };
            
            const dadosDiv = document.getElementById('dadosProximoSorteio');
            dadosDiv.innerHTML = `
                <strong>Concurso ${dadosProximoSorteio.numero}</strong><br>
                <strong>Data:</strong> ${dadosProximoSorteio.data}<br>
                <strong>Pr√™mio:</strong> ${formatarMoeda(dadosProximoSorteio.premio)}
            `;
        }

        function exibirUltimoResultado(data) {
            const numeros = data.listaDezenas || data.dezenasSorteadasOrdemSorteio || [];
            
            document.getElementById('tituloResultado').textContent = `Concurso ${data.numero}`;
            document.getElementById('dataResultado').textContent = `üìÖ ${data.dataApuracao}`;

            const numerosDiv = document.getElementById('numerosResultado');
            numerosDiv.innerHTML = '';
            numeros.forEach(num => {
                const numeroEl = document.createElement('div');
                numeroEl.className = 'numero-resultado';
                numeroEl.textContent = num;
                numerosDiv.appendChild(numeroEl);
            });

            document.getElementById('statusResultado').textContent = data.acumulado ? 'ACUMULOU!' : 'TEVE GANHADOR!';

            if (data.listaRateioPremio && data.listaRateioPremio.length >= 2) {
                document.getElementById('premiacao5').innerHTML = `
                    <span class="text-megasena mr-2">üèÜ</span>
                    <span>5 acertos: ${data.listaRateioPremio[0].numeroDeGanhadores} apostas ganhadoras - ${formatarMoeda(data.listaRateioPremio[0].valorPremio)}</span>
                `;
                document.getElementById('premiacao4').innerHTML = `
                    <span class="text-megasena mr-2">üèÜ</span>
                    <span>4 acertos: ${data.listaRateioPremio[1].numeroDeGanhadores} apostas ganhadoras - ${formatarMoeda(data.listaRateioPremio[1].valorPremio)}</span>
                `;
            }

            document.getElementById('proximoConcurso').textContent = `Concurso ${data.numero + 1}`;
            document.getElementById('dataProximoConcurso').textContent = data.dataProximoConcurso || 'A definir';
            document.getElementById('premioEstimado').textContent = `Pr√™mio Estimado: ${formatarMoeda(data.valorEstimadoProximoConcurso || 65000000)}`;

            analisarParesImparesTempoReal(numeros);
            identificarNumerosSorteados(numeros);
        }

        function analisarParesImparesTempoReal(numeros) {
            let paresUltimoSorteio = 0;
            let imparesUltimoSorteio = 0;
            
            numeros.forEach(num => {
                const numero = parseInt(num);
                if (numero % 2 === 0) {
                    paresUltimoSorteio++;
                } else {
                    imparesUltimoSorteio++;
                }
            });
            
            window.paresUltimoSorteio = paresUltimoSorteio;
            window.imparesUltimoSorteio = imparesUltimoSorteio;
            
            document.getElementById('paresUltimoSorteio').textContent = paresUltimoSorteio;
            document.getElementById('imparesUltimoSorteio').textContent = imparesUltimoSorteio;
            document.getElementById('metaPares').textContent = 3; // Padr√£o hist√≥rico mais comum
            document.getElementById('metaImpares').textContent = 3; // Padr√£o hist√≥rico mais comum
            
            const dicaEl = document.getElementById('dicaEstrategia');
            dicaEl.innerHTML = `üí° <strong>Estrat√©gia Hist√≥rica:</strong> Padr√£o mais comum √© 3P/3I (30.6% dos casos). √öltimo sorteio: ${paresUltimoSorteio}P/${imparesUltimoSorteio}I`;
            
            atualizarContadorParesImpares();
        }

        function identificarNumerosSorteados(numeros) {
            numerosSorteados.clear();
            numeros.forEach(num => {
                numerosSorteados.add(parseInt(num));
            });
            
            if (numerosSorteados.size > 0) {
                exibirControleNumerosSorteados();
                atualizarEstadoNumerosSorteados();
            }
        }

        function exibirControleNumerosSorteados() {
            const controle = document.getElementById('controleNumerosSorteados');
            const lista = document.getElementById('numerosSorteadosLista');
            
            const numerosArray = Array.from(numerosSorteados).sort((a, b) => a - b);
            lista.textContent = numerosArray.map(n => n.toString().padStart(2, '0')).join(', ');
            
            controle.classList.remove('hidden');
        }

        function atualizarEstadoNumerosSorteados() {
            const permitir = document.getElementById('permitirNumerosSorteados').checked;
            
            numerosSorteados.forEach(numero => {
                const btn = document.querySelector(`.numero-mega:nth-child(${numero})`);
                if (btn) {
                    btn.classList.add('sorteado');
                    
                    if (permitir) {
                        btn.classList.remove('disabled');
                        btn.onclick = () => toggleNumero(numero);
                    } else {
                        btn.classList.add('disabled');
                        btn.onclick = () => {
                            showCustomAlert('üéØ N√∫mero Sorteado', `O n√∫mero ${numero.toString().padStart(2, '0')} saiu no √∫ltimo sorteio. Marque "Permitir usar n√∫meros j√° sorteados" para selecion√°-lo.`);
                        };
                    }
                }
            });
        }

        function inicializarInterface() {
            numerosSelecionados = [];
            numerosDropArea = [];
            numerosEstrategicos = [];
            criarGridNumeros();
            configurarDragAndDrop();
            atualizarContadorParesImpares();
            atualizarVisualizacaoDropArea();
        }

        function criarGridNumeros() {
            const grid = document.getElementById('gridNumeros');
            grid.innerHTML = '';
            
            for (let i = 1; i <= 60; i++) {
                const btn = document.createElement('button');
                btn.className = 'numero-mega';
                
                if (i % 2 === 0) {
                    btn.classList.add('par');
                } else {
                    btn.classList.add('impar');
                }
                
                btn.textContent = i.toString().padStart(2, '0');
                btn.onclick = () => toggleNumero(i);
                btn.draggable = true;
                btn.dataset.numero = i;
                
                btn.addEventListener('dragstart', (e) => {
                    e.dataTransfer.setData('text/plain', i);
                    btn.classList.add('dragging');
                });
                
                btn.addEventListener('dragend', () => {
                    btn.classList.remove('dragging');
                });
                
                grid.appendChild(btn);
            }
        }

        // üéØ FUNCIONALIDADE: Configurar Drag and Drop
        function configurarDragAndDrop() {
            const dropZone = document.getElementById('dropZone');
            
            dropZone.addEventListener('dragover', (e) => {
                e.preventDefault();
                dropZone.classList.add('drag-over');
            });
            
            dropZone.addEventListener('dragleave', (e) => {
                if (!dropZone.contains(e.relatedTarget)) {
                    dropZone.classList.remove('drag-over');
                }
            });
            
            dropZone.addEventListener('drop', (e) => {
                e.preventDefault();
                dropZone.classList.remove('drag-over');
                
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    processarArquivosTxt(files);
                } else {
                    const numero = parseInt(e.dataTransfer.getData('text/plain'));
                    if (!isNaN(numero)) {
                        adicionarNumeroDropArea(numero);
                    }
                }
            });
        }

        function processarArquivosTxt(files) {
            const arquivosTxt = Array.from(files).filter(file => 
                file.type === 'text/plain' || file.name.toLowerCase().endsWith('.txt')
            );
            
            if (arquivosTxt.length === 0) {
                showCustomAlert('‚ö†Ô∏è Arquivo Inv√°lido', 'Por favor, arraste apenas arquivos .txt com n√∫meros da Mega Sena!');
                return;
            }
            
            const arquivo = arquivosTxt[0];
            const reader = new FileReader();
            
            reader.onload = function(e) {
                const conteudo = e.target.result;
                if (conteudo && conteudo.trim()) {
                    const linhas = conteudo.split(/\r?\n/).filter(linha => linha.trim().length > 0);
                    
                    if (linhas.length > 1) {
                        mostrarModalArquivoTxt(arquivo.name, linhas);
                    } else if (linhas.length === 1) {
                        document.getElementById('editarNumeros').value = linhas[0];
                        processarJogoUnico(linhas[0]);
                    }
                } else {
                    showCustomAlert('‚ùå Erro', 'Arquivo vazio ou inv√°lido!');
                }
            };
            
            reader.onerror = function() {
                showCustomAlert('‚ùå Erro', 'Erro ao ler o arquivo. Tente novamente.');
            };
            
            reader.readAsText(arquivo);
        }

        function mostrarModalArquivoTxt(nomeArquivo, linhas) {
            const jogosValidados = [];
            const erros = [];
            
            linhas.forEach((linha, index) => {
                const numerosDaLinha = linha.trim().match(/\d+/g);
                
                if (!numerosDaLinha) {
                    erros.push(`Linha ${index + 1}: Nenhum n√∫mero encontrado`);
                    return;
                }
                
                const numerosValidos = numerosDaLinha
                    .map(n => parseInt(n))
                    .filter(n => n >= 1 && n <= 60)
                    .filter((n, idx, arr) => arr.indexOf(n) === idx);
                
                if (numerosValidos.length < 6 || numerosValidos.length > 20) {
                    erros.push(`Linha ${index + 1}: ${numerosValidos.length} n√∫meros (deve ter entre 6 e 20)`);
                    return;
                }
                
                if (!sistemaValores.multiplicadores[numerosValidos.length]) {
                    erros.push(`Linha ${index + 1}: ${numerosValidos.length} dezenas n√£o √© uma quantidade v√°lida`);
                    return;
                }
                
                jogosValidados.push({
                    numeros: numerosValidos.sort((a, b) => a - b),
                    quantidade: numerosValidos.length,
                    linha: index + 1
                });
            });
            
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
            modal.innerHTML = `
                <div class="bg-white p-6 rounded-lg shadow-lg max-w-lg w-full mx-4 max-h-96 overflow-y-auto">
                    <h3 class="font-bold text-megasena mb-4">üìÅ Arquivo TXT Detectado</h3>
                    <p class="text-gray-700 mb-4">
                        <strong>Arquivo:</strong> ${nomeArquivo}<br>
                        <strong>Linhas processadas:</strong> ${linhas.length}<br>
                        <strong>Jogos v√°lidos:</strong> ${jogosValidados.length}
                    </p>
                    
                    ${erros.length > 0 ? `
                        <div class="bg-red-50 border border-red-200 rounded p-3 mb-4">
                            <h4 class="font-bold text-red-800 mb-2">‚ö†Ô∏è Erros encontrados:</h4>
                            <div class="text-sm text-red-700 space-y-1 max-h-24 overflow-y-auto">
                                ${erros.map(erro => `<div>‚Ä¢ ${erro}</div>`).join('')}
                            </div>
                        </div>
                    ` : ''}
                    
                    ${jogosValidados.length > 0 ? `
                        <div class="bg-gray-50 p-3 rounded mb-4 text-sm space-y-1 max-h-40 overflow-y-auto">
                            <h4 class="font-bold text-gray-800 mb-2">‚úÖ Jogos v√°lidos encontrados:</h4>
                            ${jogosValidados.map(jogo => 
                                `<div><strong>Linha ${jogo.linha}:</strong> ${jogo.numeros.map(n => n.toString().padStart(2, '0')).join(' ')} (${jogo.quantidade} dezenas)</div>`
                            ).join('')}
                        </div>
                        <div class="text-sm text-blue-800 bg-blue-50 p-3 rounded mb-4">
                            <strong>Total estimado:</strong> ${formatarMoeda(jogosValidados.reduce((sum, jogo) => sum + sistemaValores.obterValor(jogo.quantidade), 0))}
                        </div>
                    ` : ''}
                    
                    <div class="flex justify-end space-x-3">
                        <button id="cancelarArquivo" class="px-4 py-2 text-gray-600 hover:bg-gray-100 rounded">Cancelar</button>
                        ${jogosValidados.length > 0 ? `
                            <button id="confirmarArquivo" class="px-4 py-2 bg-megasena text-white hover:bg-megasena-dark rounded">
                                ‚ûï Adicionar ${jogosValidados.length} Jogo(s)
                            </button>
                        ` : ''}
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
            
            document.getElementById('cancelarArquivo').onclick = () => {
                document.body.removeChild(modal);
            };
            
            if (jogosValidados.length > 0) {
                document.getElementById('confirmarArquivo').onclick = () => {
                    jogosValidados.forEach(jogoData => {
                        const jogo = {
                            id: Date.now() + Math.random(),
                            numeros: jogoData.numeros,
                            quantidade: jogoData.quantidade,
                            custo: sistemaValores.obterValor(jogoData.quantidade),
                            digitosDiferentes: calcularDigitosDiferentes(jogoData.numeros),
                            pares: jogoData.numeros.filter(n => n % 2 === 0).length,
                            impares: jogoData.numeros.filter(n => n % 2 !== 0).length,
                            origem: 'Arquivo TXT'
                        };
                        jogosAdicionados.push(jogo);
                    });
                    
                    atualizarVisualizacaoJogos();
                    atualizarCustoTotal();
                    
                    document.body.removeChild(modal);
                    showCustomAlert('‚úÖ Sucesso', `${jogosValidados.length} jogo(s) adicionado(s) do arquivo ${nomeArquivo}!`);
                };
            }
        }

        function adicionarNumeroDropArea(numero) {
            const quantidadePermitida = parseInt(document.getElementById('quantidadeDezenas').value);
            
            if (!numerosDropArea.includes(numero) && numerosDropArea.length < quantidadePermitida) {
                numerosDropArea.push(numero);
                atualizarVisualizacaoDropArea();
                
                if (!numerosSelecionados.includes(numero)) {
                    numerosSelecionados.push(numero);
                    const btn = document.querySelector(`.numero-mega:nth-child(${numero})`);
                    if (btn) btn.classList.add('selecionado');
                }
                
                atualizarContadorParesImpares();
                validarBotaoAdicionar();
            }
        }

        function removerNumeroDropArea(numero) {
            numerosDropArea = numerosDropArea.filter(n => n !== numero);
            numerosSelecionados = numerosSelecionados.filter(n => n !== numero);
            
            const btn = document.querySelector(`.numero-mega:nth-child(${numero})`);
            if (btn) btn.classList.remove('selecionado');
            
            atualizarVisualizacaoDropArea();
            atualizarContadorParesImpares();
            validarBotaoAdicionar();
        }

        function atualizarVisualizacaoDropArea() {
            const dropZone = document.getElementById('dropZone');
            const dropMessage = document.getElementById('dropMessage');
            const numerosDropped = document.getElementById('numerosDropped');
            const numerosNaArea = document.getElementById('numerosNaArea');
            const quantidadeEspecificada = document.getElementById('quantidadeEspecificada');
            
            if (!dropZone || !numerosNaArea || !quantidadeEspecificada) {
                return;
            }
            
            if (!Array.isArray(numerosDropArea)) {
                numerosDropArea = [];
            }
            
            const quantidadeSelect = document.getElementById('quantidadeDezenas');
            const quantidadeAtual = quantidadeSelect ? parseInt(quantidadeSelect.value) || 6 : 6;
            
            quantidadeEspecificada.textContent = quantidadeAtual.toString();
            numerosNaArea.textContent = numerosDropArea.length.toString();
            
            if (numerosDropArea.length === 0) {
                dropZone.classList.remove('has-numbers');
                if (dropMessage) dropMessage.classList.remove('hidden');
                if (numerosDropped) numerosDropped.classList.add('hidden');
            } else {
                dropZone.classList.add('has-numbers');
                if (dropMessage) dropMessage.classList.add('hidden');
                if (numerosDropped) {
                    numerosDropped.classList.remove('hidden');
                    
                    numerosDropped.innerHTML = numerosDropArea
                        .filter(numero => numero && typeof numero === 'number')
                        .sort((a, b) => a - b)
                        .map(numero => `
                            <div class="numero-drop">
                                ${numero.toString().padStart(2, '0')}
                                <div class="remove-btn" onclick="removerNumeroDropArea(${numero})">√ó</div>
                            </div>
                        `).join('');
                }
            }
        }

        function toggleNumero(numero) {
            const btn = document.querySelector(`.numero-mega:nth-child(${numero})`);
            const maxSelecionados = parseInt(document.getElementById('quantidadeDezenas').value);
            
            if (numerosSelecionados.includes(numero)) {
                numerosSelecionados = numerosSelecionados.filter(n => n !== numero);
                numerosDropArea = numerosDropArea.filter(n => n !== numero);
                btn.classList.remove('selecionado');
            } else if (numerosSelecionados.length < maxSelecionados) {
                numerosSelecionados.push(numero);
                if (!numerosDropArea.includes(numero)) {
                    numerosDropArea.push(numero);
                }
                btn.classList.add('selecionado');
            }
            
            atualizarVisualizacaoDropArea();
            atualizarContadorParesImpares();
            validarBotaoAdicionar();
        }

        // üéØ APLICAR N√öMEROS DIGITADOS MANUALMENTE
        function aplicarNumerosDigitados() {
            const input = document.getElementById('editarNumeros');
            const texto = input.value.trim();
            
            if (!texto) {
                showCustomAlert('‚ö†Ô∏è Campo Vazio', 'Digite alguns n√∫meros primeiro!');
                return;
            }
            
            const linhas = texto.split(/\r?\n/).filter(linha => linha.trim().length > 0);
            
            if (linhas.length > 1) {
                processarMultiplosJogos(linhas);
            } else {
                processarJogoUnico(texto);
            }
        }

        function processarMultiplosJogos(linhas) {
            const jogosValidados = [];
            const erros = [];
            
            linhas.forEach((linha, index) => {
                const numerosDaLinha = linha.trim().match(/\d+/g);
                
                if (!numerosDaLinha) {
                    erros.push(`Linha ${index + 1}: Nenhum n√∫mero encontrado`);
                    return;
                }
                
                const numerosValidos = numerosDaLinha
                    .map(n => parseInt(n))
                    .filter(n => n >= 1 && n <= 60)
                    .filter((n, idx, arr) => arr.indexOf(n) === idx);
                
                if (numerosValidos.length < 6 || numerosValidos.length > 20) {
                    erros.push(`Linha ${index + 1}: ${numerosValidos.length} n√∫meros (deve ter entre 6 e 20)`);
                    return;
                }
                
                if (!sistemaValores.multiplicadores[numerosValidos.length]) {
                    erros.push(`Linha ${index + 1}: ${numerosValidos.length} dezenas n√£o √© uma quantidade v√°lida`);
                    return;
                }
                
                jogosValidados.push({
                    numeros: numerosValidos.sort((a, b) => a - b),
                    quantidade: numerosValidos.length,
                    linha: index + 1
                });
            });
            
            if (erros.length > 0) {
                showCustomAlert('‚ùå Erros Encontrados', `Encontrados ${erros.length} erro(s):\n${erros.join('\n')}`);
                return;
            }
            
            if (jogosValidados.length === 0) {
                showCustomAlert('‚ùå Erro', 'Nenhum jogo v√°lido encontrado!');
                return;
            }
            
            showCustomConfirm(
                `üéØ M√∫ltiplos Jogos Detectados\n\nEncontrados ${jogosValidados.length} jogos v√°lidos.\nDeseja adicion√°-los todos?`,
                () => {
                    jogosValidados.forEach(jogoData => {
                        const jogo = {
                            id: Date.now() + Math.random(),
                            numeros: jogoData.numeros,
                            quantidade: jogoData.quantidade,
                            custo: sistemaValores.obterValor(jogoData.quantidade),
                            digitosDiferentes: calcularDigitosDiferentes(jogoData.numeros),
                            pares: jogoData.numeros.filter(n => n % 2 === 0).length,
                            impares: jogoData.numeros.filter(n => n % 2 !== 0).length,
                            origem: 'Edi√ß√£o Manual'
                        };
                        jogosAdicionados.push(jogo);
                    });
                    
                    document.getElementById('editarNumeros').value = '';
                    limparSelecao();
                    atualizarVisualizacaoJogos();
                    atualizarCustoTotal();
                    
                    showCustomAlert('‚úÖ Sucesso', `${jogosValidados.length} jogo(s) adicionado(s) com sucesso!`);
                }
            );
        }

        function processarJogoUnico(texto) {
            const numerosTexto = texto.match(/\d+/g);
            if (!numerosTexto) {
                showCustomAlert('‚ùå Erro', 'Nenhum n√∫mero v√°lido encontrado!');
                return;
            }
            
            const numerosValidos = numerosTexto
                .map(n => parseInt(n))
                .filter(n => n >= 1 && n <= 60)
                .filter((n, index, arr) => arr.indexOf(n) === index);
            
            if (numerosValidos.length === 0) {
                showCustomAlert('‚ùå Erro', 'Nenhum n√∫mero v√°lido (01-60) encontrado!');
                return;
            }
            
            if (numerosValidos.length >= 6 && numerosValidos.length <= 20 && sistemaValores.multiplicadores[numerosValidos.length]) {
                document.getElementById('quantidadeDezenas').value = numerosValidos.length;
                quantidadeSelecionada = numerosValidos.length;
                
                showCustomAlert('‚úÖ Ajuste Autom√°tico', `Quantidade ajustada automaticamente para ${numerosValidos.length} dezenas!`);
            }
            
            const quantidadePermitida = parseInt(document.getElementById('quantidadeDezenas').value);
            if (numerosValidos.length > quantidadePermitida) {
                showCustomAlert('‚ö†Ô∏è Aviso', `Voc√™ digitou ${numerosValidos.length} n√∫meros, mas selecionou ${quantidadePermitida} dezenas. Os primeiros ${quantidadePermitida} ser√£o usados.`);
            }
            
            limparSelecao();
            
            const numerosParaAplicar = numerosValidos.slice(0, quantidadePermitida);
            numerosParaAplicar.forEach(numero => {
                numerosSelecionados.push(numero);
                numerosDropArea.push(numero);
                const btn = document.querySelector(`.numero-mega:nth-child(${numero})`);
                if (btn) btn.classList.add('selecionado');
            });
            
            document.getElementById('editarNumeros').value = '';
            
            atualizarVisualizacaoDropArea();
            atualizarContadorParesImpares();
            validarBotaoAdicionar();
            
            showCustomAlert('‚úÖ Sucesso', `${numerosParaAplicar.length} n√∫meros aplicados com sucesso!`);
        }

        function atualizarContadorParesImpares() {
            const paresAtuais = numerosSelecionados.filter(num => num % 2 === 0).length;
            const imparesAtuais = numerosSelecionados.filter(num => num % 2 !== 0).length;
            
            document.getElementById('paresAtuais').textContent = paresAtuais;
            document.getElementById('imparesAtuais').textContent = imparesAtuais;
            
            document.getElementById('paresAtuais').classList.add('contador-destaque');
            document.getElementById('imparesAtuais').classList.add('contador-destaque');
            
            setTimeout(() => {
                document.getElementById('paresAtuais').classList.remove('contador-destaque');
                document.getElementById('imparesAtuais').classList.remove('contador-destaque');
            }, 500);
            
            const totalSelecionados = numerosSelecionados.length;
            const statusEl = document.getElementById('statusEstrategia');
            const metaPares = 3; // Padr√£o hist√≥rico mais comum
            const metaImpares = 3; // Padr√£o hist√≥rico mais comum
            
            if (totalSelecionados === 0) {
                statusEl.textContent = 'üéØ Selecione n√∫meros para ver sua estrat√©gia';
                statusEl.className = 'text-center p-3 rounded-lg font-bold text-lg bg-gray-100 text-gray-700';
            } else if (totalSelecionados < 6) {
                const paresRestantes = Math.max(0, metaPares - paresAtuais);
                const imparesRestantes = Math.max(0, metaImpares - imparesAtuais);
                
                if (paresRestantes > 0 && imparesRestantes > 0) {
                    statusEl.textContent = `üìç Faltam: ${paresRestantes} pares, ${imparesRestantes} √≠mpares`;
                    statusEl.className = 'text-center p-3 rounded-lg font-bold text-lg bg-blue-100 text-blue-800';
                } else if (paresRestantes > 0) {
                    statusEl.textContent = `üìç Faltam: ${paresRestantes} pares`;
                    statusEl.className = 'text-center p-3 rounded-lg font-bold text-lg bg-green-100 text-green-800';
                } else if (imparesRestantes > 0) {
                    statusEl.textContent = `üìç Faltam: ${imparesRestantes} √≠mpares`;
                    statusEl.className = 'text-center p-3 rounded-lg font-bold text-lg bg-purple-100 text-purple-800';
                } else {
                    statusEl.textContent = '‚úÖ Estrat√©gia hist√≥rica completa! Continue selecionando...';
                    statusEl.className = 'text-center p-3 rounded-lg font-bold text-lg bg-yellow-100 text-yellow-800';
                }
            } else {
                const diferencaPares = Math.abs(paresAtuais - metaPares);
                const diferencaImpares = Math.abs(imparesAtuais - metaImpares);
                
                if (diferencaPares === 0 && diferencaImpares === 0) {
                    statusEl.textContent = 'üéØ ESTRAT√âGIA PERFEITA! Distribui√ß√£o igual ao padr√£o hist√≥rico mais comum';
                    statusEl.className = 'text-center p-3 rounded-lg font-bold text-lg bg-green-200 text-green-800 meta-atingida';
                } else if (diferencaPares <= 1 && diferencaImpares <= 1) {
                    statusEl.textContent = '‚úÖ Estrat√©gia muito boa! Distribui√ß√£o pr√≥xima do padr√£o hist√≥rico';
                    statusEl.className = 'text-center p-3 rounded-lg font-bold text-lg bg-green-100 text-green-800';
                } else {
                    statusEl.textContent = '‚ö†Ô∏è Estrat√©gia diferente do padr√£o hist√≥rico mais comum';
                    statusEl.className = 'text-center p-3 rounded-lg font-bold text-lg bg-red-100 text-red-800 meta-excedida';
                }
            }
            
            atualizarAnaliseJogo();
        }

        function atualizarAnaliseJogo() {
            document.getElementById('dezenasCount').textContent = numerosSelecionados.length;
            
            const digitos = new Set();
            numerosSelecionados.forEach(num => {
                const numStr = num.toString().padStart(2, '0');
                for (let digit of numStr) {
                    digitos.add(parseInt(digit));
                }
            });
            
            document.getElementById('digitosCount').textContent = digitos.size;
            
            const ultimoDigitos = window.digitosUltimoSorteio || 6;
            const sugestaoEl = document.getElementById('sugestaoDigitos');
            const digitosAtuais = digitos.size;
            
            let sugestao = `üìä <strong>√öltimo sorteio:</strong> ${ultimoDigitos} d√≠gitos diferentes. `;
            
            if (digitosAtuais === 0) {
                sugestao += `Tente usar entre ${ultimoDigitos - 1} e ${ultimoDigitos + 1} d√≠gitos.`;
            } else {
                if (digitosAtuais < ultimoDigitos - 1) {
                    sugestao += `Atual: ${digitosAtuais} (baixo) üìâ`;
                } else if (digitosAtuais === ultimoDigitos - 1 || digitosAtuais === ultimoDigitos || digitosAtuais === ultimoDigitos + 1) {
                    sugestao += `Atual: ${digitosAtuais} (√≥timo) ‚úÖ`;
                } else {
                    sugestao += `Atual: ${digitosAtuais} (alto) üìà`;
                }
            }
            
            sugestaoEl.innerHTML = sugestao;
        }

        function validarBotaoAdicionar() {
            const btn = document.getElementById('adicionarJogo');
            const quantidadeNecessaria = parseInt(document.getElementById('quantidadeDezenas').value);
            btn.disabled = numerosSelecionados.length !== quantidadeNecessaria;
        }

        // üéØ FUN√á√ïES DAS REGRAS MINIMALISTAS

        function mostrarTooltipRegra(numeroRegra, event) {
            const regra = regrasMinimalistas.definicoes[numeroRegra];
            if (!regra) return;
            
            // Remover tooltip existente
            const tooltipExistente = document.querySelector('.tooltip-regra');
            if (tooltipExistente) {
                document.body.removeChild(tooltipExistente);
            }
            
            const tooltip = document.createElement('div');
            tooltip.className = 'tooltip-regra';
            tooltip.innerHTML = `
                <strong>${regra.nome}</strong><br>
                ${regra.descricao}<br><br>
                <strong>Exemplo:</strong><br>
                ${regra.exemplo}
            `;
            
            // Posicionar pr√≥ximo ao mouse
            const rect = event.target.getBoundingClientRect();
            tooltip.style.left = `${rect.left + window.scrollX}px`;
            tooltip.style.top = `${rect.bottom + window.scrollY + 10}px`;
            
            // Ajustar posi√ß√£o se sair da tela
            document.body.appendChild(tooltip);
            const tooltipRect = tooltip.getBoundingClientRect();
            
            if (tooltipRect.right > window.innerWidth) {
                tooltip.style.left = `${window.innerWidth - tooltipRect.width - 10}px`;
            }
            
            if (tooltipRect.bottom > window.innerHeight) {
                tooltip.style.top = `${rect.top + window.scrollY - tooltipRect.height - 10}px`;
            }
            
            // Remover tooltip ap√≥s 5 segundos ou ao clicar fora
            setTimeout(() => {
                if (tooltip.parentNode) {
                    document.body.removeChild(tooltip);
                }
            }, 5000);
            
            const removerTooltip = (e) => {
                if (!tooltip.contains(e.target) && tooltip.parentNode) {
                    document.body.removeChild(tooltip);
                    document.removeEventListener('click', removerTooltip);
                }
            };
            
            setTimeout(() => {
                document.addEventListener('click', removerTooltip);
            }, 100);
        }

        function extrairNumerosBase() {
            if (!dadosProximoSorteio) {
                showCustomAlert('‚ö†Ô∏è Dados Necess√°rios', 'Dados do pr√≥ximo sorteio n√£o dispon√≠veis!');
                return [];
            }
            
            const base = [];
            
            // Extrair do n√∫mero do concurso
            const concursoStr = dadosProximoSorteio.numero.toString();
            for (let digit of concursoStr) {
                const num = parseInt(digit);
                if (num >= 1 && num <= 60) base.push(num);
            }
            
            // Extrair da data
            const dataMatch = dadosProximoSorteio.data.match(/(\d{1,2})\/(\d{1,2})\/(\d{4})/);
            if (dataMatch) {
                const dia = parseInt(dataMatch[1]);
                const mes = parseInt(dataMatch[2]);
                const ano = parseInt(dataMatch[3]);
                
                if (dia >= 1 && dia <= 60) base.push(dia);
                if (mes >= 1 && mes <= 60) base.push(mes);
                
                // Extrair d√≠gitos do ano
                const anoStr = ano.toString();
                const ano20 = parseInt(anoStr.slice(0, 2)); // 20
                const ano25 = parseInt(anoStr.slice(2));     // 25
                
                if (ano20 >= 1 && ano20 <= 60) base.push(ano20);
                if (ano25 >= 1 && ano25 <= 60) base.push(ano25);
            }
            
            // Extrair do pr√™mio
            const premioStr = dadosProximoSorteio.premio.toString();
            if (premioStr.length >= 2) {
                const primeiros2 = parseInt(premioStr.slice(0, 2));
                if (primeiros2 >= 1 && primeiros2 <= 60) base.push(primeiros2);
                
                // Se tiver mais d√≠gitos, extrair mais
                if (premioStr.length >= 3) {
                    const digito3 = parseInt(premioStr[2]);
                    const soma23 = parseInt(premioStr[0]) + parseInt(premioStr[1]);
                    if (soma23 >= 1 && soma23 <= 60) base.push(soma23);
                }
            }
            
            // Remover duplicatas e manter apenas n√∫meros v√°lidos
            return [...new Set(base)].filter(n => n >= 1 && n <= 60).sort((a, b) => a - b);
        }

        function aplicarRegrasMinimalistas(numerosBase, regrasAtivas) {
            const resultados = new Set();
            
            // Adicionar n√∫meros base se R1 estiver ativa
            if (regrasAtivas.includes(1)) {
                numerosBase.forEach(num => resultados.add(num));
            }
            
            // R2 - Soma
            if (regrasAtivas.includes(2)) {
                for (let i = 0; i < numerosBase.length; i++) {
                    for (let j = i + 1; j < numerosBase.length; j++) {
                        const soma = numerosBase[i] + numerosBase[j];
                        if (soma >= 1 && soma <= 60) {
                            resultados.add(soma);
                        }
                    }
                }
            }
            
            // R3 - Dobro/Multiplica√ß√£o
            if (regrasAtivas.includes(3)) {
                numerosBase.forEach(num => {
                    const dobro = num * 2;
                    const triplo = num * 3;
                    
                    if (dobro >= 1 && dobro <= 60) resultados.add(dobro);
                    if (triplo >= 1 && triplo <= 60) resultados.add(triplo);
                });
            }
            
            // R4 - Diferen√ßa
            if (regrasAtivas.includes(4)) {
                for (let i = 0; i < numerosBase.length; i++) {
                    for (let j = 0; j < numerosBase.length; j++) {
                        if (i !== j) {
                            const diff = Math.abs(numerosBase[i] - numerosBase[j]);
                            if (diff >= 1 && diff <= 60) {
                                resultados.add(diff);
                            }
                        }
                    }
                }
            }
            
            // R5 - Invers√£o
            if (regrasAtivas.includes(5)) {
                numerosBase.forEach(num => {
                    if (num >= 10) {
                        const numStr = num.toString();
                        const invertido = parseInt(numStr.split('').reverse().join(''));
                        if (invertido >= 1 && invertido <= 60) {
                            resultados.add(invertido);
                        }
                    }
                });
            }
            
            // R6 - Vizinhos
            if (regrasAtivas.includes(6)) {
                numerosBase.forEach(num => {
                    const vizinhos = [num - 2, num - 1, num + 1, num + 2];
                    vizinhos.forEach(viz => {
                        if (viz >= 1 && viz <= 60) {
                            resultados.add(viz);
                        }
                    });
                });
            }
            
            // R7 - Soma Cruzada
            if (regrasAtivas.includes(7)) {
                // Somar d√≠gitos de cada n√∫mero
                numerosBase.forEach(num => {
                    if (num >= 10) {
                        const numStr = num.toString();
                        let soma = 0;
                        for (let digit of numStr) {
                            soma += parseInt(digit);
                        }
                        if (soma >= 1 && soma <= 60) {
                            resultados.add(soma);
                        }
                    }
                });
                
                // Somar elementos espec√≠ficos se houver dados da data
                if (dadosProximoSorteio) {
                    const dataMatch = dadosProximoSorteio.data.match(/(\d{1,2})\/(\d{1,2})\/(\d{4})/);
                    if (dataMatch) {
                        const dia = parseInt(dataMatch[1]);
                        const mes = parseInt(dataMatch[2]);
                        const somaDiaMes = dia + mes;
                        
                        if (somaDiaMes >= 1 && somaDiaMes <= 60) {
                            resultados.add(somaDiaMes);
                        }
                    }
                }
            }
            
            return Array.from(resultados).sort((a, b) => a - b);
        }

        function gerarJogosMinimalistas() {
            // Verificar quais regras est√£o selecionadas
            const regrasAtivas = [];
            for (let i = 1; i <= 7; i++) {
                if (document.getElementById(`regra${i}`).checked) {
                    regrasAtivas.push(i);
                }
            }
            
            if (regrasAtivas.length === 0) {
                showCustomAlert('‚ö†Ô∏è Sele√ß√£o Necess√°ria', 'Selecione pelo menos uma regra minimalista!');
                return;
            }
            
            if (!dadosProximoSorteio) {
                showCustomAlert('‚ö†Ô∏è Dados Necess√°rios', 'Dados do pr√≥ximo sorteio n√£o dispon√≠veis!');
                return;
            }
            
            const qtdJogos = parseInt(document.getElementById('qtdJogosMinimalista').value);
            const dezenasJogo = parseInt(document.getElementById('dezenasMinimalista').value);
            
            // Extrair n√∫meros base
            const numerosBase = extrairNumerosBase();
            
            if (numerosBase.length === 0) {
                showCustomAlert('‚ùå Erro', 'N√£o foi poss√≠vel extrair n√∫meros base dos dados!');
                return;
            }
            
            // Aplicar regras
            const poolNumeros = aplicarRegrasMinimalistas(numerosBase, regrasAtivas);
            
            if (poolNumeros.length < dezenasJogo) {
                showCustomAlert('‚ö†Ô∏è Pool Insuficiente', `Pool gerado tem apenas ${poolNumeros.length} n√∫meros, mas precisa de ${dezenasJogo} por jogo. Selecione mais regras ou reduza as dezenas.`);
                return;
            }
            
            // Gerar jogos
            jogosMinimalistas = [];
            
            for (let i = 0; i < qtdJogos; i++) {
                const jogo = [];
                const poolDisponivel = [...poolNumeros];
                
                while (jogo.length < dezenasJogo && poolDisponivel.length > 0) {
                    const index = Math.floor(Math.random() * poolDisponivel.length);
                    const numero = poolDisponivel.splice(index, 1)[0];
                    jogo.push(numero);
                }
                
                // Se ainda faltam n√∫meros, completar com n√∫meros aleat√≥rios v√°lidos
                while (jogo.length < dezenasJogo) {
                    let numeroAleatorio;
                    do {
                        numeroAleatorio = Math.floor(Math.random() * 60) + 1;
                    } while (jogo.includes(numeroAleatorio));
                    jogo.push(numeroAleatorio);
                }
                
                jogo.sort((a, b) => a - b);
                
                const jogoObj = {
                    id: Date.now() + i,
                    numeros: jogo,
                    quantidade: dezenasJogo,
                    custo: sistemaValores.obterValor(dezenasJogo),
                    regrasUsadas: regrasAtivas.slice(),
                    numerosBase: numerosBase.slice(),
                    origem: 'Regras Minimalistas'
                };
                
                jogosMinimalistas.push(jogoObj);
            }
            
            exibirJogosMinimalistas(numerosBase, regrasAtivas);
        }

        function exibirJogosMinimalistas(numerosBase, regrasAtivas) {
            // Mostrar n√∫meros base extra√≠dos
            const baseDiv = document.getElementById('numerosBaseExtraidos');
            const listaBase = document.getElementById('listaBaseExtraidos');
            
            listaBase.innerHTML = numerosBase.map(num => 
                `<span class="numero-base">${num.toString().padStart(2, '0')}</span>`
            ).join('');
            
            baseDiv.classList.remove('hidden');
            
            // Mostrar jogos gerados
            const jogosDiv = document.getElementById('jogosMinimalistasGerados');
            const listaJogos = document.getElementById('listaJogosMinimalistas');
            
            listaJogos.innerHTML = '';
            
            jogosMinimalistas.forEach((jogo, index) => {
                const jogoDiv = document.createElement('div');
                jogoDiv.className = 'jogo-minimalista-card';
                
                jogoDiv.innerHTML = `
                    <div class="flex justify-between items-center mb-2">
                        <span class="font-bold text-megasena">Jogo ${index + 1}</span>
                        <div class="flex gap-1">
                            ${jogo.regrasUsadas.map(r => `<span class="regra-badge">R${r}</span>`).join('')}
                            <span class="px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded">${formatarMoeda(jogo.custo)}</span>
                        </div>
                    </div>
                    <div class="flex flex-wrap gap-1 mb-2">
                        ${jogo.numeros.map(num => `<span class="numero-minimalista">${num.toString().padStart(2, '0')}</span>`).join('')}
                    </div>
                    <div class="text-xs text-gray-600">
                        Base: ${jogo.numerosBase.map(n => n.toString().padStart(2, '0')).join(', ')} | 
                        Regras: ${jogo.regrasUsadas.map(r => `R${r}`).join(', ')}
                    </div>
                `;
                
                listaJogos.appendChild(jogoDiv);
            });
            
            // Atualizar estat√≠sticas
            const totalJogos = jogosMinimalistas.length;
            const custoTotal = jogosMinimalistas.reduce((sum, jogo) => sum + jogo.custo, 0);
            const numerosUnicos = new Set();
            jogosMinimalistas.forEach(jogo => {
                jogo.numeros.forEach(num => numerosUnicos.add(num));
            });
            
            document.getElementById('totalJogosMin').textContent = totalJogos;
            document.getElementById('custoTotalMin').textContent = formatarMoeda(custoTotal);
            document.getElementById('regrasUsadas').textContent = regrasAtivas.length;
            document.getElementById('numerosUnicosMin').textContent = numerosUnicos.size;
            
            jogosDiv.classList.remove('hidden');
        }

        function adicionarJogosMinimalistas() {
            if (jogosMinimalistas.length === 0) {
                showCustomAlert('‚ö†Ô∏è Sem Jogos', 'Gere primeiro alguns jogos minimalistas!');
                return;
            }
            
            jogosMinimalistas.forEach(jogoMin => {
                const jogo = {
                    id: Date.now() + Math.random(),
                    numeros: [...jogoMin.numeros],
                    quantidade: jogoMin.quantidade,
                    custo: jogoMin.custo,
                    digitosDiferentes: calcularDigitosDiferentes(jogoMin.numeros),
                    pares: jogoMin.numeros.filter(n => n % 2 === 0).length,
                    impares: jogoMin.numeros.filter(n => n % 2 !== 0).length,
                    origem: `Minimalista (R${jogoMin.regrasUsadas.join(',R')})`
                };
                jogosAdicionados.push(jogo);
            });
            
            atualizarVisualizacaoJogos();
            atualizarCustoTotal();
            
            showCustomAlert('‚úÖ Sucesso', `${jogosMinimalistas.length} jogo(s) minimalista(s) adicionado(s) aos seus jogos!`);
        }

        function downloadJogosMinimalistas() {
            if (jogosMinimalistas.length === 0) {
                showCustomAlert('‚ö†Ô∏è Sem Jogos', 'Gere primeiro alguns jogos minimalistas!');
                return;
            }
            
            let conteudo = 'JOGOS MINIMALISTAS - MEGA SENA\n';
            conteudo += 'Baseados em Regras Matem√°ticas Simples\n';
            conteudo += `Gerado em: ${new Date().toLocaleString('pt-BR')}\n\n`;
            
            if (dadosProximoSorteio) {
                conteudo += `DADOS BASE UTILIZADOS:\n`;
                conteudo += `Concurso: ${dadosProximoSorteio.numero}\n`;
                conteudo += `Data: ${dadosProximoSorteio.data}\n`;
                conteudo += `Pr√™mio: ${formatarMoeda(dadosProximoSorteio.premio)}\n\n`;
            }
            
            conteudo += `N√öMEROS BASE EXTRA√çDOS:\n`;
            const numerosBase = extrairNumerosBase();
            conteudo += `${numerosBase.map(n => n.toString().padStart(2, '0')).join(' ')}\n\n`;
            
            conteudo += `JOGOS GERADOS:\n`;
            jogosMinimalistas.forEach((jogo, index) => {
                conteudo += `Jogo ${index + 1}: ${jogo.numeros.map(n => n.toString().padStart(2, '0')).join(' ')} `;
                conteudo += `(Regras: R${jogo.regrasUsadas.join(', R')} | ${formatarMoeda(jogo.custo)})\n`;
            });
            
            const custoTotal = jogosMinimalistas.reduce((sum, jogo) => sum + jogo.custo, 0);
            conteudo += `\nTOTAL: ${jogosMinimalistas.length} jogo(s) - ${formatarMoeda(custoTotal)}\n`;
            
            baixarArquivo(conteudo, 'jogos-minimalistas-megasena.txt', 'text/plain');
        }

        function limparJogosMinimalistas() {
            jogosMinimalistas = [];
            document.getElementById('jogosMinimalistasGerados').classList.add('hidden');
            document.getElementById('numerosBaseExtraidos').classList.add('hidden');
        }

        // üéØ FUN√á√ïES DA AN√ÅLISE POR POSI√á√ïES
        
        async function carregarAnalisePorPosicoes() {
            const loadingEl = document.getElementById('loadingPosicoes');
            const controles = document.getElementById('controlesPosicoes');
            const progressoEl = document.getElementById('progressoPosicoes');
            
            loadingEl.classList.remove('hidden');
            controles.classList.add('hidden');
            
            try {
                if (concursosHistoricos.length > 0) {
                    progressoEl.textContent = `‚úÖ ${concursosHistoricos.length} concursos carregados com sucesso!`;
                    analisePosicoesCarregada = true;
                } else {
                    progressoEl.textContent = 'Carregando dados hist√≥ricos...';
                    await new Promise(resolve => setTimeout(resolve, 1000));
                    
                    concursosHistoricos = DADOS_EXEMPLO.concursosHistoricos;
                    analisePosicoesCarregada = true;
                    progressoEl.textContent = `‚úÖ ${concursosHistoricos.length} concursos carregados!`;
                }
                
                setTimeout(() => {
                    loadingEl.classList.add('hidden');
                    controles.classList.remove('hidden');
                    
                    const infoEl = document.getElementById('infoAnalise');
                    infoEl.innerHTML = `
                        üìä <strong>Hist√≥rico carregado:</strong> ${concursosHistoricos.length} concursos<br>
                        üìÖ <strong>Per√≠odo:</strong> √öltimos concursos dispon√≠veis<br>
                        üéØ <strong>Pronto para an√°lise:</strong> Clique em "Analisar" para come√ßar
                    `;
                    infoEl.classList.remove('hidden');
                }, 1000);
                
            } catch (error) {
                console.error('Erro ao carregar an√°lise por posi√ß√µes:', error);
                progressoEl.textContent = '‚ùå Erro ao carregar hist√≥rico';
                setTimeout(() => loadingEl.classList.add('hidden'), 3000);
            }
        }

        function analisarPosicoesDetalhada() {
            if (!analisePosicoesCarregada || concursosHistoricos.length === 0) {
                showCustomAlert('‚ö†Ô∏è Dados Necess√°rios', 'Carregue primeiro o hist√≥rico clicando em "Carregar An√°lise"!');
                return;
            }
            
            const filtro = document.getElementById('filtroPosicoesAnalise').value;
            const qtdConcursos = parseInt(document.getElementById('qtdConcursosPosicoes').value);
            const concursosParaAnalise = concursosHistoricos.slice(0, qtdConcursos);
            
            resultadosAnalise = {};
            categoriasNumeros = {};
            
            for (let posicao = 1; posicao <= 6; posicao++) {
                if (filtro !== 'todas' && parseInt(filtro) !== posicao) {
                    continue;
                }
                
                const numerosNaPosicao = new Set();
                const ultimosNumeros = [];
                
                concursosParaAnalise.forEach(concurso => {
                    const numero = concurso.posicoes[posicao - 1];
                    if (numero && numero >= 1 && numero <= 60) {
                        numerosNaPosicao.add(numero);
                        ultimosNumeros.push({
                            numero: numero,
                            concurso: concurso.numero,
                            data: concurso.data
                        });
                    }
                });
                
                const numerosAtrasados = [];
                for (let num = 1; num <= 60; num++) {
                    if (!numerosNaPosicao.has(num)) {
                        numerosAtrasados.push(num);
                    }
                }
                
                const frequencia = {};
                Array.from(numerosNaPosicao).forEach(num => {
                    frequencia[num] = ultimosNumeros.filter(item => item.numero === num).length;
                });
                
                const candidatosTOP = Array.from(numerosNaPosicao)
                    .sort((a, b) => frequencia[a] - frequencia[b])
                    .slice(0, 10);
                
                resultadosAnalise[posicao] = {
                    ultimoNumero: ultimosNumeros[0]?.numero || 'N/A',
                    numerosAtrasados: numerosAtrasados,
                    candidatosTOP: candidatosTOP,
                    ultimaData: ultimosNumeros[0]?.data || 'N/A',
                    totalAnalisados: concursosParaAnalise.length
                };

                if (!categoriasNumeros[posicao]) {
                    categoriasNumeros[posicao] = {};
                }
                
                for (let num = 1; num <= 60; num++) {
                    if (numerosAtrasados.includes(num)) {
                        if (numerosAtrasados.length > 30) {
                            categoriasNumeros[posicao][num] = 'muito-atrasado';
                        } else {
                            categoriasNumeros[posicao][num] = 'atrasado';
                        }
                    } else if (candidatosTOP.includes(num)) {
                        categoriasNumeros[posicao][num] = 'candidato';
                    } else if (frequencia[num] > 2) {
                        categoriasNumeros[posicao][num] = 'frequente';
                    } else {
                        categoriasNumeros[posicao][num] = 'normal';
                    }
                }
            }
            
            exibirResultadosAnalise();
        }

        function exibirResultadosAnalise() {
            const resultadosDiv = document.getElementById('resultadosPosicoes');
            const tabelaCorpo = document.getElementById('tabelaAnaliseCorpo');
            
            resultadosDiv.classList.remove('hidden');
            
            let totalAtrasados = 0;
            let posicaoMaisAtrasada = 1;
            let maxAtrasados = 0;
            let numeroMaisAtrasado = null;
            
            Object.entries(resultadosAnalise).forEach(([posicao, dados]) => {
                totalAtrasados += dados.numerosAtrasados.length;
                if (dados.numerosAtrasados.length > maxAtrasados) {
                    maxAtrasados = dados.numerosAtrasados.length;
                    posicaoMaisAtrasada = posicao;
                }
                
                dados.numerosAtrasados.forEach(num => {
                    if (!numeroMaisAtrasado || num < numeroMaisAtrasado) {
                        numeroMaisAtrasado = num;
                    }
                });
            });
            
            document.getElementById('totalNumerosAtrasados').textContent = totalAtrasados;
            document.getElementById('posicaoMaisAtrasada').textContent = `${posicaoMaisAtrasada}¬™ Bola`;
            document.getElementById('numeroMaisAtrasado').textContent = numeroMaisAtrasado ? numeroMaisAtrasado.toString().padStart(2, '0') : '-';
            
            tabelaCorpo.innerHTML = '';
            
            Object.entries(resultadosAnalise).forEach(([posicao, dados]) => {
                const row = tabelaCorpo.insertRow();
                
                const cellPosicao = row.insertCell();
                cellPosicao.className = 'p-3 border text-center font-bold bg-orange-100';
                cellPosicao.textContent = `${posicao}¬™ Bola`;
                
                const cellUltimo = row.insertCell();
                cellUltimo.className = 'p-3 border text-center';
                cellUltimo.innerHTML = `<span class="bola-numero">${dados.ultimoNumero.toString().padStart(2, '0')}</span>`;
                
                const cellAtrasados = row.insertCell();
                cellAtrasados.className = 'p-3 border text-center';
                if (dados.numerosAtrasados.length > 0) {
                    cellAtrasados.innerHTML = dados.numerosAtrasados
                        .slice(0, 8)
                        .map(num => `<span class="inline-block bg-red-500 text-white rounded-full w-6 h-6 text-xs flex items-center justify-center m-1">${num.toString().padStart(2, '0')}</span>`)
                        .join('');
                    if (dados.numerosAtrasados.length > 8) {
                        cellAtrasados.innerHTML += `<span class="text-xs text-gray-600">+${dados.numerosAtrasados.length - 8} mais</span>`;
                    }
                } else {
                    cellAtrasados.textContent = 'Nenhum';
                }
                
                const cellCandidatos = row.insertCell();
                cellCandidatos.className = 'p-3 border text-center';
                cellCandidatos.innerHTML = dados.candidatosTOP
                    .slice(0, 6)
                    .map(num => `<span class="inline-block bg-yellow-500 text-white rounded-full w-6 h-6 text-xs flex items-center justify-center m-1">${num.toString().padStart(2, '0')}</span>`)
                    .join('');
                
                const cellConcursos = row.insertCell();
                cellConcursos.className = 'p-3 border text-center';
                cellConcursos.textContent = `${dados.totalAnalisados} concursos`;
                
                const cellSugestao = row.insertCell();
                cellSugestao.className = 'p-3 border text-center text-sm';
                if (dados.numerosAtrasados.length > 15) {
                    cellSugestao.innerHTML = '<span class="text-red-600 font-bold">üî• Prioridade Alta</span>';
                } else if (dados.numerosAtrasados.length > 8) {
                    cellSugestao.innerHTML = '<span class="text-orange-600 font-bold">‚ö° Prioridade M√©dia</span>';
                } else {
                    cellSugestao.innerHTML = '<span class="text-green-600 font-bold">‚úÖ Equilibrada</span>';
                }
            });
        }

        // üéØ FUN√á√ïES PARA GRID ESTRAT√âGICA

        function atualizarGridEstrategica() {
            if (Object.keys(categoriasNumeros).length === 0) {
                showCustomAlert('‚ö†Ô∏è An√°lise Necess√°ria', 'Execute primeiro a an√°lise por posi√ß√µes!');
                return;
            }

            const posicao = document.getElementById('posicaoAtual').value;
            const filtro = document.getElementById('filtroNumeros').value;
            const grid = document.getElementById('gridEstrategica');
            const info = document.getElementById('infoGridEstrategica');
            
            grid.innerHTML = '';
            
            if (posicao === 'todas') {
                info.textContent = `Mostrando n√∫meros ${filtro} de todas as posi√ß√µes`;
            } else {
                info.textContent = `Mostrando n√∫meros ${filtro} da ${posicao}¬™ Bola`;
            }
            
            for (let i = 1; i <= 60; i++) {
                const btn = document.createElement('button');
                btn.className = 'numero-estrategico';
                btn.textContent = i.toString().padStart(2, '0');
                btn.dataset.numero = i;
                btn.dataset.posicao = posicao === 'todas' ? 'T' : posicao;
                
                let categoria = 'normal';
                if (posicao === 'todas') {
                    let melhorCategoria = 'normal';
                    for (let p = 1; p <= 6; p++) {
                        if (categoriasNumeros[p] && categoriasNumeros[p][i]) {
                            const cat = categoriasNumeros[p][i];
                            if (cat === 'muito-atrasado' || (cat === 'atrasado' && melhorCategoria !== 'muito-atrasado')) {
                                melhorCategoria = cat;
                            }
                        }
                    }
                    categoria = melhorCategoria;
                } else {
                    categoria = categoriasNumeros[posicao] ? categoriasNumeros[posicao][i] || 'normal' : 'normal';
                }
                
                switch (categoria) {
                    case 'muito-atrasado':
                        btn.classList.add('numero-muito-atrasado');
                        break;
                    case 'atrasado':
                        btn.classList.add('numero-atrasado-estrategico');
                        break;
                    case 'candidato':
                        btn.classList.add('numero-candidato-estrategico');
                        break;
                    case 'frequente':
                        btn.classList.add('numero-frequente-estrategico');
                        break;
                    default:
                        btn.classList.add('numero-normal-estrategico');
                }
                
                let mostrar = false;
                switch (filtro) {
                    case 'todos':
                        mostrar = true;
                        break;
                    case 'atrasados':
                        mostrar = categoria === 'muito-atrasado' || categoria === 'atrasado';
                        break;
                    case 'candidatos':
                        mostrar = categoria === 'candidato';
                        break;
                    case 'frequentes':
                        mostrar = categoria === 'frequente';
                        break;
                }
                
                if (!mostrar) {
                    btn.classList.add('numero-oculto');
                    btn.disabled = true;
                } else {
                    btn.onclick = () => toggleNumeroEstrategico(i);
                }
                
                if (numerosEstrategicos.includes(i)) {
                    btn.classList.add('selecionado-estrategico');
                }
                
                grid.appendChild(btn);
            }
            
            atualizarStatusSelecaoEstrategica();
        }

        function toggleNumeroEstrategico(numero) {
            const btn = document.querySelector(`.numero-estrategico[data-numero="${numero}"]`);
            
            if (numerosEstrategicos.includes(numero)) {
                numerosEstrategicos = numerosEstrategicos.filter(n => n !== numero);
                btn.classList.remove('selecionado-estrategico');
            } else if (numerosEstrategicos.length < 6) {
                numerosEstrategicos.push(numero);
                btn.classList.add('selecionado-estrategico');
            }
            
            atualizarStatusSelecaoEstrategica();
        }

        function atualizarStatusSelecaoEstrategica() {
            document.getElementById('numerosEstrategicos').textContent = numerosEstrategicos.length;
            
            let atrasados = 0, candidatos = 0, frequentes = 0;
            
            numerosEstrategicos.forEach(num => {
                let melhorCategoria = 'normal';
                for (let p = 1; p <= 6; p++) {
                    if (categoriasNumeros[p] && categoriasNumeros[p][num]) {
                        const cat = categoriasNumeros[p][num];
                        if (cat === 'muito-atrasado' || cat === 'atrasado') {
                            atrasados++;
                            break;
                        } else if (cat === 'candidato' && melhorCategoria !== 'atrasado') {
                            melhorCategoria = 'candidato';
                        } else if (cat === 'frequente' && melhorCategoria === 'normal') {
                            melhorCategoria = 'frequente';
                        }
                    }
                }
                
                if (melhorCategoria === 'candidato') candidatos++;
                else if (melhorCategoria === 'frequente') frequentes++;
            });
            
            document.getElementById('atrasadosEstrategicos').textContent = atrasados;
            document.getElementById('candidatosEstrategicos').textContent = candidatos;
            document.getElementById('frequentesEstrategicos').textContent = frequentes;
            
            const btnUsar = document.getElementById('btnUsarEstrategica');
            btnUsar.disabled = numerosEstrategicos.length !== 6;
        }

        function limparSelecaoEstrategica() {
            numerosEstrategicos = [];
            document.querySelectorAll('.numero-estrategico').forEach(btn => {
                btn.classList.remove('selecionado-estrategico');
            });
            atualizarStatusSelecaoEstrategica();
        }

        function sugestaoRapidaEstrategica() {
            if (Object.keys(categoriasNumeros).length === 0) {
                showCustomAlert('‚ö†Ô∏è An√°lise Necess√°ria', 'Execute primeiro a an√°lise por posi√ß√µes!');
                return;
            }
            
            limparSelecaoEstrategica();
            
            const posicao = document.getElementById('posicaoAtual').value;
            const estrategia = document.getElementById('estrategiaPalpite').value;
            
            if (posicao === 'todas') {
                for (let p = 1; p <= 6; p++) {
                    if (resultadosAnalise[p]) {
                        let numeroSelecionado;
                        
                        switch (estrategia) {
                            case 'atrasados':
                                numeroSelecionado = resultadosAnalise[p].numerosAtrasados[0] || resultadosAnalise[p].candidatosTOP[0];
                                break;
                            case 'equilibrado':
                                const opcoes = [...resultadosAnalise[p].numerosAtrasados.slice(0, 5), ...resultadosAnalise[p].candidatosTOP.slice(0, 3)];
                                numeroSelecionado = opcoes[Math.floor(Math.random() * opcoes.length)];
                                break;
                            case 'misto':
                                const todasOpcoes = [...resultadosAnalise[p].numerosAtrasados, ...resultadosAnalise[p].candidatosTOP];
                                numeroSelecionado = todasOpcoes[Math.floor(Math.random() * todasOpcoes.length)];
                                break;
                        }
                        
                        if (numeroSelecionado && !numerosEstrategicos.includes(numeroSelecionado)) {
                            numerosEstrategicos.push(numeroSelecionado);
                        }
                    }
                }
            } else {
                const dados = resultadosAnalise[posicao];
                if (dados) {
                    const candidatos = [...dados.numerosAtrasados.slice(0, 10), ...dados.candidatosTOP.slice(0, 5)];
                    
                    while (numerosEstrategicos.length < 6 && candidatos.length > 0) {
                        const index = Math.floor(Math.random() * candidatos.length);
                        const numero = candidatos.splice(index, 1)[0];
                        if (!numerosEstrategicos.includes(numero)) {
                            numerosEstrategicos.push(numero);
                        }
                    }
                }
            }
            
            document.querySelectorAll('.numero-estrategico').forEach(btn => {
                const numero = parseInt(btn.dataset.numero);
                if (numerosEstrategicos.includes(numero)) {
                    btn.classList.add('selecionado-estrategico');
                }
            });
            
            atualizarStatusSelecaoEstrategica();
        }

        function usarSelecaoEstrategica() {
            if (numerosEstrategicos.length !== 6) {
                showCustomAlert('‚ö†Ô∏è Sele√ß√£o Incompleta', 'Selecione exatamente 6 n√∫meros na grid estrat√©gica!');
                return;
            }
            
            numerosSelecionados = [];
            numerosDropArea = [];
            document.querySelectorAll('.numero-mega').forEach(btn => {
                btn.classList.remove('selecionado');
            });
            
            numerosEstrategicos.forEach(numero => {
                numerosSelecionados.push(numero);
                numerosDropArea.push(numero);
                const btn = document.querySelector(`.numero-mega:nth-child(${numero})`);
                if (btn) {
                    btn.classList.add('selecionado');
                }
            });
            
            atualizarVisualizacaoDropArea();
            atualizarContadorParesImpares();
            validarBotaoAdicionar();
            
            showCustomAlert('‚úÖ Transfer√™ncia Conclu√≠da', 'N√∫meros da grid estrat√©gica transferidos para o jogo principal!');
        }

        function gerarPalpitesInteligentes() {
            if (Object.keys(resultadosAnalise).length === 0) {
                showCustomAlert('‚ö†Ô∏è An√°lise Necess√°ria', 'Execute primeiro a an√°lise por posi√ß√µes!');
                return;
            }
            
            const estrategia = document.getElementById('estrategiaPalpite').value;
            const qtdJogos = parseInt(document.getElementById('qtdJogosPalpite').value);
            
            palpitesInteligentes = [];
            
            for (let jogo = 0; jogo < qtdJogos; jogo++) {
                const palpite = [];
                
                Object.entries(resultadosAnalise).forEach(([posicao, dados]) => {
                    let numeroEscolhido;
                    
                    switch (estrategia) {
                        case 'atrasados':
                            if (dados.numerosAtrasados.length > 0) {
                                const index = Math.floor(Math.random() * Math.min(dados.numerosAtrasados.length, 10));
                                numeroEscolhido = dados.numerosAtrasados[index];
                            } else {
                                numeroEscolhido = dados.candidatosTOP[Math.floor(Math.random() * Math.min(dados.candidatosTOP.length, 5))];
                            }
                            break;
                            
                        case 'equilibrado':
                            const usarAtrasado = Math.random() < 0.6;
                            if (usarAtrasado && dados.numerosAtrasados.length > 0) {
                                const index = Math.floor(Math.random() * Math.min(dados.numerosAtrasados.length, 15));
                                numeroEscolhido = dados.numerosAtrasados[index];
                            } else {
                                numeroEscolhido = dados.candidatosTOP[Math.floor(Math.random() * Math.min(dados.candidatosTOP.length, 8))];
                            }
                            break;
                            
                        case 'misto':
                            const opcoes = [...dados.numerosAtrasados.slice(0, 15), ...dados.candidatosTOP.slice(0, 10)];
                            numeroEscolhido = opcoes[Math.floor(Math.random() * opcoes.length)];
                            break;
                    }
                    
                    if (numeroEscolhido && !palpite.includes(numeroEscolhido)) {
                        palpite.push(numeroEscolhido);
                    } else {
                        let tentativas = 0;
                        do {
                            numeroEscolhido = Math.floor(Math.random() * 60) + 1;
                            tentativas++;
                        } while (palpite.includes(numeroEscolhido) && tentativas < 50);
                        
                        if (!palpite.includes(numeroEscolhido)) {
                            palpite.push(numeroEscolhido);
                        }
                    }
                });
                
                while (palpite.length < 6) {
                    let numero;
                    do {
                        numero = Math.floor(Math.random() * 60) + 1;
                    } while (palpite.includes(numero));
                    palpite.push(numero);
                }
                
                palpite.sort((a, b) => a - b);
                
                palpitesInteligentes.push({
                    id: Date.now() + jogo,
                    numeros: palpite,
                    estrategia: estrategia,
                    custo: sistemaValores.obterValor(6)
                });
            }
            
            exibirPalpitesGerados();
        }

        function exibirPalpitesGerados() {
            const palpitesDiv = document.getElementById('palpitesGerados');
            const listaPalpites = document.getElementById('listaPalpites');
            
            palpitesDiv.classList.remove('hidden');
            listaPalpites.innerHTML = '';
            
            palpitesInteligentes.forEach((palpite, index) => {
                const palpiteDiv = document.createElement('div');
                palpiteDiv.className = 'palpite-card';
                
                palpiteDiv.innerHTML = `
                    <div class="flex justify-between items-center mb-2">
                        <span class="font-bold text-green-800">Palpite ${index + 1}</span>
                        <div class="flex gap-2">
                            <span class="px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded">${palpite.estrategia}</span>
                            <span class="px-2 py-1 bg-green-100 text-green-800 text-xs rounded">${formatarMoeda(palpite.custo)}</span>
                        </div>
                    </div>
                    <div class="flex flex-wrap gap-1">
                        ${palpite.numeros.map(num => `<span class="numero-palpite">${num.toString().padStart(2, '0')}</span>`).join('')}
                    </div>
                `;
                
                listaPalpites.appendChild(palpiteDiv);
            });
        }

        function adicionarPalpitesAosJogos() {
            if (palpitesInteligentes.length === 0) {
                showCustomAlert('‚ö†Ô∏è Sem Palpites', 'Gere primeiro alguns palpites!');
                return;
            }
            
            palpitesInteligentes.forEach(palpite => {
                const jogo = {
                    id: Date.now() + Math.random(),
                    numeros: [...palpite.numeros],
                    quantidade: 6,
                    custo: palpite.custo,
                    digitosDiferentes: calcularDigitosDiferentes(palpite.numeros),
                    pares: palpite.numeros.filter(n => n % 2 === 0).length,
                    impares: palpite.numeros.filter(n => n % 2 !== 0).length,
                    origem: 'Palpite Inteligente'
                };
                jogosAdicionados.push(jogo);
            });
            
            atualizarVisualizacaoJogos();
            atualizarCustoTotal();
            
            showCustomAlert('‚úÖ Sucesso', `${palpitesInteligentes.length} palpite(s) adicionado(s) aos seus jogos!`);
        }

        function downloadPalpites() {
            if (palpitesInteligentes.length === 0) {
                showCustomAlert('‚ö†Ô∏è Sem Palpites', 'Gere primeiro alguns palpites!');
                return;
            }
            
            let conteudo = 'PALPITES INTELIGENTES - MEGA SENA\n';
            conteudo += 'Baseados na An√°lise por Posi√ß√µes\n';
            conteudo += `Gerado em: ${new Date().toLocaleString('pt-BR')}\n\n`;
            
            palpitesInteligentes.forEach((palpite, index) => {
                conteudo += `Palpite ${index + 1}: ${palpite.numeros.map(n => n.toString().padStart(2, '0')).join(' ')}\n`;
            });
            
            conteudo += `\nTotal: ${palpitesInteligentes.length} palpite(s) - ${formatarMoeda(palpitesInteligentes.reduce((sum, p) => sum + p.custo, 0))}\n`;
            
            baixarArquivo(conteudo, 'palpites-inteligentes-megasena.txt', 'text/plain');
        }

        function toggleVisualizacaoPosicoes() {
            const resultadosDiv = document.getElementById('resultadosPosicoes');
            const controles = document.getElementById('controlesPosicoes');
            const btn = document.getElementById('btnTogglePosicoes');
            
            if (resultadosDiv.classList.contains('hidden')) {
                if (analisePosicoesCarregada) {
                    resultadosDiv.classList.remove('hidden');
                    controles.classList.remove('hidden');
                    btn.innerHTML = 'üëÅÔ∏è Ocultar';
                } else {
                    showCustomAlert('‚ö†Ô∏è Dados Necess√°rios', 'Carregue primeiro os dados clicando em "Carregar An√°lise"!');
                }
            } else {
                resultadosDiv.classList.add('hidden');
                controles.classList.add('hidden');
                btn.innerHTML = 'üëÅÔ∏è Mostrar/Ocultar';
            }
        }

        // Event listeners
        function configurarEventListeners() {
            // Event listeners principais
            document.getElementById('comoFuncionaBtn').addEventListener('click', () => {
                document.getElementById('modalComoFunciona').classList.remove('hidden');
            });
            document.getElementById('fecharModal').addEventListener('click', () => {
                document.getElementById('modalComoFunciona').classList.add('hidden');
            });

            // Event listeners para configura√ß√£o de valores
            document.getElementById('btnAtualizarValores').addEventListener('click', () => {
                const novoValor = parseFloat(document.getElementById('valorApostaSimples').value);
                if (novoValor && novoValor > 0) {
                    valorApostaSimples = novoValor;
                    sistemaValores.atualizarTodosValores();
                    showCustomAlert('‚úÖ Valores Atualizados', `Novo valor da aposta simples: ${formatarMoeda(valorApostaSimples)}\nTodos os valores foram recalculados automaticamente!`);
                } else {
                    showCustomAlert('‚ö†Ô∏è Valor Inv√°lido', 'Digite um valor v√°lido maior que zero!');
                }
            });

            // Event listeners para regras minimalistas
            document.getElementById('btnInfoMinimalista').addEventListener('click', () => {
                document.getElementById('modalInfoMinimalista').classList.remove('hidden');
            });
            document.getElementById('fecharModalMinimalista').addEventListener('click', () => {
                document.getElementById('modalInfoMinimalista').classList.add('hidden');
            });
            document.getElementById('btnGerarMinimalista').addEventListener('click', gerarJogosMinimalistas);
            document.getElementById('btnAdicionarMinimalistas').addEventListener('click', adicionarJogosMinimalistas);
            document.getElementById('btnDownloadMinimalistas').addEventListener('click', downloadJogosMinimalistas);
            document.getElementById('btnLimparMinimalistas').addEventListener('click', limparJogosMinimalistas);

            // Event listeners para tooltips das regras
            document.querySelectorAll('.regra-info').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    const numeroRegra = parseInt(btn.dataset.regra);
                    mostrarTooltipRegra(numeroRegra, e);
                });
            });

            // Event listeners para edi√ß√£o manual e drag & drop
            document.getElementById('aplicarNumeros').addEventListener('click', aplicarNumerosDigitados);
            document.getElementById('editarNumeros').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    aplicarNumerosDigitados();
                }
            });

            // Event listeners para an√°lise por posi√ß√µes
            document.getElementById('btnCarregarPosicoes').addEventListener('click', carregarAnalisePorPosicoes);
            document.getElementById('btnTogglePosicoes').addEventListener('click', toggleVisualizacaoPosicoes);
            document.getElementById('btnAnalisarPosicoes').addEventListener('click', analisarPosicoesDetalhada);
            document.getElementById('btnGerarPalpites').addEventListener('click', gerarPalpitesInteligentes);
            document.getElementById('btnAdicionarPalpites').addEventListener('click', adicionarPalpitesAosJogos);
            document.getElementById('btnDownloadPalpites').addEventListener('click', downloadPalpites);

            // Event listeners para grid estrat√©gica
            document.getElementById('btnAtualizarGrid').addEventListener('click', atualizarGridEstrategica);
            document.getElementById('posicaoAtual').addEventListener('change', atualizarGridEstrategica);
            document.getElementById('filtroNumeros').addEventListener('change', atualizarGridEstrategica);
            document.getElementById('btnLimparEstrategica').addEventListener('click', limparSelecaoEstrategica);
            document.getElementById('btnSugestaoRapida').addEventListener('click', sugestaoRapidaEstrategica);
            document.getElementById('btnUsarEstrategica').addEventListener('click', usarSelecaoEstrategica);

            // Event listeners para jogos
            document.getElementById('quantidadeDezenas').addEventListener('change', (e) => {
                quantidadeSelecionada = parseInt(e.target.value);
                limparSelecao();
                atualizarVisualizacaoDropArea();
                validarBotaoAdicionar();
            });

            document.getElementById('limparJogo').addEventListener('click', limparSelecao);
            document.getElementById('randomizarJogo').addEventListener('click', randomizarJogo);
            document.getElementById('adicionarJogo').addEventListener('click', adicionarJogo);
            
            document.getElementById('mostrarOrdemCrescente').addEventListener('change', atualizarVisualizacaoJogos);
            document.getElementById('limparTodos').addEventListener('click', limparTodosJogos);
            
            document.getElementById('permitirNumerosSorteados').addEventListener('change', atualizarEstadoNumerosSorteados);
            
            document.getElementById('downloadHTML').addEventListener('click', () => downloadJogos('html'));
            document.getElementById('downloadTXT').addEventListener('click', () => downloadJogos('txt'));
            document.getElementById('downloadXLSX').addEventListener('click', () => downloadJogos('xlsx'));
        }

        // Fun√ß√µes auxiliares b√°sicas
        function limparSelecao() {
            numerosSelecionados = [];
            numerosDropArea = [];
            document.querySelectorAll('.numero-mega').forEach(btn => {
                btn.classList.remove('selecionado');
            });
            atualizarVisualizacaoDropArea();
            atualizarContadorParesImpares();
            validarBotaoAdicionar();
        }

        function randomizarJogo() {
            limparSelecao();
            const quantidade = parseInt(document.getElementById('quantidadeDezenas').value);
            const permiteSorteados = document.getElementById('permitirNumerosSorteados').checked;
            const numerosDisponiveis = Array.from({length: 60}, (_, i) => i + 1).filter(num => {
                return permiteSorteados || !numerosSorteados.has(num);
            });
            
            while (numerosSelecionados.length < quantidade && numerosDisponiveis.length > 0) {
                const index = Math.floor(Math.random() * numerosDisponiveis.length);
                const numero = numerosDisponiveis.splice(index, 1)[0];
                numerosSelecionados.push(numero);
                numerosDropArea.push(numero);
                
                const btn = document.querySelector(`.numero-mega:nth-child(${numero})`);
                btn.classList.add('selecionado');
            }
            
            atualizarVisualizacaoDropArea();
            atualizarContadorParesImpares();
            validarBotaoAdicionar();
        }

        function adicionarJogo() {
            const quantidade = parseInt(document.getElementById('quantidadeDezenas').value);
            const custo = sistemaValores.obterValor(quantidade);
            
            const jogo = {
                id: Date.now(),
                numeros: [...numerosSelecionados].sort((a, b) => a - b),
                quantidade: quantidade,
                custo: custo,
                digitosDiferentes: calcularDigitosDiferentes(numerosSelecionados),
                pares: numerosSelecionados.filter(n => n % 2 === 0).length,
                impares: numerosSelecionados.filter(n => n % 2 !== 0).length
            };
            
            jogosAdicionados.push(jogo);
            limparSelecao();
            atualizarVisualizacaoJogos();
            atualizarCustoTotal();
        }

        function atualizarVisualizacaoJogos() {
            const lista = document.getElementById('listaJogos');
            const ordemCrescente = document.getElementById('mostrarOrdemCrescente').checked;
            
            if (jogosAdicionados.length === 0) {
                lista.innerHTML = '<p class="text-gray-500 text-center py-8">Nenhum jogo adicionado ainda</p>';
                return;
            }
            
            lista.innerHTML = '';
            jogosAdicionados.forEach((jogo, index) => {
                const jogoDiv = document.createElement('div');
                jogoDiv.className = 'jogo-card';
                
                const numerosOrdenados = ordemCrescente ? 
                    [...jogo.numeros].sort((a, b) => a - b) : 
                    jogo.numeros;
                
                jogoDiv.innerHTML = `
                    <div class="flex justify-between items-center mb-2">
                        <span class="font-bold text-megasena">Jogo ${index + 1}</span>
                        <div class="flex gap-2">
                            <span class="digito-badge">${jogo.digitosDiferentes} d√≠gitos</span>
                            <span class="px-2 py-1 bg-green-100 text-green-800 text-xs rounded">${jogo.pares || 0}P</span>
                            <span class="px-2 py-1 bg-purple-100 text-purple-800 text-xs rounded">${jogo.impares || 0}I</span>
                            <button onclick="editarJogo(${jogo.id})" class="bg-blue-500 hover:bg-blue-600 text-white px-2 py-1 rounded text-xs" title="Editar este jogo">
                                ‚úèÔ∏è
                            </button>
                            <button onclick="removerJogo(${jogo.id})" class="bg-red-500 hover:bg-red-600 text-white px-2 py-1 rounded text-xs" title="Excluir este jogo">
                                üóëÔ∏è
                            </button>
                        </div>
                    </div>
                    <div class="flex flex-wrap gap-1 mb-2">
                        ${numerosOrdenados.map(num => 
                            `<div class="numero-jogo">${num.toString().padStart(2, '0')}</div>`
                        ).join('')}
                    </div>
                    <div class="text-sm text-gray-600">
                        ${jogo.quantidade} dezenas - ${formatarMoeda(jogo.custo)}
                        ${jogo.origem ? `<span class="text-orange-600"> | ${jogo.origem}</span>` : ''}
                    </div>
                `;
                
                lista.appendChild(jogoDiv);
            });
        }

        function editarJogo(id) {
            const jogo = jogosAdicionados.find(j => j.id === id);
            if (!jogo) {
                showCustomAlert('‚ùå Erro', 'Jogo n√£o encontrado!');
                return;
            }
            
            showCustomConfirm(
                `‚úèÔ∏è Editar Jogo\n\nVoc√™ est√° editando um jogo com ${jogo.quantidade} dezenas:\n${jogo.numeros.map(n => n.toString().padStart(2, '0')).join(' ')}\n\nO jogo ser√° carregado nos controles de sele√ß√£o. Voc√™ pode modificar os n√∫meros e adicionar novamente. O jogo original ser√° removido.`,
                () => {
                    jogosAdicionados = jogosAdicionados.filter(j => j.id !== id);
                    
                    limparSelecao();
                    
                    document.getElementById('quantidadeDezenas').value = jogo.quantidade;
                    quantidadeSelecionada = jogo.quantidade;
                    
                    const numerosTexto = jogo.numeros.map(n => n.toString().padStart(2, '0')).join(' ');
                    document.getElementById('editarNumeros').value = numerosTexto;
                    
                    jogo.numeros.forEach(numero => {
                        numerosSelecionados.push(numero);
                        numerosDropArea.push(numero);
                        const btn = document.querySelector(`.numero-mega:nth-child(${numero})`);
                        if (btn) btn.classList.add('selecionado');
                    });
                    
                    atualizarVisualizacaoDropArea();
                    atualizarContadorParesImpares();
                    validarBotaoAdicionar();
                    
                    atualizarVisualizacaoJogos();
                    atualizarCustoTotal();
                    
                    showCustomAlert('‚úÖ Carregado', 'Jogo carregado para edi√ß√£o! Fa√ßa suas altera√ß√µes e clique em "Adicionar Jogo" novamente.');
                }
            );
        }

        function removerJogo(id) {
            showCustomConfirm('Tem certeza que deseja excluir este jogo?', () => {
                jogosAdicionados = jogosAdicionados.filter(jogo => jogo.id !== id);
                atualizarVisualizacaoJogos();
                atualizarCustoTotal();
                showCustomAlert('‚úÖ Removido', 'Jogo exclu√≠do com sucesso!');
            });
        }

        function limparTodosJogos() {
            if (jogosAdicionados.length === 0) return;
            
            showCustomConfirm('Tem certeza que deseja remover todos os jogos?', () => {
                jogosAdicionados = [];
                atualizarVisualizacaoJogos();
                atualizarCustoTotal();
            });
        }

        function atualizarCustoTotal() {
            const total = jogosAdicionados.reduce((sum, jogo) => sum + jogo.custo, 0);
            document.getElementById('custoTotal').textContent = formatarMoeda(total);
            document.getElementById('totalJogos').textContent = jogosAdicionados.length;
        }

        function calcularDigitosDiferentes(numeros) {
            const digitos = new Set();
            numeros.forEach(num => {
                const numStr = num.toString().padStart(2, '0');
                for (let digit of numStr) {
                    digitos.add(parseInt(digit));
                }
            });
            return digitos.size;
        }

        function formatarMoeda(valor) {
            return new Intl.NumberFormat('pt-BR', {
                style: 'currency',
                currency: 'BRL'
            }).format(valor);
        }

        function showCustomAlert(titulo, mensagem) {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
            modal.innerHTML = `
                <div class="bg-white p-6 rounded-lg shadow-lg max-w-sm w-full mx-4">
                    <h3 class="font-bold text-megasena mb-2">${titulo}</h3>
                    <p class="text-gray-700 mb-4" style="white-space: pre-line;">${mensagem}</p>
                    <div class="flex justify-end">
                        <button class="px-4 py-2 bg-blue-500 text-white hover:bg-blue-600 rounded" onclick="this.closest('.fixed').remove()">OK</button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        function showCustomConfirm(message, onConfirm) {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
            modal.innerHTML = `
                <div class="bg-white p-6 rounded-lg shadow-lg max-w-sm w-full mx-4">
                    <p class="text-gray-700 mb-4" style="white-space: pre-line;">${message}</p>
                    <div class="flex justify-end space-x-3">
                        <button class="px-4 py-2 text-gray-600 hover:bg-gray-100 rounded" onclick="this.closest('.fixed').remove()">Cancelar</button>
                        <button class="px-4 py-2 bg-red-500 text-white hover:bg-red-600 rounded" onclick="this.closest('.fixed').remove(); (${onConfirm})()">Confirmar</button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        function baixarArquivo(conteudo, nomeArquivo, tipoMime) {
            const blob = new Blob([conteudo], { type: tipoMime });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = nomeArquivo;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
        }

        function downloadJogos(formato) {
            if (jogosAdicionados.length === 0) {
                showCustomAlert('‚ö†Ô∏è Sem Jogos', 'Adicione pelo menos um jogo antes de fazer o download!');
                return;
            }
            
            switch (formato) {
                case 'txt':
                    downloadTXT();
                    break;
                case 'html':
                    downloadHTML();
                    break;
                case 'xlsx':
                    downloadXLSX();
                    break;
            }
        }

        function downloadTXT() {
            let txt = '';
            jogosAdicionados.forEach((jogo, index) => {
                txt += jogo.numeros.map(n => n.toString().padStart(2, '0')).join(' ');
                if (index < jogosAdicionados.length - 1) {
                    txt += '\n';
                }
            });
            baixarArquivo(txt, 'mega-sena-jogos.txt', 'text/plain');
        }

        function downloadHTML() {
            const total = jogosAdicionados.reduce((sum, jogo) => sum + jogo.custo, 0);
            const data = new Date().toLocaleDateString('pt-BR');
            
            let html = `<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Mega Sena - Meus Jogos</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .header { text-align: center; margin-bottom: 30px; color: #1B9A67; }
        .jogo { margin: 10px 0; padding: 15px; border: 2px solid #1B9A67; border-radius: 8px; }
        .numero { display: inline-block; width: 35px; height: 35px; background: #1B9A67; color: white; 
                 border-radius: 50%; text-align: center; line-height: 35px; margin: 2px; font-weight: bold; }
        .total { text-align: center; margin-top: 20px; font-size: 18px; font-weight: bold; color: #1B9A67; }
        .estrategia-real { background: #e6fffa; border: 2px solid #1B9A67; padding: 10px; margin: 10px 0; border-radius: 8px; }
    </style>
</head>
<body>
    <div class="header">
        <h1>üçÄ MEGA SENA - MEUS JOGOS</h1>
        <p>Gerado em: ${data}</p>
        <div class="estrategia-real">
            <h3>üìä Jogos com An√°lise Avan√ßada Completa + Regras Minimalistas</h3>
            <p><strong>üéØ 3 SE√á√ïES DE GERA√á√ÉO:</strong></p>
            <p><strong>SE√á√ÉO 1:</strong> Cria√ß√£o Manual - Par/√çmpar + Edi√ß√£o + Drag & Drop</p>
            <p><strong>SE√á√ÉO 2:</strong> Regras Minimalistas - 7 regras matem√°ticas baseadas em dados oficiais</p>
            <p><strong>SE√á√ÉO 3:</strong> An√°lise por Posi√ß√µes - N√∫meros atrasados + Grid Estrat√©gica + Palpites Inteligentes</p>
            <p><strong>Sistema de Valores Unificado:</strong> Valor base R$ ${formatarMoeda(valorApostaSimples)} - C√°lculo autom√°tico</p>
            <p><em>Gerado com dados da API oficial da Caixa Econ√¥mica Federal</em></p>
        </div>
    </div>`;
            
            jogosAdicionados.forEach((jogo, index) => {
                html += `
    <div class="jogo">
        <h3>Jogo ${index + 1} - ${jogo.quantidade} dezenas - ${formatarMoeda(jogo.custo)}</h3>
        <div>
            ${jogo.numeros.map(num => `<span class="numero">${num.toString().padStart(2, '0')}</span>`).join('')}
        </div>
        <div style="font-size: 12px; color: #666; margin-top: 5px;">
            ${jogo.digitosDiferentes} d√≠gitos diferentes | ${jogo.pares} pares, ${jogo.impares} √≠mpares
            ${jogo.origem ? ` | Origem: ${jogo.origem}` : ''}
        </div>
    </div>`;
            });
            
            html += `
    <div class="total">
        Total: ${jogosAdicionados.length} jogo(s) - ${formatarMoeda(total)}
    </div>
    <div style="text-align: center; margin-top: 20px; font-size: 12px; color: #666;">
        Gerado pelo Gerador Mega Sena com 3 se√ß√µes de cria√ß√£o:<br>
        ‚úÖ Manual + Par/√çmpar | ‚úÖ Regras Minimalistas | ‚úÖ An√°lise por Posi√ß√µes + Grid Estrat√©gica<br>
        Sistema de valores unificado - Base: ${formatarMoeda(valorApostaSimples)}
    </div>
</body>
</html>`;
            
            baixarArquivo(html, 'mega-sena-jogos.html', 'text/html');
        }

        function downloadXLSX() {
            const dados = [
                ['Jogo', 'Dezenas', 'N√∫meros', 'D√≠gitos Diferentes', 'Pares', '√çmpares', 'Custo', 'Origem']
            ];
            
            jogosAdicionados.forEach((jogo, index) => {
                dados.push([
                    `Jogo ${index + 1}`,
                    jogo.quantidade,
                    jogo.numeros.map(n => n.toString().padStart(2, '0')).join(' - '),
                    jogo.digitosDiferentes,
                    jogo.pares,
                    jogo.impares,
                    jogo.custo,
                    jogo.origem || 'Manual'
                ]);
            });
            
            const total = jogosAdicionados.reduce((sum, jogo) => sum + jogo.custo, 0);
            dados.push(['', '', 'TOTAL:', '', '', '', total, '']);
            dados.push(['', '', '', '', '', '', '', '']);
            dados.push(['Sistema Unificado:', '', '', '', '', '', '', '']);
            dados.push([`Valor Base: ${formatarMoeda(valorApostaSimples)}`, '', '', '', '', '', '', '']);
            dados.push(['SE√á√ÉO 1: Manual + Par/√çmpar', '', '', '', '', '', '', '']);
            dados.push(['SE√á√ÉO 2: Regras Minimalistas', '', '', '', '', '', '', '']);
            dados.push(['SE√á√ÉO 3: An√°lise Posi√ß√µes + Grid', '', '', '', '', '', '', '']);
            
            const ws = XLSX.utils.aoa_to_sheet(dados);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, 'Mega Sena');
            XLSX.writeFile(wb, 'mega-sena-jogos.xlsx');
        }
    </script>
</body>
</html>